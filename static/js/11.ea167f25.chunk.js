(this.webpackJsonpgithub_homepage=this.webpackJsonpgithub_homepage||[]).push([[11],{92:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),u=n(1),c=n(46),i=n(42),l=n(3),o=n(8),s=n(5),m=n(29),f=n(9),d=n(13),p="SIT.history",b=function(){try{var e=f.a.get(p);return JSON.parse(e)}catch(t){return[]}},v=function(){return b()[0]||[]},g=Object(d.a)({gameState:v()}),E=Object(u.a)(g,2),h=E[0],O=E[1],y=function(e){"function"===typeof e?O.set((function(t){var n=t.gameState;return{gameState:e(n)}})):O.set({gameState:e}),function(e){var t=b();t.unshift(e),t.length>10&&t.pop(),f.a.set(p,JSON.stringify(t))}(O.get().gameState)},C={set:y,get:v,undo:function(){var e=b();e.length>1&&e.shift(),f.a.set(p,JSON.stringify(e)),O.set({gameState:e[0]})},reset:function(){return C.set([])},rearrange:function(){return y((function(e){var t=function(e){return e.map((function(e){return Object(m.a)({},e,{total:0,points:e.points.map((function(){return{}}))})}))}(e);return[].concat(Object(s.a)(t.slice(1)),[t[0]])}))}},N=n(60),j=n(49),S=function(e){var t=Math.floor(e.numberOfCards/e.numberOfPlayers);return j.a.get().players.slice(0,e.numberOfPlayers).map((function(e,n){return function(e,t,n){return{player:e,points:o.a.array(n).map((function(){return{}})),total:0}}(e,0,t)}))},k={numberOfCards:{onChange:function(e){var t=Number(e);return isNaN(t)||t<32?{id:"SIT.startup.cartCount.invalid"}:void 0}},numberOfPlayers:{onChange:function(e){var t=Number(e);return isNaN(t)||t<2||t>10?{id:"players.count.invalid",values:{min:2,max:10}}:t>j.a.get().players.length?{id:"players.count.exceedsRegistered"}:void 0}}},P=function(e){var t,n=e.numberOfCards,a=e.numberOfPlayers;t={numberOfCards:+n,numberOfPlayers:+a},C.set(S(t))},F={numberOfCards:"52",numberOfPlayers:""},I=c.a.create(F),T=I.Form,x=I.Fields,J=function(){var e=Object(a.useState)({values:F,errors:{}}),t=Object(u.a)(e,2),n=t[0],c=t[1];return r.a.createElement("div",{className:"spade-is-trump"},r.a.createElement("div",{className:"configs"},r.a.createElement(T,{className:"startup",onSubmit:P,validation:k,data:n,onChange:c},r.a.createElement(i.a,{Field:x.numberOfCards,label:"SIT.startup.cardCount",type:"number"}),r.a.createElement(i.a,{Field:x.numberOfPlayers,label:"players.count",type:"number"}),r.a.createElement("button",{type:"submit"},Object(l.a)("APP.start")))),r.a.createElement(N.a,null))},w=n(12),R=function(e){if(e&&e.trim()){var t=Number(e.trim());if(!isNaN(t)&&t>=0)return t}},M=function(e){return void 0!==e?String(e):""},A=function(e){var t=e.points,n=e.activeRound,c=e.limit,l=e.onChange,o=e.checkable,s=e.active,f=Object(a.useState)(!1),d=Object(u.a)(f,2),p=d[0],b=d[1],v=Object(a.useState)((function(){return M(t.tip)})),g=Object(u.a)(v,2),E=g[0],h=g[1],O=Object(a.useCallback)((function(){n&&b(!0)}),[n]),y=Object(a.useCallback)((function(e){if(n){var t=R(e);void 0===t?h(""):t>=0&&t<=c&&h(e)}}),[n,c]),C=Object(a.useCallback)((function(e){if(n){var a=R(e);void 0!==a&&l(Object(m.a)({},t,{tip:a})),b(!1)}}),[n,t,l]),N=Object(a.useCallback)((function(e){e.preventDefault(),C(E)}),[C,E]),j=Object(a.useCallback)((function(e){n&&!t.earned&&l(Object(m.a)({},t,{earned:e}))}),[n,t,l]),S=Object(a.useCallback)((function(){j(Number(t.tip)+10)}),[j,t]),k=Object(a.useCallback)((function(){j(-1*Number(t.tip))}),[j,t]);if(Object(a.useEffect)((function(){h(M(t.tip))}),[t.tip]),void 0!==t.earned)return t.earned>0?r.a.createElement("td",{className:"points points-earned"},t.earned):r.a.createElement("td",{className:"points points-lost"},t.earned);if(!p){var P=n&&s?"points active":"points",F=n&&o;return r.a.createElement("td",{onClick:F?void 0:O,className:P},r.a.createElement("div",{onClick:F?O:void 0,className:"points-tip"},E),F&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"points-success",type:"button",onClick:S},"+"),r.a.createElement("button",{className:"points-failed",type:"button",onClick:k},"-")))}return r.a.createElement("td",null,r.a.createElement("form",{onSubmit:N},r.a.createElement(i.b,{className:"points-input",value:E,autoFocus:!0,onChange:y,onBlur:C,type:"number"})))},B=n(55),_=function(e,t,n){return function(a){var r=Object(s.a)(e.points);r[n]=a,function(e,t){C.set((function(n){var a=Object(s.a)(n);return a[t]=e,a}))}(Object(m.a)({},e,{points:r}),t)}},D=function(){var e=h((function(e){return{gameState:e.gameState}})).gameState,t=e[0].points.length,n=function(e,t){for(var n=o.a.array(t).map((function(){return 0})),a=0;a<e.length;a++)for(var r=e[a].points,u=0;u<r.length;u++)void 0!==r[u].earned&&n[u]++;var c=n.findIndex((function(t){return t<e.length}));return-1===c?void 0:c}(e,t),a=e.map((function(e){return e.points.reduce((function(e,t){return e+(t.earned||0)}),0)}));return r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement(B.a,{desc:Object(l.b)("SIT.cardCount"),short:"#",tag:"th",className:"card-number"}),e.map((function(e,t){var n=e.player,a=n.name,u=n.shortcut;return r.a.createElement(B.a,{desc:a,short:u,key:t,tag:"th"})})))),r.a.createElement("tbody",null,o.a.array(t).map((function(a,u){var c=n===u,i=function(e,t){if(void 0===t)return!0;for(var n=0;n<e.length;n++){if(void 0===e[n].points[t].tip)return!1}return!0}(e,n),l=t-u,o=function(e,t,n){var a=e.map((function(e){return e.points.map((function(e){return e.earned})).filter((function(e,n){return n===t}))[0]}));if(a.filter((function(e){return void 0===e})).length)return!1;var r=a.map((function(e){return e>10?e-10:void 0})).reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e+t}),0);return Boolean(r>n||r===n&&a.filter((function(e){return 0===e})).length)}(e,u,l);return r.a.createElement("tr",{key:l,className:void 0!==n&&u>n?"disabled":void 0},r.a.createElement("td",null,l,o&&r.a.createElement("span",{className:"error-round"},r.a.createElement(w.a.Alert,null))),e.map((function(t,n){return r.a.createElement(A,{key:n,points:t.points[u],limit:l,checkable:i,onChange:_(t,n,u),active:u%e.length===n,activeRound:c})})))})),r.a.createElement("tr",{className:"sum"},r.a.createElement(B.a,{desc:Object(l.b)("SIT.points"),short:"\u2211",tag:"td"}),a.map((function(e,t){return r.a.createElement("td",{key:t},e,void 0===n&&e===Math.max.apply(Math,Object(s.a)(a))&&r.a.createElement(w.a.Crown,{className:"winner"}))})))))},q=n(39),z=n(28),G=n(41),H=n(40),K=function(e){var t=e.started;return r.a.createElement(z.a,null,r.a.createElement(G.a,{onClick:C.undo}),t&&r.a.createElement(H.a,{onClick:C.reset}),t&&r.a.createElement(z.b,{onClick:C.rearrange,description:"SIT.reorder"},r.a.createElement(w.a.Refresh,null)))};t.default=function(){var e=h((function(e){return!!e.gameState.length}));return r.a.createElement(q.a,{fix:C.reset},r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"spade-is-trump"},e?r.a.createElement(D,null):r.a.createElement(J,null)),r.a.createElement(K,{started:e})))}}}]);