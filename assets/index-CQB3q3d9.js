import{U as L,c as V,P as k,j as o,I as f,r as Y,v as b}from"./index-VnnWUwzb.js";import{E as D,F as J,b as $}from"./FooterRestart-WM3EyTOt.js";import{F as q}from"./FooterUndo-yRoqo1TH.js";var t=(s=>(s.YELLOW="#b18e05",s.BLUE="#1313b1",s.BLACK="#000",s.GREEN="#054800",s.ORANGE="#b85409",s.PURPLE="#390257",s))(t||{});const O="âœ˜";var c=(s=>(s.FOX="FOX",s.PLUS_1="PLUS_1",s.REFRESH="REFRESH",s.YELLOW="YELLOW",s.YELLOW_10="YELLOW_10",s.YELLOW_14="YELLOW_14",s.YELLOW_16="YELLOW_16",s.YELLOW_20="YELLOW_20",s.BLUE="BLUE",s.GREEN="GREEN",s.ORANGE_4="ORANGE_4",s.ORANGE_5="ORANGE_5",s.ORANGE_6="ORANGE_6",s.PURPLE="PURPLE",s.ULTIMATE="ULTIMATE",s))(c||{});const y=[1,1,1,2,1,1,2,1,2,1,3],E={"#b18e05":{contents:[3,6,5,O,2,1,O,5,1,O,2,4,O,3,4,6],rowBonus:["BLUE","ORANGE_4","GREEN","FOX"],columnBonus:["YELLOW_10","YELLOW_14","YELLOW_16","YELLOW_20","PLUS_1"]},"#1313b1":{contents:[O,2,3,4,5,6,7,8,9,10,11,12],points:[0,1,2,4,7,11,16,22,29,37,46,56],rowBonus:["ORANGE_5","YELLOW","FOX"],columnBonus:["REFRESH","GREEN","PURPLE","PLUS_1"]},"#054800":{contents:[1,2,3,4,5,1,2,3,4,5,6],points:[1,3,6,10,15,21,28,36,45,55,66],bonus:[void 0,void 0,void 0,"PLUS_1",void 0,"BLUE","FOX",void 0,"PURPLE","REFRESH",void 0]},"#b85409":{factors:y,contents:y.map(s=>s>1?`x${s}`:""),bonus:[void 0,void 0,"REFRESH",void 0,"YELLOW","PLUS_1",void 0,"FOX",void 0,"PURPLE",void 0]},"#390257":{contents:["","","","","","","","","","",""],bonus:[void 0,void 0,"REFRESH","BLUE","PLUS_1","YELLOW","FOX","REFRESH","GREEN","ORANGE_6","PLUS_1"]}},H="veryClever",z=20,P=s=>k.set(H,JSON.stringify(s)),j=()=>{try{const s=JSON.parse(k.get(H)||"[]");if(Array.isArray(s))return s}catch{P([])}return[]},Q=()=>j().pop(),p={[t.YELLOW]:L.arrayFill(L.array(16,!1),[3,6,9,12],!0),[t.BLUE]:L.arrayFill(L.array(12,!1),[0],!0),[t.GREEN]:L.array(11,!1),[t.ORANGE]:L.array(11,0),[t.PURPLE]:L.array(11,0),earnedBonus:{[t.YELLOW]:[],[t.BLUE]:[]},reshuffle:[!1],plusOne:[],round:1,highlights:[],bonus:[],foxes:0},[_,N]=V(p),[Z,G]=V({}),B=s=>{N.set(s),P([...j().slice(-z+1),N.get()])},ss=s=>{N.set(s),P([...j().slice(0,-1),N.get()])};N.set(Q()||{});const ns=async()=>{const s=j();if(s.length>1){N.set({highlights:[]}),await L.flush();const{highlights:n}=s.pop();P(s),N.set({...s.at(-1)||p,highlights:n})}},es=()=>{P([]),B(p)},R={get:N.get,set:B,setOverride:ss,restart:()=>B(p),undo:ns,reset:es},ts="ðŸ¦Š",os="+1",cs=o.jsx(f.Refresh2,{}),C={[c.FOX]:{content:ts,color:t.BLACK},[c.PLUS_1]:{content:os,color:t.BLACK},[c.REFRESH]:{content:cs,color:t.BLACK},[c.YELLOW]:{content:O,color:t.YELLOW},[c.YELLOW_10]:{content:10,color:t.YELLOW},[c.YELLOW_14]:{content:14,color:t.YELLOW},[c.YELLOW_16]:{content:16,color:t.YELLOW},[c.YELLOW_20]:{content:20,color:t.YELLOW},[c.BLUE]:{content:O,color:t.BLUE},[c.GREEN]:{content:O,color:t.GREEN},[c.ORANGE_4]:{content:4,color:t.ORANGE},[c.ORANGE_5]:{content:5,color:t.ORANGE},[c.ORANGE_6]:{content:6,color:t.ORANGE},[c.PURPLE]:{content:6,color:t.PURPLE},[c.ULTIMATE]:{content:O+"/6",color:t.BLACK}},m=({bonus:s})=>o.jsx("div",{className:"box bonus",style:{backgroundColor:C[s].color},children:o.jsx("div",{className:"content",children:C[s].content})}),I=s=>{const n=s.findIndex(e=>!e);return n>=0?L.nextArray(s,n,!0):s},is=()=>R.set(({reshuffle:s})=>({reshuffle:I(s),highlights:[]})),ls=()=>R.set(({plusOne:s})=>({plusOne:I(s),highlights:[]})),a=(s,...n)=>n.every(e=>s[e]),rs=(s,n)=>{const e=[];return!n.includes(c.YELLOW_10)&&a(s,0,4,8)&&e.push(c.YELLOW_10),!n.includes(c.YELLOW_14)&&a(s,1,5,13)&&e.push(c.YELLOW_14),!n.includes(c.YELLOW_16)&&a(s,2,10,14)&&e.push(c.YELLOW_16),!n.includes(c.YELLOW_20)&&a(s,7,11,15)&&e.push(c.YELLOW_20),!n.includes(c.BLUE)&&a(s,0,1,2)&&e.push(c.BLUE),!n.includes(c.ORANGE_4)&&a(s,4,5,7)&&e.push(c.ORANGE_4),!n.includes(c.GREEN)&&a(s,8,10,11)&&e.push(c.GREEN),!n.includes(c.FOX)&&a(s,13,14,15)&&e.push(c.FOX),!n.includes(c.PLUS_1)&&a(s,0,5,10,15)&&e.push(c.PLUS_1),e},Es=(s,n)=>{const e=[];return!n.includes(c.REFRESH)&&a(s,4,8)&&e.push(c.REFRESH),!n.includes(c.GREEN)&&a(s,1,5,9)&&e.push(c.GREEN),!n.includes(c.PURPLE)&&a(s,2,6,10)&&e.push(c.PURPLE),!n.includes(c.PLUS_1)&&a(s,3,7,11)&&e.push(c.PLUS_1),!n.includes(c.ORANGE_5)&&a(s,1,2,3)&&e.push(c.ORANGE_5),!n.includes(c.YELLOW)&&a(s,4,5,6,7)&&e.push(c.YELLOW),!n.includes(c.FOX)&&a(s,8,9,10,11)&&e.push(c.FOX),e},X=(s,n,e)=>{const i=E[s].bonus[e];return i?[i]:[]},us=(s,n,e,i)=>{if(s===t.YELLOW)return rs(n,e);if(s===t.BLUE)return Es(n,e);if(s===t.GREEN)return X(t.GREEN,n,i)},T=(s,n,e)=>R[e?"setOverride":"set"](i=>{const r=s===t.GREEN?[]:i.earnedBonus[s],l=s,d=L.nextArray(i[l],n,!0),u=us(l,d,r,n),h={color:l,index:n};return{[l]:d,earnedBonus:{...i.earnedBonus,[l]:[...r,...u]},bonus:[...e||i.bonus,...u],highlights:e?[...i.highlights,h]:[h]}}),U=s=>R.get()[s].findIndex(n=>!n),as=(s,n)=>!!R.get()[s][n],Ls=(s,n)=>U(s)===n,ds=(s,n)=>{if(!as(s,n)){if(s===t.ORANGE||s===t.PURPLE||s===t.GREEN){if(!Ls(s,n))return;if(s!==t.GREEN)return G.set({selection:s})}return T(s,n)}},Rs=()=>G.set({selection:void 0}),g=(s,n,e)=>{const i=U(s),r=s===t.ORANGE?E[t.ORANGE].factors[i]:1;G.set({selection:void 0}),R[e?"setOverride":"set"](l=>{const d=s,u=L.nextArray(l[d],i,r*n),h={color:d,index:i};return{[d]:u,bonus:[...e||l.bonus,...X(d,u.map(Boolean),i)],highlights:e?[...l.highlights,h]:[h]}})},hs=s=>{const{selection:n}=G.get();n&&g(n,s)},Os=s=>{const n=s.includes(c.YELLOW_10)?10:0,e=s.includes(c.YELLOW_14)?14:0,i=s.includes(c.YELLOW_16)?16:0,r=s.includes(c.YELLOW_20)?20:0;return n+e+i+r},Ns=s=>E[t.BLUE].points[s.filter(Boolean).length-1],xs=s=>E[t.GREEN].points[s.filter(Boolean).length-1],F=s=>s.reduce((n,e)=>n+e,0),_s=s=>{const n=Os(s.earnedBonus[t.YELLOW]),e=Ns(s[t.BLUE]),i=xs(s[t.GREEN])||0,r=F(s[t.ORANGE]),l=F(s[t.PURPLE]),d=Math.min(n,e,i,r,l)*s.foxes;return n+e+i+r+l+d},vs=(s,n)=>{s===c.GREEN?T(t.GREEN,U(t.GREEN),n):s===c.ORANGE_4?g(t.ORANGE,4,n):s===c.ORANGE_5?g(t.ORANGE,5,n):s===c.ORANGE_6?g(t.ORANGE,6,n):s===c.PURPLE?g(t.PURPLE,6,n):s===c.FOX?R.setOverride(({foxes:e})=>({foxes:e+1,bonus:n})):s===c.PLUS_1?R.setOverride(({plusOne:e})=>({plusOne:[...e,!1],bonus:n})):s===c.REFRESH?R.setOverride(({reshuffle:e})=>({reshuffle:[...e,!1],bonus:n})):R.setOverride({bonus:n})},gs=()=>{const{bonus:s}=R.get();if(s){const[n,...e]=s;vs(n,e)}},S=[c.REFRESH,c.PLUS_1,c.REFRESH,c.ULTIMATE],fs=s=>S[s]?[S[s]]:[],Ps=()=>R.set(({round:s})=>({round:s+1,bonus:fs(s)})),x={takeReshuffleBonus:is,takePlusOneBonus:ls,boxClicked:ds,selectValue:hs,clearSelection:Rs,points:_s,useBonus:gs,nextRound:Ps},ms=({earned:s})=>s.length?o.jsxs("div",{className:"bonus-splash",onClick:x.useBonus,children:[o.jsx("div",{className:"bonus-splash-overlay"}),o.jsx("div",{className:"bonus-splash-inner",children:s.map((n,e)=>o.jsx(m,{bonus:n},e))})]}):null,K=({children:s,crossed:n,onClick:e})=>o.jsxs("div",{className:"grid-bonus-row",children:[o.jsx("div",{className:"grid-item",children:s}),n.map((i,r)=>o.jsx("div",{className:"grid-item",onClick:e,children:o.jsx("div",{className:L.classNames("box",i&&"crossed")})},r))]}),js=()=>{const{reshuffle:s}=_(({reshuffle:n})=>({reshuffle:n}));return o.jsx(K,{crossed:s,onClick:x.takeReshuffleBonus,children:o.jsx(f.Refresh2,{})})},ps=()=>{const{plusOne:s}=_(({plusOne:n})=>({plusOne:n}));return o.jsx(K,{crossed:s,onClick:x.takePlusOneBonus,children:o.jsx("div",{className:"content",children:"+1"})})},M=({content:s,color:n,gePrefix:e,index:i})=>{const{crossed:r,newContent:l,highlight:d}=_(h=>{const v=h.highlights.some(W=>W.color===n&&W.index===i);switch(n){case t.ORANGE:case t.PURPLE:return{crossed:!1,newContent:h[n][i],highlight:v};default:return{crossed:h[n][i],highlight:v}}}),u=Y.useCallback(()=>{x.boxClicked(n,i)},[n,i]);return o.jsx("div",{onClick:u,className:L.classNames("box",r&&"crossed",d&&"highlight"),style:{color:n,borderColor:n},children:e?o.jsxs("div",{className:"content",children:["â‰¥",s]}):l?o.jsx("div",{className:"picked",children:l}):o.jsx("div",{className:"content",children:s})})},Gs=L.array(6),w=({color:s,contents:n,rowBonusList:e,columnBonusList:i})=>o.jsx("div",{className:"grid-box-outer",children:o.jsxs("div",{className:"grid-box",style:{borderColor:s,color:s},children:[L.array(n.length/4).map((r,l)=>o.jsxs(Y.Fragment,{children:[n.slice(l*4,l*4+4).map((d,u)=>o.jsx("div",{className:"grid-item",children:o.jsx(M,{content:d,color:s,index:4*l+u},u)},u)),o.jsx("div",{className:"grid-item grid-arrow",children:o.jsx(f.ArrowRight,{})}),o.jsx("div",{className:"grid-item",children:o.jsx(m,{bonus:e[l]})})]},l)),Gs.map((r,l)=>o.jsx("div",{className:"grid-item grid-arrow",children:l<i.length?l===4?o.jsx(f.ArrowRight,{className:"rotate-45"}):o.jsx(f.ArrowDown,{}):null},l)),i.map((r,l)=>o.jsxs(Y.Fragment,{children:[l===4&&o.jsx("div",{className:"grid-item"}),o.jsx("div",{className:"grid-item",children:o.jsx(m,{bonus:r})})]},l))]})}),A=({color:s,contents:n,className:e,gePrefix:i,bonusList:r,points:l=[]})=>o.jsx("div",{className:L.classNames("grid-row",e),style:{borderColor:s},children:n.map((d,u)=>{const h=l[u],v=r[u];return o.jsxs("div",{className:"grid-item",children:[o.jsx(M,{content:d,color:s,gePrefix:i,index:u}),h&&o.jsx("div",{className:"points",style:{backgroundColor:s},children:h}),v&&o.jsx(m,{bonus:v})]},u)})}),As=()=>{const{points:s}=_(n=>({points:x.points(n)}));return o.jsxs("div",{className:"points-total",children:[b("VC.points"),s]})},Ys=()=>{const{round:s}=_(({round:n})=>({round:n}));return o.jsxs("div",{className:"round-overview",children:[o.jsxs("span",{className:"title",children:[b("VC.round"),s]}),o.jsx("button",{onClick:x.nextRound,children:b("VC.next")})]})},bs=({color:s})=>{const{prevVal:n}=_(e=>{const i=s===t.PURPLE?e[t.PURPLE].findIndex(r=>!r)-1:-1;return{prevVal:i>=0?e[t.PURPLE][i]:0}});return o.jsxs("div",{className:"value-selection",children:[o.jsx("div",{className:"value-selection-inner",children:[1,2,3,4,5,6].slice(n===6?0:n).map(e=>o.jsx("div",{className:"value",style:{backgroundColor:s},onClick:()=>x.selectValue(e),children:e},e))}),o.jsx("div",{className:"value-selection-overlay",onClick:x.clearSelection})]})},Bs=()=>{const s=_(({bonus:e})=>e),n=Z(({selection:e})=>e);return o.jsx("div",{className:"very-clever-outer",children:o.jsxs("div",{className:"very-clever",children:[o.jsx(Ys,{}),o.jsx(js,{}),o.jsx(ps,{}),o.jsx(w,{color:t.YELLOW,contents:E[t.YELLOW].contents,rowBonusList:E[t.YELLOW].rowBonus,columnBonusList:E[t.YELLOW].columnBonus}),o.jsx(w,{color:t.BLUE,contents:E[t.BLUE].contents,rowBonusList:E[t.BLUE].rowBonus,columnBonusList:E[t.BLUE].columnBonus}),o.jsx(A,{color:t.GREEN,contents:E[t.GREEN].contents,gePrefix:!0,bonusList:E[t.GREEN].bonus,points:E[t.GREEN].points}),o.jsx(A,{color:t.ORANGE,contents:E[t.ORANGE].contents,bonusList:E[t.ORANGE].bonus}),o.jsx(A,{color:t.PURPLE,contents:E[t.PURPLE].contents,className:"growing",bonusList:E[t.PURPLE].bonus}),o.jsx(As,{}),n&&o.jsx(bs,{color:n}),s&&o.jsx(ms,{earned:s})]})})},Us=()=>o.jsxs(J,{children:[o.jsx(q,{onClick:R.undo}),o.jsx($,{onClick:R.reset})]}),Fs=()=>o.jsxs(D,{fix:R.reset,children:[o.jsx(Bs,{}),o.jsx(Us,{})]});export{Fs as default};
