import{c as x,P as b,U as w,r as o,a as d,j as a,I as u,_ as N,R as g}from"./index.04a4b329.js";import{M as h}from"./event-util.6fcdd9df.js";import{F as v}from"./input.a741688f.js";const C="players",S=()=>{try{const e=b.get(C);return JSON.parse(e)}catch{return[]}},[P,m]=x({players:S()}),_=e=>b.set(C,JSON.stringify(e)),y=e=>{m.set(e),_(m.get().players)},F=(e,s)=>y(({players:t})=>({players:[{name:e,shortcut:s,uuid:w.uuid()},...t]})),D=e=>y(({players:s})=>({players:s.filter(t=>t.uuid!==e.uuid)})),f=(e,s)=>y(({players:t})=>{const r=t.filter((l,n)=>n!==e);return r.splice(s,0,t[e]),{players:r}}),R=e=>e>0?f(e,e-1):void 0,U=e=>f(e,e+1),i={add:F,remove:D,moveDown:U,moveUp:R,get:m.get},A=({player:e,pos:s})=>{const{name:t,shortcut:r}=e,l=o.exports.useCallback(()=>i.moveUp(s),[s]),n=o.exports.useCallback(()=>i.moveDown(s),[s]),c=o.exports.useCallback(()=>i.remove(e),[e]);return d("tr",{className:"player-row",children:[d("td",{className:"player-pos",children:[a("span",{className:"player-move-down",onClick:n,children:a(u.ArrowRight,{})}),a("span",{className:"player-current-pos",children:s+1}),a("span",{className:"player-move-up",onClick:l,children:a(u.ArrowRight,{})})]}),a("td",{className:"player-name",children:t}),a("td",{className:"player-shortcut",children:r}),a("td",{className:"player-actions",children:a("span",{className:"player-remove",onClick:c,children:a(u.Trash,{})})})]})},j={name:"",shortcut:""},I={name:{onChange:e=>e?void 0:{id:"players.add.name.required"}}},T=({close:e,onAdd:s})=>{const[t,r]=o.exports.useState(h.initialData(j)),{fields:l,Form:n}=h.useForm(),c=o.exports.useCallback(({name:p,shortcut:k})=>{s(p,k),e()},[e,s]);return d(n,{className:"startup add-players",onSubmit:c,validation:I,data:t,onChange:r,children:[a(v,{autoFocus:!0,field:l.name,label:"players.add.name"}),a(v,{field:l.shortcut,label:"players.add.shortcut"}),a("button",{type:"submit",children:N("players.add.submit")})]})},J=({onAdd:e})=>{const[s,t]=o.exports.useState(!1),r=o.exports.useCallback(()=>t(!0),[]),l=o.exports.useCallback(()=>t(!1),[]);return s?a(T,{close:l,onAdd:e}):a("button",{className:"add-player",onClick:r,type:"submit",children:N("players.add")})},E=()=>{const e=P(({players:s})=>s);return d("div",{className:"players",children:[a("div",{className:"registered-players",children:a("table",{children:a("tbody",{children:e.map((s,t)=>a(A,{player:s,pos:t},s.uuid))})})}),a(J,{onAdd:i.add})]})},V=({desc:e,short:s,className:t,tag:r="div"})=>{const[l,n]=o.exports.useState(!1),c=l?e:s||e,p=o.exports.useCallback(()=>{s&&(n(!0),window.setTimeout(()=>n(!1),3e3))},[s]);return g.createElement(r,{onClick:p,className:t},c)};export{V as C,E as P,i as a};
