import{c as ot,P as st,r as x,j as d,U as K,I as Z,v as V}from"./index-C5d-M75W.js";import{E as Dt,F as Ft,b as Rt}from"./FooterRestart-DWUh72Zz.js";import{M as _e}from"./DisplayError-Bw3wIOAX.js";import{F as Ae}from"./input-paecsdXs.js";const $e=[[],[],[],[]],at={results:{losses:0,wins:0},me:{knowledge:$e,round:0},enemy:{knowledge:$e,round:0}},lt="decrypto",Tt=()=>{try{const e=st.get(lt);if(e)return JSON.parse(e)}catch{}return at},It=e=>st.set(lt,JSON.stringify(e)),[te,Je]=ot(Tt()),ct=e=>{Je.set(e),It(Je.get())},Ot=()=>ct(at),G={set:ct,reset:Ot},_t=({value:e,children:t,onChange:n,close:r})=>{const i=x.useCallback(()=>{n(e),r()},[n,r,e]);return d.jsx("div",{className:"value",onClick:i,children:t})},ke=({children:e,options:t,onChange:n})=>{const[r,i]=x.useState(!1),o=x.useCallback(()=>i(!1),[]),s=x.useCallback(()=>i(!0),[]);return d.jsxs(d.Fragment,{children:[d.jsx("span",{onClick:s,children:e}),r&&d.jsxs("div",{className:"select-overlay",children:[d.jsx("div",{className:"select-overlay-inner",children:t.map(({value:a,node:l},h)=>d.jsx(_t,{close:o,onChange:n,value:a,children:l},h))}),d.jsx("div",{className:"select-overlay-outer",onClick:o})]})]})},Se=[{value:1,node:1},{value:2,node:2},{value:3,node:3},{value:4,node:4}],Lt=(e,t,n)=>{if(e&&e===t)return e;if(n&&(n===t||n===e))return n},jt=(e,t,n)=>{const r=Lt(e,t,n);return r?[r===e,r===t,r===n]:[!1,!1,!1]},ht=({onSubmit:e,codeWords:t})=>{const[n,r]=x.useState(),[i,o]=x.useState(),[s,a]=x.useState(),l=jt(n,i,s),h=x.useMemo(()=>!!(n&&i&&s&&n!==i&&n!==s&&i!==s),[n,i,s]),f=x.useCallback(()=>{e([n,i,s])},[e,n,i,s]);return d.jsxs("div",{className:"guessing",children:[d.jsxs("div",{className:"guess",children:[d.jsx("div",{className:"code-word",children:t.first}),d.jsx(ke,{options:Se,onChange:r,children:d.jsx("span",{className:K.classNames("code-guess",l[0]&&"invalid"),children:n??"?"})})]}),d.jsxs("div",{className:"guess",children:[d.jsx("div",{className:"code-word",children:t.second}),d.jsx(ke,{options:Se,onChange:o,children:d.jsx("span",{className:K.classNames("code-guess",l[1]&&"invalid"),children:i??"?"})})]}),d.jsxs("div",{className:"guess",children:[d.jsx("div",{className:"code-word",children:t.third}),d.jsx(ke,{options:Se,onChange:a,children:d.jsx("span",{className:K.classNames("code-guess",l[2]&&"invalid"),children:s??"?"})})]}),h&&d.jsxs("button",{onClick:f,type:"button",children:[d.jsx(Z.Key,{}),d.jsx("div",{className:"description",children:V("DECRYPTO.btn.decode")})]})]})},ut=({codeWords:e,code:t,guessed:n})=>{const r=n[0]!==t[0],i=n[1]!==t[1],o=n[2]!==t[2];return d.jsxs("div",{className:"guessed",children:[d.jsxs("div",{className:"guess",children:[d.jsx("div",{className:"code-word",children:e.first}),d.jsx("span",{className:K.classNames("code-guess",r?"invalid":"valid"),children:n[0]}),r&&d.jsx("span",{className:"code-was",children:t[0]})]}),d.jsxs("div",{className:"guess",children:[d.jsx("div",{className:"code-word",children:e.second}),d.jsx("span",{className:K.classNames("code-guess",i?"invalid":"valid"),children:n[1]}),i&&d.jsx("span",{className:"code-was",children:t[1]})]}),d.jsxs("div",{className:"guess",children:[d.jsx("div",{className:"code-word",children:e.third}),d.jsx("span",{className:K.classNames("code-guess",o?"invalid":"valid"),children:n[2]}),o&&d.jsx("span",{className:"code-was",children:t[2]})]})]})},ft=({knowledge:e})=>{const t=x.useMemo(()=>{const n=[],r=e.reduce((i,o)=>Math.max(i,o.length),0);for(let i=0;i<r;i++)n.push(d.jsx("tr",{children:e.map((o,s)=>d.jsx("td",{children:o[i]},s))},i));return n},[e]);return d.jsx("div",{className:"knowledge",children:d.jsxs("table",{children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("td",{children:"1"}),d.jsx("td",{children:"2"}),d.jsx("td",{children:"3"}),d.jsx("td",{children:"4"})]})}),d.jsx("tbody",{children:t})]})})};var fe={},zt=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},dt={},D={};let He;const Vt=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];D.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};D.getSymbolTotalCodewords=function(t){return Vt[t]};D.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};D.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');He=t};D.isKanjiModeEnabled=function(){return typeof He<"u"};D.toSJIS=function(t){return He(t)};var Me={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+n)}}e.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},e.from=function(r,i){if(e.isValid(r))return r;try{return t(r)}catch{return i}}})(Me);function wt(){this.buffer=[],this.length=0}wt.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let n=0;n<t;n++)this.putBit((e>>>t-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var Ut=wt;function de(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}de.prototype.set=function(e,t,n,r){const i=e*this.size+t;this.data[i]=n,r&&(this.reservedBit[i]=!0)};de.prototype.get=function(e,t){return this.data[e*this.size+t]};de.prototype.xor=function(e,t,n){this.data[e*this.size+t]^=n};de.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var Yt=de,gt={};(function(e){const t=D.getSymbolSize;e.getRowColCoords=function(r){if(r===1)return[];const i=Math.floor(r/7)+2,o=t(r),s=o===145?26:Math.ceil((o-13)/(2*i-2))*2,a=[o-7];for(let l=1;l<i-1;l++)a[l]=a[l-1]-s;return a.push(6),a.reverse()},e.getPositions=function(r){const i=[],o=e.getRowColCoords(r),s=o.length;for(let a=0;a<s;a++)for(let l=0;l<s;l++)a===0&&l===0||a===0&&l===s-1||a===s-1&&l===0||i.push([o[a],o[l]]);return i}})(gt);var vt={};const qt=D.getSymbolSize,Ze=7;vt.getPositions=function(t){const n=qt(t);return[[0,0],[n-Ze,0],[0,n-Ze]]};var pt={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},e.from=function(i){return e.isValid(i)?parseInt(i,10):void 0},e.getPenaltyN1=function(i){const o=i.size;let s=0,a=0,l=0,h=null,f=null;for(let v=0;v<o;v++){a=l=0,h=f=null;for(let w=0;w<o;w++){let g=i.get(v,w);g===h?a++:(a>=5&&(s+=t.N1+(a-5)),h=g,a=1),g=i.get(w,v),g===f?l++:(l>=5&&(s+=t.N1+(l-5)),f=g,l=1)}a>=5&&(s+=t.N1+(a-5)),l>=5&&(s+=t.N1+(l-5))}return s},e.getPenaltyN2=function(i){const o=i.size;let s=0;for(let a=0;a<o-1;a++)for(let l=0;l<o-1;l++){const h=i.get(a,l)+i.get(a,l+1)+i.get(a+1,l)+i.get(a+1,l+1);(h===4||h===0)&&s++}return s*t.N2},e.getPenaltyN3=function(i){const o=i.size;let s=0,a=0,l=0;for(let h=0;h<o;h++){a=l=0;for(let f=0;f<o;f++)a=a<<1&2047|i.get(h,f),f>=10&&(a===1488||a===93)&&s++,l=l<<1&2047|i.get(f,h),f>=10&&(l===1488||l===93)&&s++}return s*t.N3},e.getPenaltyN4=function(i){let o=0;const s=i.data.length;for(let l=0;l<s;l++)o+=i.data[l];return Math.abs(Math.ceil(o*100/s/5)-10)*t.N4};function n(r,i,o){switch(r){case e.Patterns.PATTERN000:return(i+o)%2===0;case e.Patterns.PATTERN001:return i%2===0;case e.Patterns.PATTERN010:return o%3===0;case e.Patterns.PATTERN011:return(i+o)%3===0;case e.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(o/3))%2===0;case e.Patterns.PATTERN101:return i*o%2+i*o%3===0;case e.Patterns.PATTERN110:return(i*o%2+i*o%3)%2===0;case e.Patterns.PATTERN111:return(i*o%3+(i+o)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}e.applyMask=function(i,o){const s=o.size;for(let a=0;a<s;a++)for(let l=0;l<s;l++)o.isReserved(l,a)||o.xor(l,a,n(i,l,a))},e.getBestMask=function(i,o){const s=Object.keys(e.Patterns).length;let a=0,l=1/0;for(let h=0;h<s;h++){o(h),e.applyMask(h,i);const f=e.getPenaltyN1(i)+e.getPenaltyN2(i)+e.getPenaltyN3(i)+e.getPenaltyN4(i);e.applyMask(h,i),f<l&&(l=f,a=h)}return a}})(pt);var Ne={};const Q=Me,pe=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],me=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Ne.getBlocksCount=function(t,n){switch(n){case Q.L:return pe[(t-1)*4+0];case Q.M:return pe[(t-1)*4+1];case Q.Q:return pe[(t-1)*4+2];case Q.H:return pe[(t-1)*4+3];default:return}};Ne.getTotalCodewordsCount=function(t,n){switch(n){case Q.L:return me[(t-1)*4+0];case Q.M:return me[(t-1)*4+1];case Q.Q:return me[(t-1)*4+2];case Q.H:return me[(t-1)*4+3];default:return}};var mt={},xe={};const he=new Uint8Array(512),ye=new Uint8Array(256);(function(){let t=1;for(let n=0;n<255;n++)he[n]=t,ye[t]=n,t<<=1,t&256&&(t^=285);for(let n=255;n<512;n++)he[n]=he[n-255]})();xe.log=function(t){if(t<1)throw new Error("log("+t+")");return ye[t]};xe.exp=function(t){return he[t]};xe.mul=function(t,n){return t===0||n===0?0:he[ye[t]+ye[n]]};(function(e){const t=xe;e.mul=function(r,i){const o=new Uint8Array(r.length+i.length-1);for(let s=0;s<r.length;s++)for(let a=0;a<i.length;a++)o[s+a]^=t.mul(r[s],i[a]);return o},e.mod=function(r,i){let o=new Uint8Array(r);for(;o.length-i.length>=0;){const s=o[0];for(let l=0;l<i.length;l++)o[l]^=t.mul(i[l],s);let a=0;for(;a<o.length&&o[a]===0;)a++;o=o.slice(a)}return o},e.generateECPolynomial=function(r){let i=new Uint8Array([1]);for(let o=0;o<r;o++)i=e.mul(i,new Uint8Array([1,t.exp(o)]));return i}})(mt);const yt=mt;function Qe(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}Qe.prototype.initialize=function(t){this.degree=t,this.genPoly=yt.generateECPolynomial(this.degree)};Qe.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const n=new Uint8Array(t.length+this.degree);n.set(t);const r=yt.mod(n,this.genPoly),i=this.degree-r.length;if(i>0){const o=new Uint8Array(this.degree);return o.set(r,i),o}return r};var Ht=Qe,Ct={},W={},Ke={};Ke.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var L={};const bt="[0-9]+",Qt="[A-Z $%*+\\-./:]+";let ue="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";ue=ue.replace(/u/g,"\\u");const Kt="(?:(?![A-Z0-9 $%*+\\-./:]|"+ue+`)(?:.|[\r
]))+`;L.KANJI=new RegExp(ue,"g");L.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");L.BYTE=new RegExp(Kt,"g");L.NUMERIC=new RegExp(bt,"g");L.ALPHANUMERIC=new RegExp(Qt,"g");const Gt=new RegExp("^"+ue+"$"),Wt=new RegExp("^"+bt+"$"),$t=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");L.testKanji=function(t){return Gt.test(t)};L.testNumeric=function(t){return Wt.test(t)};L.testAlphanumeric=function(t){return $t.test(t)};(function(e){const t=Ke,n=L;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(o,s){if(!o.ccBits)throw new Error("Invalid mode: "+o);if(!t.isValid(s))throw new Error("Invalid version: "+s);return s>=1&&s<10?o.ccBits[0]:s<27?o.ccBits[1]:o.ccBits[2]},e.getBestModeForData=function(o){return n.testNumeric(o)?e.NUMERIC:n.testAlphanumeric(o)?e.ALPHANUMERIC:n.testKanji(o)?e.KANJI:e.BYTE},e.toString=function(o){if(o&&o.id)return o.id;throw new Error("Invalid mode")},e.isValid=function(o){return o&&o.bit&&o.ccBits};function r(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+i)}}e.from=function(o,s){if(e.isValid(o))return o;try{return r(o)}catch{return s}}})(W);(function(e){const t=D,n=Ne,r=Me,i=W,o=Ke,s=7973,a=t.getBCHDigit(s);function l(w,g,p){for(let b=1;b<=40;b++)if(g<=e.getCapacity(b,p,w))return b}function h(w,g){return i.getCharCountIndicator(w,g)+4}function f(w,g){let p=0;return w.forEach(function(b){const N=h(b.mode,g);p+=N+b.getBitsLength()}),p}function v(w,g){for(let p=1;p<=40;p++)if(f(w,p)<=e.getCapacity(p,g,i.MIXED))return p}e.from=function(g,p){return o.isValid(g)?parseInt(g,10):p},e.getCapacity=function(g,p,b){if(!o.isValid(g))throw new Error("Invalid QR Code version");typeof b>"u"&&(b=i.BYTE);const N=t.getSymbolTotalCodewords(g),y=n.getTotalCodewordsCount(g,p),M=(N-y)*8;if(b===i.MIXED)return M;const m=M-h(b,g);switch(b){case i.NUMERIC:return Math.floor(m/10*3);case i.ALPHANUMERIC:return Math.floor(m/11*2);case i.KANJI:return Math.floor(m/13);case i.BYTE:default:return Math.floor(m/8)}},e.getBestVersionForData=function(g,p){let b;const N=r.from(p,r.M);if(Array.isArray(g)){if(g.length>1)return v(g,N);if(g.length===0)return 1;b=g[0]}else b=g;return l(b.mode,b.getLength(),N)},e.getEncodedBits=function(g){if(!o.isValid(g)||g<7)throw new Error("Invalid QR Code version");let p=g<<12;for(;t.getBCHDigit(p)-a>=0;)p^=s<<t.getBCHDigit(p)-a;return g<<12|p}})(Ct);var Et={};const Le=D,Mt=1335,Jt=21522,Xe=Le.getBCHDigit(Mt);Et.getEncodedBits=function(t,n){const r=t.bit<<3|n;let i=r<<10;for(;Le.getBCHDigit(i)-Xe>=0;)i^=Mt<<Le.getBCHDigit(i)-Xe;return(r<<10|i)^Jt};var Nt={};const Zt=W;function ne(e){this.mode=Zt.NUMERIC,this.data=e.toString()}ne.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};ne.prototype.getLength=function(){return this.data.length};ne.prototype.getBitsLength=function(){return ne.getBitsLength(this.data.length)};ne.prototype.write=function(t){let n,r,i;for(n=0;n+3<=this.data.length;n+=3)r=this.data.substr(n,3),i=parseInt(r,10),t.put(i,10);const o=this.data.length-n;o>0&&(r=this.data.substr(n),i=parseInt(r,10),t.put(i,o*3+1))};var Xt=ne;const en=W,De=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function re(e){this.mode=en.ALPHANUMERIC,this.data=e}re.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};re.prototype.getLength=function(){return this.data.length};re.prototype.getBitsLength=function(){return re.getBitsLength(this.data.length)};re.prototype.write=function(t){let n;for(n=0;n+2<=this.data.length;n+=2){let r=De.indexOf(this.data[n])*45;r+=De.indexOf(this.data[n+1]),t.put(r,11)}this.data.length%2&&t.put(De.indexOf(this.data[n]),6)};var tn=re,nn=function(t){for(var n=[],r=t.length,i=0;i<r;i++){var o=t.charCodeAt(i);if(o>=55296&&o<=56319&&r>i+1){var s=t.charCodeAt(i+1);s>=56320&&s<=57343&&(o=(o-55296)*1024+s-56320+65536,i+=1)}if(o<128){n.push(o);continue}if(o<2048){n.push(o>>6|192),n.push(o&63|128);continue}if(o<55296||o>=57344&&o<65536){n.push(o>>12|224),n.push(o>>6&63|128),n.push(o&63|128);continue}if(o>=65536&&o<=1114111){n.push(o>>18|240),n.push(o>>12&63|128),n.push(o>>6&63|128),n.push(o&63|128);continue}n.push(239,191,189)}return new Uint8Array(n).buffer};const rn=nn,on=W;function ie(e){this.mode=on.BYTE,typeof e=="string"&&(e=rn(e)),this.data=new Uint8Array(e)}ie.getBitsLength=function(t){return t*8};ie.prototype.getLength=function(){return this.data.length};ie.prototype.getBitsLength=function(){return ie.getBitsLength(this.data.length)};ie.prototype.write=function(e){for(let t=0,n=this.data.length;t<n;t++)e.put(this.data[t],8)};var sn=ie;const an=W,ln=D;function oe(e){this.mode=an.KANJI,this.data=e}oe.getBitsLength=function(t){return t*13};oe.prototype.getLength=function(){return this.data.length};oe.prototype.getBitsLength=function(){return oe.getBitsLength(this.data.length)};oe.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let n=ln.toSJIS(this.data[t]);if(n>=33088&&n<=40956)n-=33088;else if(n>=57408&&n<=60351)n-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);n=(n>>>8&255)*192+(n&255),e.put(n,13)}};var cn=oe,xt={exports:{}};(function(e){var t={single_source_shortest_paths:function(n,r,i){var o={},s={};s[r]=0;var a=t.PriorityQueue.make();a.push(r,0);for(var l,h,f,v,w,g,p,b,N;!a.empty();){l=a.pop(),h=l.value,v=l.cost,w=n[h]||{};for(f in w)w.hasOwnProperty(f)&&(g=w[f],p=v+g,b=s[f],N=typeof s[f]>"u",(N||b>p)&&(s[f]=p,a.push(f,p),o[f]=h))}if(typeof i<"u"&&typeof s[i]>"u"){var y=["Could not find a path from ",r," to ",i,"."].join("");throw new Error(y)}return o},extract_shortest_path_from_predecessor_list:function(n,r){for(var i=[],o=r;o;)i.push(o),n[o],o=n[o];return i.reverse(),i},find_path:function(n,r,i){var o=t.single_source_shortest_paths(n,r,i);return t.extract_shortest_path_from_predecessor_list(o,i)},PriorityQueue:{make:function(n){var r=t.PriorityQueue,i={},o;n=n||{};for(o in r)r.hasOwnProperty(o)&&(i[o]=r[o]);return i.queue=[],i.sorter=n.sorter||r.default_sorter,i},default_sorter:function(n,r){return n.cost-r.cost},push:function(n,r){var i={value:n,cost:r};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(xt);var hn=xt.exports;(function(e){const t=W,n=Xt,r=tn,i=sn,o=cn,s=L,a=D,l=hn;function h(y){return unescape(encodeURIComponent(y)).length}function f(y,M,m){const E=[];let B;for(;(B=y.exec(m))!==null;)E.push({data:B[0],index:B.index,mode:M,length:B[0].length});return E}function v(y){const M=f(s.NUMERIC,t.NUMERIC,y),m=f(s.ALPHANUMERIC,t.ALPHANUMERIC,y);let E,B;return a.isKanjiModeEnabled()?(E=f(s.BYTE,t.BYTE,y),B=f(s.KANJI,t.KANJI,y)):(E=f(s.BYTE_KANJI,t.BYTE,y),B=[]),M.concat(m,E,B).sort(function(A,I){return A.index-I.index}).map(function(A){return{data:A.data,mode:A.mode,length:A.length}})}function w(y,M){switch(M){case t.NUMERIC:return n.getBitsLength(y);case t.ALPHANUMERIC:return r.getBitsLength(y);case t.KANJI:return o.getBitsLength(y);case t.BYTE:return i.getBitsLength(y)}}function g(y){return y.reduce(function(M,m){const E=M.length-1>=0?M[M.length-1]:null;return E&&E.mode===m.mode?(M[M.length-1].data+=m.data,M):(M.push(m),M)},[])}function p(y){const M=[];for(let m=0;m<y.length;m++){const E=y[m];switch(E.mode){case t.NUMERIC:M.push([E,{data:E.data,mode:t.ALPHANUMERIC,length:E.length},{data:E.data,mode:t.BYTE,length:E.length}]);break;case t.ALPHANUMERIC:M.push([E,{data:E.data,mode:t.BYTE,length:E.length}]);break;case t.KANJI:M.push([E,{data:E.data,mode:t.BYTE,length:h(E.data)}]);break;case t.BYTE:M.push([{data:E.data,mode:t.BYTE,length:h(E.data)}])}}return M}function b(y,M){const m={},E={start:{}};let B=["start"];for(let P=0;P<y.length;P++){const A=y[P],I=[];for(let q=0;q<A.length;q++){const _=A[q],ce=""+P+q;I.push(ce),m[ce]={node:_,lastCount:0},E[ce]={};for(let Pe=0;Pe<B.length;Pe++){const j=B[Pe];m[j]&&m[j].node.mode===_.mode?(E[j][ce]=w(m[j].lastCount+_.length,_.mode)-w(m[j].lastCount,_.mode),m[j].lastCount+=_.length):(m[j]&&(m[j].lastCount=_.length),E[j][ce]=w(_.length,_.mode)+4+t.getCharCountIndicator(_.mode,M))}}B=I}for(let P=0;P<B.length;P++)E[B[P]].end=0;return{map:E,table:m}}function N(y,M){let m;const E=t.getBestModeForData(y);if(m=t.from(M,E),m!==t.BYTE&&m.bit<E.bit)throw new Error('"'+y+'" cannot be encoded with mode '+t.toString(m)+`.
 Suggested mode is: `+t.toString(E));switch(m===t.KANJI&&!a.isKanjiModeEnabled()&&(m=t.BYTE),m){case t.NUMERIC:return new n(y);case t.ALPHANUMERIC:return new r(y);case t.KANJI:return new o(y);case t.BYTE:return new i(y)}}e.fromArray=function(M){return M.reduce(function(m,E){return typeof E=="string"?m.push(N(E,null)):E.data&&m.push(N(E.data,E.mode)),m},[])},e.fromString=function(M,m){const E=v(M,a.isKanjiModeEnabled()),B=p(E),P=b(B,m),A=l.find_path(P.map,"start","end"),I=[];for(let q=1;q<A.length-1;q++)I.push(P.table[A[q]].node);return e.fromArray(g(I))},e.rawSplit=function(M){return e.fromArray(v(M,a.isKanjiModeEnabled()))}})(Nt);const Be=D,Fe=Me,un=Ut,fn=Yt,dn=gt,wn=vt,je=pt,ze=Ne,gn=Ht,Ce=Ct,vn=Et,pn=W,Re=Nt;function mn(e,t){const n=e.size,r=wn.getPositions(t);for(let i=0;i<r.length;i++){const o=r[i][0],s=r[i][1];for(let a=-1;a<=7;a++)if(!(o+a<=-1||n<=o+a))for(let l=-1;l<=7;l++)s+l<=-1||n<=s+l||(a>=0&&a<=6&&(l===0||l===6)||l>=0&&l<=6&&(a===0||a===6)||a>=2&&a<=4&&l>=2&&l<=4?e.set(o+a,s+l,!0,!0):e.set(o+a,s+l,!1,!0))}}function yn(e){const t=e.size;for(let n=8;n<t-8;n++){const r=n%2===0;e.set(n,6,r,!0),e.set(6,n,r,!0)}}function Cn(e,t){const n=dn.getPositions(t);for(let r=0;r<n.length;r++){const i=n[r][0],o=n[r][1];for(let s=-2;s<=2;s++)for(let a=-2;a<=2;a++)s===-2||s===2||a===-2||a===2||s===0&&a===0?e.set(i+s,o+a,!0,!0):e.set(i+s,o+a,!1,!0)}}function bn(e,t){const n=e.size,r=Ce.getEncodedBits(t);let i,o,s;for(let a=0;a<18;a++)i=Math.floor(a/3),o=a%3+n-8-3,s=(r>>a&1)===1,e.set(i,o,s,!0),e.set(o,i,s,!0)}function Te(e,t,n){const r=e.size,i=vn.getEncodedBits(t,n);let o,s;for(o=0;o<15;o++)s=(i>>o&1)===1,o<6?e.set(o,8,s,!0):o<8?e.set(o+1,8,s,!0):e.set(r-15+o,8,s,!0),o<8?e.set(8,r-o-1,s,!0):o<9?e.set(8,15-o-1+1,s,!0):e.set(8,15-o-1,s,!0);e.set(r-8,8,1,!0)}function En(e,t){const n=e.size;let r=-1,i=n-1,o=7,s=0;for(let a=n-1;a>0;a-=2)for(a===6&&a--;;){for(let l=0;l<2;l++)if(!e.isReserved(i,a-l)){let h=!1;s<t.length&&(h=(t[s]>>>o&1)===1),e.set(i,a-l,h),o--,o===-1&&(s++,o=7)}if(i+=r,i<0||n<=i){i-=r,r=-r;break}}}function Mn(e,t,n){const r=new un;n.forEach(function(l){r.put(l.mode.bit,4),r.put(l.getLength(),pn.getCharCountIndicator(l.mode,e)),l.write(r)});const i=Be.getSymbolTotalCodewords(e),o=ze.getTotalCodewordsCount(e,t),s=(i-o)*8;for(r.getLengthInBits()+4<=s&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);const a=(s-r.getLengthInBits())/8;for(let l=0;l<a;l++)r.put(l%2?17:236,8);return Nn(r,e,t)}function Nn(e,t,n){const r=Be.getSymbolTotalCodewords(t),i=ze.getTotalCodewordsCount(t,n),o=r-i,s=ze.getBlocksCount(t,n),a=r%s,l=s-a,h=Math.floor(r/s),f=Math.floor(o/s),v=f+1,w=h-f,g=new gn(w);let p=0;const b=new Array(s),N=new Array(s);let y=0;const M=new Uint8Array(e.buffer);for(let A=0;A<s;A++){const I=A<l?f:v;b[A]=M.slice(p,p+I),N[A]=g.encode(b[A]),p+=I,y=Math.max(y,I)}const m=new Uint8Array(r);let E=0,B,P;for(B=0;B<y;B++)for(P=0;P<s;P++)B<b[P].length&&(m[E++]=b[P][B]);for(B=0;B<w;B++)for(P=0;P<s;P++)m[E++]=N[P][B];return m}function xn(e,t,n,r){let i;if(Array.isArray(e))i=Re.fromArray(e);else if(typeof e=="string"){let h=t;if(!h){const f=Re.rawSplit(e);h=Ce.getBestVersionForData(f,n)}i=Re.fromString(e,h||40)}else throw new Error("Invalid data");const o=Ce.getBestVersionForData(i,n);if(!o)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=o;else if(t<o)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+o+`.
`);const s=Mn(t,n,i),a=Be.getSymbolSize(t),l=new fn(a);return mn(l,t),yn(l),Cn(l,t),Te(l,n,0),t>=7&&bn(l,t),En(l,s),isNaN(r)&&(r=je.getBestMask(l,Te.bind(null,l,n))),je.applyMask(r,l),Te(l,n,r),{modules:l,version:t,errorCorrectionLevel:n,maskPattern:r,segments:i}}dt.create=function(t,n){if(typeof t>"u"||t==="")throw new Error("No input text");let r=Fe.M,i,o;return typeof n<"u"&&(r=Fe.from(n.errorCorrectionLevel,Fe.M),i=Ce.from(n.version),o=je.from(n.maskPattern),n.toSJISFunc&&Be.setToSJISFunction(n.toSJISFunc)),xn(t,i,r,o)};var Bt={},Ge={};(function(e){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let r=n.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+n);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(o){return[o,o]}))),r.length===6&&r.push("F","F");const i=parseInt(r.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+r.slice(0,6).join("")}}e.getOptions=function(r){r||(r={}),r.color||(r.color={});const i=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,o=r.width&&r.width>=21?r.width:void 0,s=r.scale||4;return{width:o,scale:o?4:s,margin:i,color:{dark:t(r.color.dark||"#000000ff"),light:t(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},e.getScale=function(r,i){return i.width&&i.width>=r+i.margin*2?i.width/(r+i.margin*2):i.scale},e.getImageWidth=function(r,i){const o=e.getScale(r,i);return Math.floor((r+i.margin*2)*o)},e.qrToImageData=function(r,i,o){const s=i.modules.size,a=i.modules.data,l=e.getScale(s,o),h=Math.floor((s+o.margin*2)*l),f=o.margin*l,v=[o.color.light,o.color.dark];for(let w=0;w<h;w++)for(let g=0;g<h;g++){let p=(w*h+g)*4,b=o.color.light;if(w>=f&&g>=f&&w<h-f&&g<h-f){const N=Math.floor((w-f)/l),y=Math.floor((g-f)/l);b=v[a[N*s+y]?1:0]}r[p++]=b.r,r[p++]=b.g,r[p++]=b.b,r[p]=b.a}}})(Ge);(function(e){const t=Ge;function n(i,o,s){i.clearRect(0,0,o.width,o.height),o.style||(o.style={}),o.height=s,o.width=s,o.style.height=s+"px",o.style.width=s+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(o,s,a){let l=a,h=s;typeof l>"u"&&(!s||!s.getContext)&&(l=s,s=void 0),s||(h=r()),l=t.getOptions(l);const f=t.getImageWidth(o.modules.size,l),v=h.getContext("2d"),w=v.createImageData(f,f);return t.qrToImageData(w.data,o,l),n(v,h,f),v.putImageData(w,0,0),h},e.renderToDataURL=function(o,s,a){let l=a;typeof l>"u"&&(!s||!s.getContext)&&(l=s,s=void 0),l||(l={});const h=e.render(o,s,l),f=l.type||"image/png",v=l.rendererOpts||{};return h.toDataURL(f,v.quality)}})(Bt);var Pt={};const Bn=Ge;function et(e,t){const n=e.a/255,r=t+'="'+e.hex+'"';return n<1?r+" "+t+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function Ie(e,t,n){let r=e+t;return typeof n<"u"&&(r+=" "+n),r}function Pn(e,t,n){let r="",i=0,o=!1,s=0;for(let a=0;a<e.length;a++){const l=Math.floor(a%t),h=Math.floor(a/t);!l&&!o&&(o=!0),e[a]?(s++,a>0&&l>0&&e[a-1]||(r+=o?Ie("M",l+n,.5+h+n):Ie("m",i,0),i=0,o=!1),l+1<t&&e[a+1]||(r+=Ie("h",s),s=0)):i++}return r}Pt.render=function(t,n,r){const i=Bn.getOptions(n),o=t.modules.size,s=t.modules.data,a=o+i.margin*2,l=i.color.light.a?"<path "+et(i.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",h="<path "+et(i.color.dark,"stroke")+' d="'+Pn(s,o,i.margin)+'"/>',f='viewBox="0 0 '+a+" "+a+'"',w='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+f+' shape-rendering="crispEdges">'+l+h+`</svg>
`;return typeof r=="function"&&r(null,w),w};const An=zt,Ve=dt,At=Bt,kn=Pt;function We(e,t,n,r,i){const o=[].slice.call(arguments,1),s=o.length,a=typeof o[s-1]=="function";if(!a&&!An())throw new Error("Callback required as last argument");if(a){if(s<2)throw new Error("Too few arguments provided");s===2?(i=n,n=t,t=r=void 0):s===3&&(t.getContext&&typeof i>"u"?(i=r,r=void 0):(i=r,r=n,n=t,t=void 0))}else{if(s<1)throw new Error("Too few arguments provided");return s===1?(n=t,t=r=void 0):s===2&&!t.getContext&&(r=n,n=t,t=void 0),new Promise(function(l,h){try{const f=Ve.create(n,r);l(e(f,t,r))}catch(f){h(f)}})}try{const l=Ve.create(n,r);i(null,e(l,t,r))}catch(l){i(l)}}fe.create=Ve.create;fe.toCanvas=We.bind(null,At.render);fe.toDataURL=We.bind(null,At.renderToDataURL);fe.toString=We.bind(null,function(e,t,n){return kn.render(e,n)});const tt="#0000",Sn={white:{dark:"#FFF",light:tt},black:{dark:"#000",light:tt}},Dn=({info:e,options:t})=>{const[n,r]=x.useState(),i=x.useRef(null);return x.useEffect(()=>{fe.toCanvas(i.current,e,t,o=>{o&&r(o)})},[e,t]),n?d.jsx(d.Fragment,{children:"Ups, something went wrong (Code: QR1)"}):d.jsx("canvas",{ref:i})};function J(e,t,n){this.ordinal_Renamed_Field=e,this.bits=t,this.name=n}J.prototype.ordinal=function(){return this.ordinal_Renamed_Field};J.forBits=function(e){if(e<0||e>=nt.length)throw"ArgumentException";return nt[e]};var nt=[new J(1,0,"M"),new J(0,1,"L"),new J(3,2,"H"),new J(2,3,"Q")],Fn=21522,rt=[[21522,0],[20773,1],[24188,2],[23371,3],[17913,4],[16590,5],[20375,6],[19104,7],[30660,8],[29427,9],[32170,10],[30877,11],[26159,12],[25368,13],[27713,14],[26998,15],[5769,16],[5054,17],[7399,18],[6608,19],[1890,20],[597,21],[3340,22],[2107,23],[13663,24],[12392,25],[16177,26],[14854,27],[9396,28],[8579,29],[11994,30],[11245,31]],H=[0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4];function F(e){this.errorCorrectionLevel=J.forBits(e>>3&3),this.dataMask=e&7}F.prototype.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|this.dataMask};F.prototype.Equals=function(e){var t=e;return this.errorCorrectionLevel==t.errorCorrectionLevel&&this.dataMask==t.dataMask};F.numBitsDiffering=function(e,t){return e^=t,H[e&15]+H[z(e,4)&15]+H[z(e,8)&15]+H[z(e,12)&15]+H[z(e,16)&15]+H[z(e,20)&15]+H[z(e,24)&15]+H[z(e,28)&15]};F.decodeFormatInformation=function(e){var t=F.doDecodeFormatInformation(e);return t??F.doDecodeFormatInformation(e^Fn)};F.doDecodeFormatInformation=function(e){for(var t=4294967295,n=0,r=0;r<rt.length;r++){var i=rt[r],o=i[0];if(o==e)return new F(i[1]);var s=this.numBitsDiffering(e,o);s<t&&(n=i[1],t=s)}return t<=3?new F(n):null};function $(e,t){if(t||(t=e),e<1||t<1)throw"Both dimensions must be greater than 0";this.width=e,this.height=t;var n=e>>5;e&31&&n++,this.rowSize=n,this.bits=new Array(n*t);for(var r=0;r<this.bits.length;r++)this.bits[r]=0}Object.defineProperty($.prototype,"Dimension",{get:function(){if(this.width!=this.height)throw"Can't call getDimension() on a non-square matrix";return this.width}});$.prototype.get_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);return(z(this.bits[n],e&31)&1)!=0};$.prototype.set_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]|=1<<(e&31)};$.prototype.flip=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]^=1<<(e&31)};$.prototype.clear=function(){for(var e=this.bits.length,t=0;t<e;t++)this.bits[t]=0};$.prototype.setRegion=function(e,t,n,r){if(t<0||e<0)throw"Left and top must be nonnegative";if(r<1||n<1)throw"Height and width must be at least 1";var i=e+n,o=t+r;if(o>this.height||i>this.width)throw"The region must fit inside the matrix";for(var s=t;s<o;s++)for(var a=s*this.rowSize,l=e;l<i;l++)this.bits[a+(l>>5)]|=1<<(l&31)};function c(e,t){this.count=e,this.dataCodewords=t}function u(e,t,n){this.ecCodewordsPerBlock=e,n?this.ecBlocks=[t,n]:this.ecBlocks=[t]}Object.defineProperty(u.prototype,"TotalECCodewords",{get:function(){return this.ecCodewordsPerBlock*this.NumBlocks}});Object.defineProperty(u.prototype,"NumBlocks",{get:function(){for(var e=0,t=0;t<this.ecBlocks.length;t++)e+=this.ecBlocks[t].length;return e}});u.prototype.getECBlocks=function(){return this.ecBlocks};function C(e,t,n,r,i,o){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=[n,r,i,o];for(var s=0,a=n.ecCodewordsPerBlock,l=n.getECBlocks(),h=0;h<l.length;h++){var f=l[h];s+=f.count*(f.dataCodewords+a)}this.totalCodewords=s}Object.defineProperty(C.prototype,"DimensionForVersion",{get:function(){return 17+4*this.versionNumber}});C.prototype.buildFunctionPattern=function(){var e=this.DimensionForVersion,t=new $(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,r=0;r<n;r++)for(var i=this.alignmentPatternCenters[r]-2,o=0;o<n;o++)r==0&&(o==0||o==n-1)||r==n-1&&o==0||t.setRegion(this.alignmentPatternCenters[o]-2,i,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t};C.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.ordinal()]};C.VERSION_DECODE_INFO=[31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017];C.VERSIONS=Rn();C.getVersionForNumber=function(e){if(e<1||e>40)throw"ArgumentException";return C.VERSIONS[e-1]};C.getProvisionalVersionForDimension=function(e){if(e%4!=1)throw"Error getProvisionalVersionForDimension";try{return C.getVersionForNumber(e-17>>2)}catch{throw"Error getVersionForNumber"}};C.decodeVersionInformation=function(e){for(var t=4294967295,n=0,r=0;r<C.VERSION_DECODE_INFO.length;r++){var i=C.VERSION_DECODE_INFO[r];if(i==e)return this.getVersionForNumber(r+7);var o=F.numBitsDiffering(e,i);o<t&&(n=r+7,t=o)}return t<=3?this.getVersionForNumber(n):null};function Rn(){return[new C(1,[],new u(7,new c(1,19)),new u(10,new c(1,16)),new u(13,new c(1,13)),new u(17,new c(1,9))),new C(2,[6,18],new u(10,new c(1,34)),new u(16,new c(1,28)),new u(22,new c(1,22)),new u(28,new c(1,16))),new C(3,[6,22],new u(15,new c(1,55)),new u(26,new c(1,44)),new u(18,new c(2,17)),new u(22,new c(2,13))),new C(4,[6,26],new u(20,new c(1,80)),new u(18,new c(2,32)),new u(26,new c(2,24)),new u(16,new c(4,9))),new C(5,[6,30],new u(26,new c(1,108)),new u(24,new c(2,43)),new u(18,new c(2,15),new c(2,16)),new u(22,new c(2,11),new c(2,12))),new C(6,[6,34],new u(18,new c(2,68)),new u(16,new c(4,27)),new u(24,new c(4,19)),new u(28,new c(4,15))),new C(7,[6,22,38],new u(20,new c(2,78)),new u(18,new c(4,31)),new u(18,new c(2,14),new c(4,15)),new u(26,new c(4,13),new c(1,14))),new C(8,[6,24,42],new u(24,new c(2,97)),new u(22,new c(2,38),new c(2,39)),new u(22,new c(4,18),new c(2,19)),new u(26,new c(4,14),new c(2,15))),new C(9,[6,26,46],new u(30,new c(2,116)),new u(22,new c(3,36),new c(2,37)),new u(20,new c(4,16),new c(4,17)),new u(24,new c(4,12),new c(4,13))),new C(10,[6,28,50],new u(18,new c(2,68),new c(2,69)),new u(26,new c(4,43),new c(1,44)),new u(24,new c(6,19),new c(2,20)),new u(28,new c(6,15),new c(2,16))),new C(11,[6,30,54],new u(20,new c(4,81)),new u(30,new c(1,50),new c(4,51)),new u(28,new c(4,22),new c(4,23)),new u(24,new c(3,12),new c(8,13))),new C(12,[6,32,58],new u(24,new c(2,92),new c(2,93)),new u(22,new c(6,36),new c(2,37)),new u(26,new c(4,20),new c(6,21)),new u(28,new c(7,14),new c(4,15))),new C(13,[6,34,62],new u(26,new c(4,107)),new u(22,new c(8,37),new c(1,38)),new u(24,new c(8,20),new c(4,21)),new u(22,new c(12,11),new c(4,12))),new C(14,[6,26,46,66],new u(30,new c(3,115),new c(1,116)),new u(24,new c(4,40),new c(5,41)),new u(20,new c(11,16),new c(5,17)),new u(24,new c(11,12),new c(5,13))),new C(15,[6,26,48,70],new u(22,new c(5,87),new c(1,88)),new u(24,new c(5,41),new c(5,42)),new u(30,new c(5,24),new c(7,25)),new u(24,new c(11,12),new c(7,13))),new C(16,[6,26,50,74],new u(24,new c(5,98),new c(1,99)),new u(28,new c(7,45),new c(3,46)),new u(24,new c(15,19),new c(2,20)),new u(30,new c(3,15),new c(13,16))),new C(17,[6,30,54,78],new u(28,new c(1,107),new c(5,108)),new u(28,new c(10,46),new c(1,47)),new u(28,new c(1,22),new c(15,23)),new u(28,new c(2,14),new c(17,15))),new C(18,[6,30,56,82],new u(30,new c(5,120),new c(1,121)),new u(26,new c(9,43),new c(4,44)),new u(28,new c(17,22),new c(1,23)),new u(28,new c(2,14),new c(19,15))),new C(19,[6,30,58,86],new u(28,new c(3,113),new c(4,114)),new u(26,new c(3,44),new c(11,45)),new u(26,new c(17,21),new c(4,22)),new u(26,new c(9,13),new c(16,14))),new C(20,[6,34,62,90],new u(28,new c(3,107),new c(5,108)),new u(26,new c(3,41),new c(13,42)),new u(30,new c(15,24),new c(5,25)),new u(28,new c(15,15),new c(10,16))),new C(21,[6,28,50,72,94],new u(28,new c(4,116),new c(4,117)),new u(26,new c(17,42)),new u(28,new c(17,22),new c(6,23)),new u(30,new c(19,16),new c(6,17))),new C(22,[6,26,50,74,98],new u(28,new c(2,111),new c(7,112)),new u(28,new c(17,46)),new u(30,new c(7,24),new c(16,25)),new u(24,new c(34,13))),new C(23,[6,30,54,74,102],new u(30,new c(4,121),new c(5,122)),new u(28,new c(4,47),new c(14,48)),new u(30,new c(11,24),new c(14,25)),new u(30,new c(16,15),new c(14,16))),new C(24,[6,28,54,80,106],new u(30,new c(6,117),new c(4,118)),new u(28,new c(6,45),new c(14,46)),new u(30,new c(11,24),new c(16,25)),new u(30,new c(30,16),new c(2,17))),new C(25,[6,32,58,84,110],new u(26,new c(8,106),new c(4,107)),new u(28,new c(8,47),new c(13,48)),new u(30,new c(7,24),new c(22,25)),new u(30,new c(22,15),new c(13,16))),new C(26,[6,30,58,86,114],new u(28,new c(10,114),new c(2,115)),new u(28,new c(19,46),new c(4,47)),new u(28,new c(28,22),new c(6,23)),new u(30,new c(33,16),new c(4,17))),new C(27,[6,34,62,90,118],new u(30,new c(8,122),new c(4,123)),new u(28,new c(22,45),new c(3,46)),new u(30,new c(8,23),new c(26,24)),new u(30,new c(12,15),new c(28,16))),new C(28,[6,26,50,74,98,122],new u(30,new c(3,117),new c(10,118)),new u(28,new c(3,45),new c(23,46)),new u(30,new c(4,24),new c(31,25)),new u(30,new c(11,15),new c(31,16))),new C(29,[6,30,54,78,102,126],new u(30,new c(7,116),new c(7,117)),new u(28,new c(21,45),new c(7,46)),new u(30,new c(1,23),new c(37,24)),new u(30,new c(19,15),new c(26,16))),new C(30,[6,26,52,78,104,130],new u(30,new c(5,115),new c(10,116)),new u(28,new c(19,47),new c(10,48)),new u(30,new c(15,24),new c(25,25)),new u(30,new c(23,15),new c(25,16))),new C(31,[6,30,56,82,108,134],new u(30,new c(13,115),new c(3,116)),new u(28,new c(2,46),new c(29,47)),new u(30,new c(42,24),new c(1,25)),new u(30,new c(23,15),new c(28,16))),new C(32,[6,34,60,86,112,138],new u(30,new c(17,115)),new u(28,new c(10,46),new c(23,47)),new u(30,new c(10,24),new c(35,25)),new u(30,new c(19,15),new c(35,16))),new C(33,[6,30,58,86,114,142],new u(30,new c(17,115),new c(1,116)),new u(28,new c(14,46),new c(21,47)),new u(30,new c(29,24),new c(19,25)),new u(30,new c(11,15),new c(46,16))),new C(34,[6,34,62,90,118,146],new u(30,new c(13,115),new c(6,116)),new u(28,new c(14,46),new c(23,47)),new u(30,new c(44,24),new c(7,25)),new u(30,new c(59,16),new c(1,17))),new C(35,[6,30,54,78,102,126,150],new u(30,new c(12,121),new c(7,122)),new u(28,new c(12,47),new c(26,48)),new u(30,new c(39,24),new c(14,25)),new u(30,new c(22,15),new c(41,16))),new C(36,[6,24,50,76,102,128,154],new u(30,new c(6,121),new c(14,122)),new u(28,new c(6,47),new c(34,48)),new u(30,new c(46,24),new c(10,25)),new u(30,new c(2,15),new c(64,16))),new C(37,[6,28,54,80,106,132,158],new u(30,new c(17,122),new c(4,123)),new u(28,new c(29,46),new c(14,47)),new u(30,new c(49,24),new c(10,25)),new u(30,new c(24,15),new c(46,16))),new C(38,[6,32,58,84,110,136,162],new u(30,new c(4,122),new c(18,123)),new u(28,new c(13,46),new c(32,47)),new u(30,new c(48,24),new c(14,25)),new u(30,new c(42,15),new c(32,16))),new C(39,[6,26,54,82,110,138,166],new u(30,new c(20,117),new c(4,118)),new u(28,new c(40,47),new c(7,48)),new u(30,new c(43,24),new c(22,25)),new u(30,new c(10,15),new c(67,16))),new C(40,[6,30,58,86,114,142,170],new u(30,new c(19,118),new c(6,119)),new u(28,new c(18,47),new c(31,48)),new u(30,new c(34,24),new c(34,25)),new u(30,new c(20,15),new c(61,16)))]}function se(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n}Object.defineProperty(se.prototype,"X",{get:function(){return Math.floor(this.x)}});Object.defineProperty(se.prototype,"Y",{get:function(){return Math.floor(this.y)}});se.prototype.incrementCount=function(){this.count++};se.prototype.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this.estimatedModuleSize);return r<=1||r/this.estimatedModuleSize<=1}return!1};function le(e,t,n,r,i,o,s){this.image=e,this.possibleCenters=[],this.startX=t,this.startY=n,this.width=r,this.height=i,this.moduleSize=o,this.crossCheckStateCount=[0,0,0],this.resultPointCallback=s}le.prototype.centerFromEnd=function(e,t){return t-e[2]-e[1]/2};le.prototype.foundPatternCross=function(e){for(var t=this.moduleSize,n=t/2,r=0;r<3;r++)if(Math.abs(t-e[r])>=n)return!1;return!0};le.prototype.crossCheckVertical=function(e,t,n,r){var i=this.image,o=i.height,s=this.crossCheckStateCount;s[0]=0,s[1]=0,s[2]=0;for(var a=e;a>=0&&i.data[t+a*i.width]&&s[1]<=n;)s[1]++,a--;if(a<0||s[1]>n)return NaN;for(;a>=0&&!i.data[t+a*i.width]&&s[0]<=n;)s[0]++,a--;if(s[0]>n)return NaN;for(a=e+1;a<o&&i.data[t+a*i.width]&&s[1]<=n;)s[1]++,a++;if(a==o||s[1]>n)return NaN;for(;a<o&&!i.data[t+a*i.width]&&s[2]<=n;)s[2]++,a++;if(s[2]>n)return NaN;var l=s[0]+s[1]+s[2];return 5*Math.abs(l-r)>=2*r?NaN:this.foundPatternCross(s)?this.centerFromEnd(s,a):NaN};le.prototype.handlePossibleCenter=function(e,t,n){var r=e[0]+e[1]+e[2],i=this.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(i),2*e[1],r);if(!isNaN(o)){for(var s=(e[0]+e[1]+e[2])/3,a=this.possibleCenters.length,l=0;l<a;l++){var h=this.possibleCenters[l];if(h.aboutEquals(s,o,i))return new se(i,o,s)}var f=new se(i,o,s);this.possibleCenters.push(f),this.resultPointCallback!=null&&this.resultPointCallback.foundPossibleResultPoint(f)}return null};le.prototype.find=function(){for(var e=this.image,t=this.startX,n=this.height,r=t+this.width,i=this.startY+(n>>1),o=[0,0,0],s=0;s<n;s++){var a=i+(s&1?-(s+1>>1):s+1>>1);o[0]=0,o[1]=0,o[2]=0;for(var l=t;l<r&&!e.data[l+e.width*a];)l++;for(var h=0;l<r;){if(e.data[l+a*e.width])if(h==1)o[h]++;else if(h==2){if(this.foundPatternCross(o)){var f=this.handlePossibleCenter(o,a,l);if(f!=null)return f}o[0]=o[2],o[1]=1,o[2]=0,h=1}else o[++h]++;else h==1&&h++,o[h]++;l++}if(this.foundPatternCross(o)){var f=this.handlePossibleCenter(o,a,r);if(f!=null)return f}}if(this.possibleCenters.length!=0)return this.possibleCenters[0];throw"Couldn't find enough alignment patterns"};var be={};be.checkAndNudgePoints=function(e,t){for(var n=e.width,r=e.height,i=!0,o=0;o<t.length&&i;o+=2){var s=Math.floor(t[o]),a=Math.floor(t[o+1]);if(s<-1||s>n||a<-1||a>r)throw"Error.checkAndNudgePoints ";i=!1,s==-1?(t[o]=0,i=!0):s==n&&(t[o]=n-1,i=!0),a==-1?(t[o+1]=0,i=!0):a==r&&(t[o+1]=r-1,i=!0)}i=!0;for(var o=t.length-2;o>=0&&i;o-=2){var s=Math.floor(t[o]),a=Math.floor(t[o+1]);if(s<-1||s>n||a<-1||a>r)throw"Error.checkAndNudgePoints ";i=!1,s==-1?(t[o]=0,i=!0):s==n&&(t[o]=n-1,i=!0),a==-1?(t[o+1]=0,i=!0):a==r&&(t[o+1]=r-1,i=!0)}};be.sampleGrid3=function(e,t,n){for(var r=new $(t),i=new Array(t<<1),o=0;o<t;o++){for(var s=i.length,a=o+.5,l=0;l<s;l+=2)i[l]=(l>>1)+.5,i[l+1]=a;n.transformPoints1(i),be.checkAndNudgePoints(e,i);try{for(var l=0;l<s;l+=2){var h=e.data[Math.floor(i[l])+e.width*Math.floor(i[l+1])];h&&r.set_Renamed(l>>1,o)}}catch{throw"Error.checkAndNudgePoints"}}return r};var it=3,Tn=57,X=8,kt=2;function In(e){function t(f,v){var w=f.X-v.X,g=f.Y-v.Y;return Math.sqrt(w*w+g*g)}function n(f,v,w){var g=v.x,p=v.y;return(w.x-g)*(f.y-p)-(w.y-p)*(f.x-g)}var r=t(e[0],e[1]),i=t(e[1],e[2]),o=t(e[0],e[2]),s,a,l;if(i>=r&&i>=o?(a=e[0],s=e[1],l=e[2]):o>=i&&o>=r?(a=e[1],s=e[0],l=e[2]):(a=e[2],s=e[0],l=e[1]),n(s,a,l)<0){var h=s;s=l,l=h}e[0]=s,e[1]=a,e[2]=l}function we(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n}Object.defineProperty(we.prototype,"X",{get:function(){return this.x}});Object.defineProperty(we.prototype,"Y",{get:function(){return this.y}});we.prototype.incrementCount=function(){this.count++};we.prototype.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this.estimatedModuleSize);return r<=1||r/this.estimatedModuleSize<=1}return!1};function On(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}function O(){this.image=null,this.possibleCenters=[],this.hasSkipped=!1,this.crossCheckStateCount=[0,0,0,0,0],this.resultPointCallback=null}Object.defineProperty(O.prototype,"CrossCheckStateCount",{get:function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount}});O.prototype.foundPatternCross=function(e){for(var t=0,n=0;n<5;n++){var r=e[n];if(r==0)return!1;t+=r}if(t<7)return!1;var i=Math.floor((t<<X)/7),o=Math.floor(i/2);return Math.abs(i-(e[0]<<X))<o&&Math.abs(i-(e[1]<<X))<o&&Math.abs(3*i-(e[2]<<X))<3*o&&Math.abs(i-(e[3]<<X))<o&&Math.abs(i-(e[4]<<X))<o};O.prototype.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2};O.prototype.crossCheckVertical=function(e,t,n,r){for(var i=this.image,o=i.height,s=this.CrossCheckStateCount,a=e;a>=0&&i.data[t+a*i.width];)s[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.data[t+a*i.width]&&s[1]<=n;)s[1]++,a--;if(a<0||s[1]>n)return NaN;for(;a>=0&&i.data[t+a*i.width]&&s[0]<=n;)s[0]++,a--;if(s[0]>n)return NaN;for(a=e+1;a<o&&i.data[t+a*i.width];)s[2]++,a++;if(a==o)return NaN;for(;a<o&&!i.data[t+a*i.width]&&s[3]<n;)s[3]++,a++;if(a==o||s[3]>=n)return NaN;for(;a<o&&i.data[t+a*i.width]&&s[4]<n;)s[4]++,a++;if(s[4]>=n)return NaN;var l=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(l-r)>=2*r?NaN:this.foundPatternCross(s)?this.centerFromEnd(s,a):NaN};O.prototype.crossCheckHorizontal=function(e,t,n,r){for(var i=this.image,o=i.width,s=this.CrossCheckStateCount,a=e;a>=0&&i.data[a+t*i.width];)s[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.data[a+t*i.width]&&s[1]<=n;)s[1]++,a--;if(a<0||s[1]>n)return NaN;for(;a>=0&&i.data[a+t*i.width]&&s[0]<=n;)s[0]++,a--;if(s[0]>n)return NaN;for(a=e+1;a<o&&i.data[a+t*i.width];)s[2]++,a++;if(a==o)return NaN;for(;a<o&&!i.data[a+t*i.width]&&s[3]<n;)s[3]++,a++;if(a==o||s[3]>=n)return NaN;for(;a<o&&i.data[a+t*i.width]&&s[4]<n;)s[4]++,a++;if(s[4]>=n)return NaN;var l=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(l-r)>=r?NaN:this.foundPatternCross(s)?this.centerFromEnd(s,a):NaN};O.prototype.handlePossibleCenter=function(e,t,n){var r=e[0]+e[1]+e[2]+e[3]+e[4],i=this.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(i),e[2],r);if(!isNaN(o)&&(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(o),e[2],r),!isNaN(i))){for(var s=r/7,a=!1,l=this.possibleCenters.length,h=0;h<l;h++){var f=this.possibleCenters[h];if(f.aboutEquals(s,o,i)){f.incrementCount(),a=!0;break}}if(!a){var v=new we(i,o,s);this.possibleCenters.push(v),this.resultPointCallback!=null&&this.resultPointCallback.foundPossibleResultPoint(v)}return!0}return!1};O.prototype.selectBestPatterns=function(){var e=this.possibleCenters.length;if(e<3)throw"Couldn't find enough finder patterns:"+e+" patterns found";if(e>3){for(var t=0,n=0,r=0;r<e;r++){var i=this.possibleCenters[r].estimatedModuleSize;t+=i,n+=i*i}var o=t/e;this.possibleCenters.sort(function(h,f){var v=Math.abs(f.estimatedModuleSize-o),w=Math.abs(h.estimatedModuleSize-o);return v<w?-1:v==w?0:1});for(var s=Math.sqrt(n/e-o*o),a=Math.max(.2*o,s),r=this.possibleCenters-1;r>=0;r--){var l=this.possibleCenters[r];Math.abs(l.estimatedModuleSize-o)>a&&this.possibleCenters.splice(r,1)}}return this.possibleCenters.length>3&&this.possibleCenters.sort(function(h,f){return h.count>f.count?-1:h.count<f.count?1:0}),[this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2]]};O.prototype.findRowSkip=function(){var e=this.possibleCenters.length;if(e<=1)return 0;for(var t=null,n=0;n<e;n++){var r=this.possibleCenters[n];if(r.count>=kt)if(t==null)t=r;else return this.hasSkipped=!0,Math.floor((Math.abs(t.X-r.X)-Math.abs(t.Y-r.Y))/2)}return 0};O.prototype.haveMultiplyConfirmedCenters=function(){for(var e=0,t=0,n=this.possibleCenters.length,r=0;r<n;r++){var i=this.possibleCenters[r];i.count>=kt&&(e++,t+=i.estimatedModuleSize)}if(e<3)return!1;for(var o=t/n,s=0,r=0;r<n;r++)i=this.possibleCenters[r],s+=Math.abs(i.estimatedModuleSize-o);return s<=.05*t};O.prototype.findFinderPattern=function(e){var t=!1;this.image=e;var n=e.height,r=e.width,i=Math.floor(3*n/(4*Tn));(i<it||t)&&(i=it);for(var o=!1,s=new Array(5),a=i-1;a<n&&!o;a+=i){s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0;for(var l=0,h=0;h<r;h++)if(e.data[h+a*e.width])(l&1)==1&&l++,s[l]++;else if(l&1)s[l]++;else if(l==4)if(this.foundPatternCross(s)){var f=this.handlePossibleCenter(s,a,h);if(f)if(i=2,this.hasSkipped)o=this.haveMultiplyConfirmedCenters();else{var v=this.findRowSkip();v>s[2]&&(a+=v-s[2]-i,h=r-1)}else{do h++;while(h<r&&!e.data[h+a*e.width]);h--}l=0,s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0}else s[0]=s[2],s[1]=s[3],s[2]=s[4],s[3]=1,s[4]=0,l=3;else s[++l]++;if(this.foundPatternCross(s)){var f=this.handlePossibleCenter(s,a,r);f&&(i=s[0],this.hasSkipped&&(o=this.haveMultiplyConfirmedCenters()))}}var w=this.selectBestPatterns();return In(w),new On(w)};function R(e,t,n,r,i,o,s,a,l){this.a11=e,this.a12=r,this.a13=s,this.a21=t,this.a22=i,this.a23=a,this.a31=n,this.a32=o,this.a33=l}R.prototype.transformPoints1=function(e){for(var t=e.length,n=this.a11,r=this.a12,i=this.a13,o=this.a21,s=this.a22,a=this.a23,l=this.a31,h=this.a32,f=this.a33,v=0;v<t;v+=2){var w=e[v],g=e[v+1],p=i*w+a*g+f;e[v]=(n*w+o*g+l)/p,e[v+1]=(r*w+s*g+h)/p}};R.prototype.transformPoints2=function(e,t){for(var n=e.length,r=0;r<n;r++){var i=e[r],o=t[r],s=this.a13*i+this.a23*o+this.a33;e[r]=(this.a11*i+this.a21*o+this.a31)/s,t[r]=(this.a12*i+this.a22*o+this.a32)/s}};R.prototype.buildAdjoint=function(){return new R(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)};R.prototype.times=function(e){return new R(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)};R.quadrilateralToQuadrilateral=function(e,t,n,r,i,o,s,a,l,h,f,v,w,g,p,b){var N=this.quadrilateralToSquare(e,t,n,r,i,o,s,a),y=this.squareToQuadrilateral(l,h,f,v,w,g,p,b);return y.times(N)};R.squareToQuadrilateral=function(e,t,n,r,i,o,s,a){var l=a-o,h=t-r+o-a;if(l==0&&h==0)return new R(n-e,i-n,e,r-t,o-r,t,0,0,1);var f=n-i,v=s-i,w=e-n+i-s,g=r-o,p=f*l-v*g,b=(w*l-v*h)/p,N=(f*h-w*g)/p;return new R(n-e+b*n,s-e+N*s,e,r-t+b*r,a-t+N*a,t,b,N,1)};R.quadrilateralToSquare=function(e,t,n,r,i,o,s,a){return this.squareToQuadrilateral(e,t,n,r,i,o,s,a).buildAdjoint()};function _n(e,t){this.bits=e,this.points=t}function T(e){this.image=e,this.resultPointCallback=null}T.prototype.sizeOfBlackWhiteBlackRun=function(e,t,n,r){var i=Math.abs(r-t)>Math.abs(n-e);if(i){var o=e;e=t,t=o,o=n,n=r,r=o}for(var s=Math.abs(n-e),a=Math.abs(r-t),l=-s>>1,h=t<r?1:-1,f=e<n?1:-1,v=0,w=e,g=t;w!=n;w+=f){var p=i?g:w,b=i?w:g;if(v==1?this.image.data[p+b*this.image.width]&&v++:this.image.data[p+b*this.image.width]||v++,v==3){var N=w-e,y=g-t;return Math.sqrt(N*N+y*y)}if(l+=a,l>0){if(g==r)break;g+=h,l-=s}}var M=n-e,m=r-t;return Math.sqrt(M*M+m*m)};T.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,t,n,r){var i=this.sizeOfBlackWhiteBlackRun(e,t,n,r),o=1,s=e-(n-e);s<0?(o=e/(e-s),s=0):s>=this.image.width&&(o=(this.image.width-1-e)/(s-e),s=this.image.width-1);var a=Math.floor(t-(r-t)*o);return o=1,a<0?(o=t/(t-a),a=0):a>=this.image.height&&(o=(this.image.height-1-t)/(a-t),a=this.image.height-1),s=Math.floor(e+(s-e)*o),i+=this.sizeOfBlackWhiteBlackRun(e,t,s,a),i-1};T.prototype.calculateModuleSizeOneWay=function(e,t){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y)),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14};T.prototype.calculateModuleSize=function(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2};T.prototype.distance=function(e,t){var n=e.X-t.X,r=e.Y-t.Y;return Math.sqrt(n*n+r*r)};T.prototype.computeDimension=function(e,t,n,r){var i=Math.round(this.distance(e,t)/r),o=Math.round(this.distance(e,n)/r),s=(i+o>>1)+7;switch(s&3){case 0:s++;break;case 2:s--;break;case 3:throw"Error"}return s};T.prototype.findAlignmentInRegion=function(e,t,n,r){var i=Math.floor(r*e),o=Math.max(0,t-i),s=Math.min(this.image.width-1,t+i);if(s-o<e*3)throw"Error";var a=Math.max(0,n-i),l=Math.min(this.image.height-1,n+i),h=new le(this.image,o,a,s-o,l-a,e,this.resultPointCallback);return h.find()};T.prototype.createTransform=function(e,t,n,r,i){var o=i-3.5,s,a,l,h;r!=null?(s=r.X,a=r.Y,l=h=o-3):(s=t.X-e.X+n.X,a=t.Y-e.Y+n.Y,l=h=o);var f=R.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,l,h,3.5,o,e.X,e.Y,t.X,t.Y,s,a,n.X,n.Y);return f};T.prototype.sampleGrid=function(e,t,n){var r=be;return r.sampleGrid3(e,n,t)};T.prototype.processFinderPatternInfo=function(e){var t=e.topLeft,n=e.topRight,r=e.bottomLeft,i=this.calculateModuleSize(t,n,r);if(i<1)throw"Error";var o=this.computeDimension(t,n,r,i),s=C.getProvisionalVersionForDimension(o),a=s.DimensionForVersion-7,l=null;if(s.alignmentPatternCenters.length>0)for(var h=n.X-t.X+r.X,f=n.Y-t.Y+r.Y,v=1-3/a,w=Math.floor(t.X+v*(h-t.X)),g=Math.floor(t.Y+v*(f-t.Y)),p=4;p<=16;p<<=1){l=this.findAlignmentInRegion(i,w,g,p);break}var b=this.createTransform(t,n,r,l,o),N=this.sampleGrid(this.image,b,o),y;return l==null?y=[r,t,n]:y=[r,t,n,l],new _n(N,y)};T.prototype.detect=function(){var e=new O().findFinderPattern(this.image);return this.processFinderPatternInfo(e)};function k(e,t){if(t==null||t.length==0)throw"System.ArgumentException";this.field=e;var n=t.length;if(n>1&&t[0]==0){for(var r=1;r<n&&t[r]==0;)r++;if(r==n)this.coefficients=e.Zero.coefficients;else{this.coefficients=new Array(n-r);for(var i=0;i<this.coefficients.length;i++)this.coefficients[i]=0;for(var o=0;o<this.coefficients.length;o++)this.coefficients[o]=t[r+o]}}else this.coefficients=t}Object.defineProperty(k.prototype,"Zero",{get:function(){return this.coefficients[0]==0}});Object.defineProperty(k.prototype,"Degree",{get:function(){return this.coefficients.length-1}});k.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]};k.prototype.evaluateAt=function(e){if(e==0)return this.getCoefficient(0);var t=this.coefficients.length;if(e==1){for(var n=0,r=0;r<t;r++)n=this.field.addOrSubtract(n,this.coefficients[r]);return n}for(var i=this.coefficients[0],r=1;r<t;r++)i=this.field.addOrSubtract(this.field.multiply(e,i),this.coefficients[r]);return i};k.prototype.addOrSubtract=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(this.Zero)return e;if(e.Zero)return this;var t=this.coefficients,n=e.coefficients;if(t.length>n.length){var r=t;t=n,n=r}for(var i=new Array(n.length),o=n.length-t.length,s=0;s<o;s++)i[s]=n[s];for(var a=o;a<n.length;a++)i[a]=this.field.addOrSubtract(t[a-o],n[a]);return new k(this.field,i)};k.prototype.multiply1=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(this.Zero||e.Zero)return this.field.Zero;for(var t=this.coefficients,n=t.length,r=e.coefficients,i=r.length,o=new Array(n+i-1),s=0;s<n;s++)for(var a=t[s],l=0;l<i;l++)o[s+l]=this.field.addOrSubtract(o[s+l],this.field.multiply(a,r[l]));return new k(this.field,o)};k.prototype.multiply2=function(e){if(e==0)return this.field.Zero;if(e==1)return this;for(var t=this.coefficients.length,n=new Array(t),r=0;r<t;r++)n[r]=this.field.multiply(this.coefficients[r],e);return new k(this.field,n)};k.prototype.multiplyByMonomial=function(e,t){if(e<0)throw"System.ArgumentException";if(t==0)return this.field.Zero;for(var n=this.coefficients.length,r=new Array(n+e),i=0;i<r.length;i++)r[i]=0;for(var i=0;i<n;i++)r[i]=this.field.multiply(this.coefficients[i],t);return new k(this.field,r)};k.prototype.divide=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(e.Zero)throw"Divide by 0";for(var t=this.field.Zero,n=this,r=e.getCoefficient(e.Degree),i=this.field.inverse(r);n.Degree>=e.Degree&&!n.Zero;){var o=n.Degree-e.Degree,s=this.field.multiply(n.getCoefficient(n.Degree),i),a=e.multiplyByMonomial(o,s),l=this.field.buildMonomial(o,s);t=t.addOrSubtract(l),n=n.addOrSubtract(a)}return[t,n]};function S(e){this.expTable=new Array(256),this.logTable=new Array(256);for(var t=1,n=0;n<256;n++)this.expTable[n]=t,t<<=1,t>=256&&(t^=e);for(var n=0;n<255;n++)this.logTable[this.expTable[n]]=n;var r=new Array(1);r[0]=0,this.zero=new k(this,new Array(r));var i=new Array(1);i[0]=1,this.one=new k(this,new Array(i))}Object.defineProperty(S.prototype,"Zero",{get:function(){return this.zero}});Object.defineProperty(S.prototype,"One",{get:function(){return this.one}});S.prototype.buildMonomial=function(e,t){if(e<0)throw"System.ArgumentException";if(t==0)return this.zero;for(var n=new Array(e+1),r=0;r<n.length;r++)n[r]=0;return n[0]=t,new k(this,n)};S.prototype.exp=function(e){return this.expTable[e]};S.prototype.log=function(e){if(e==0)throw"System.ArgumentException";return this.logTable[e]};S.prototype.inverse=function(e){if(e==0)throw"System.ArithmeticException";return this.expTable[255-this.logTable[e]]};S.prototype.addOrSubtract=function(e,t){return e^t};S.prototype.multiply=function(e,t){return e==0||t==0?0:e==1?t:t==1?e:this.expTable[(this.logTable[e]+this.logTable[t])%255]};S.QR_CODE_FIELD=new S(285);S.DATA_MATRIX_FIELD=new S(301);function ge(e){this.field=e}ge.prototype.decode=function(e,t){for(var n=new k(this.field,e),r=new Array(t),i=0;i<r.length;i++)r[i]=0;for(var o=!1,s=!0,i=0;i<t;i++){var a=n.evaluateAt(this.field.exp(i));r[r.length-1-i]=a,a!=0&&(s=!1)}if(!s)for(var l=new k(this.field,r),h=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),l,t),f=h[0],v=h[1],w=this.findErrorLocations(f),g=this.findErrorMagnitudes(v,w,o),i=0;i<w.length;i++){var p=e.length-1-this.field.log(w[i]);if(p<0)throw"ReedSolomonException Bad error location";e[p]=S.prototype.addOrSubtract(e[p],g[i])}};ge.prototype.runEuclideanAlgorithm=function(e,t,n){if(e.Degree<t.Degree){var r=e;e=t,t=r}for(var i=e,o=t,s=this.field.One,a=this.field.Zero,l=this.field.Zero,h=this.field.One;o.Degree>=Math.floor(n/2);){var f=i,v=s,w=l;if(i=o,s=a,l=h,i.Zero)throw"r_{i-1} was zero";o=f;for(var g=this.field.Zero,p=i.getCoefficient(i.Degree),b=this.field.inverse(p);o.Degree>=i.Degree&&!o.Zero;){var N=o.Degree-i.Degree,y=this.field.multiply(o.getCoefficient(o.Degree),b);g=g.addOrSubtract(this.field.buildMonomial(N,y)),o=o.addOrSubtract(i.multiplyByMonomial(N,y))}a=g.multiply1(s).addOrSubtract(v),h=g.multiply1(l).addOrSubtract(w)}var M=h.getCoefficient(0);if(M==0)throw"ReedSolomonException sigmaTilde(0) was zero";var m=this.field.inverse(M),E=h.multiply2(m),B=o.multiply2(m);return[E,B]};ge.prototype.findErrorLocations=function(e){var t=e.Degree;if(t==1)return new Array(e.getCoefficient(1));for(var n=new Array(t),r=0,i=1;i<256&&r<t;i++)e.evaluateAt(i)==0&&(n[r]=this.field.inverse(i),r++);if(r!=t)throw"Error locator degree does not match number of roots";return n};ge.prototype.findErrorMagnitudes=function(e,t,n){for(var r=t.length,i=new Array(r),o=0;o<r;o++){for(var s=this.field.inverse(t[o]),a=1,l=0;l<r;l++)o!=l&&(a=this.field.multiply(a,S.prototype.addOrSubtract(1,this.field.multiply(t[l],s))));i[o]=this.field.multiply(e.evaluateAt(s),this.field.inverse(a)),n&&(i[o]=this.field.multiply(i[o],s))}return i};var Ee={};Ee.forReference=function(e){if(e<0||e>7)throw"System.ArgumentException";return Ee.DATA_MASKS[e]};function Ln(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return(e+t&1)==0}}function jn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return(e&1)==0}}function zn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return t%3==0}}function Vn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return(e+t)%3==0}}function Un(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return(z(e,1)+t/3&1)==0}}function Yn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){var n=e*t;return(n&1)+n%3==0}}function qn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){var n=e*t;return((n&1)+n%3&1)==0}}function Hn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return((e+t&1)+e*t%3&1)==0}}Ee.DATA_MASKS=[new Ln,new jn,new zn,new Vn,new Un,new Yn,new qn,new Hn];function ve(e){var t=e.Dimension;if(t<21||(t&3)!=1)throw"Error BitMatrixParser";this.bitMatrix=e,this.parsedVersion=null,this.parsedFormatInfo=null}ve.prototype.copyBit=function(e,t,n){return this.bitMatrix.get_Renamed(e,t)?n<<1|1:n<<1};ve.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!=null)return this.parsedFormatInfo;for(var e=0,t=0;t<6;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=F.decodeFormatInformation(e),this.parsedFormatInfo!=null)return this.parsedFormatInfo;var r=this.bitMatrix.Dimension;e=0;for(var i=r-8,t=r-1;t>=i;t--)e=this.copyBit(t,8,e);for(var n=r-7;n<r;n++)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=F.decodeFormatInformation(e),this.parsedFormatInfo!=null)return this.parsedFormatInfo;throw"Error readFormatInformation"};ve.prototype.readVersion=function(){if(this.parsedVersion!=null)return this.parsedVersion;var e=this.bitMatrix.Dimension,t=e-17>>2;if(t<=6)return C.getVersionForNumber(t);for(var n=0,r=e-11,i=5;i>=0;i--)for(var o=e-9;o>=r;o--)n=this.copyBit(o,i,n);if(this.parsedVersion=C.decodeVersionInformation(n),this.parsedVersion!=null&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;n=0;for(var o=5;o>=0;o--)for(var i=e-9;i>=r;i--)n=this.copyBit(o,i,n);if(this.parsedVersion=C.decodeVersionInformation(n),this.parsedVersion!=null&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;throw"Error readVersion"};ve.prototype.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),n=Ee.forReference(e.dataMask),r=this.bitMatrix.Dimension;n.unmaskBitMatrix(this.bitMatrix,r);for(var i=t.buildFunctionPattern(),o=!0,s=new Array(t.totalCodewords),a=0,l=0,h=0,f=r-1;f>0;f-=2){f==6&&f--;for(var v=0;v<r;v++)for(var w=o?r-1-v:v,g=0;g<2;g++)i.get_Renamed(f-g,w)||(h++,l<<=1,this.bitMatrix.get_Renamed(f-g,w)&&(l|=1),h==8&&(s[a++]=l,h=0,l=0));o^=!0}if(a!=t.totalCodewords)throw"Error readCodewords";return s};function Ue(e,t){this.numDataCodewords=e,this.codewords=t}Ue.getDataBlocks=function(e,t,n){if(e.length!=t.totalCodewords)throw"ArgumentException";for(var r=t.getECBlocksForLevel(n),i=0,o=r.getECBlocks(),s=0;s<o.length;s++)i+=o[s].count;for(var a=new Array(i),l=0,h=0;h<o.length;h++)for(var f=o[h],s=0;s<f.count;s++){var v=f.dataCodewords,w=r.ecCodewordsPerBlock+v;a[l++]=new Ue(v,new Array(w))}for(var g=a[0].codewords.length,p=a.length-1;p>=0;){var b=a[p].codewords.length;if(b==g)break;p--}p++;for(var N=g-r.ecCodewordsPerBlock,y=0,s=0;s<N;s++)for(var h=0;h<l;h++)a[h].codewords[s]=e[y++];for(var h=p;h<l;h++)a[h].codewords[N]=e[y++];for(var M=a[0].codewords.length,s=N;s<M;s++)for(var h=0;h<l;h++){var m=h<p?s:s+1;a[h].codewords[m]=e[y++]}return a};function U(e,t,n){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=e,this.numErrorCorrectionCode=n,t<=9?this.dataLengthMode=0:t>=10&&t<=26?this.dataLengthMode=1:t>=27&&t<=40&&(this.dataLengthMode=2)}U.prototype.getNextBits=function(e){var t=0;if(e<this.bitPointer+1){for(var n=0,r=0;r<e;r++)n+=1<<r;return n<<=this.bitPointer-e+1,t=(this.blocks[this.blockPointer]&n)>>this.bitPointer-e+1,this.bitPointer-=e,t}else if(e<this.bitPointer+1+8){for(var i=0,r=0;r<this.bitPointer+1;r++)i+=1<<r;return t=(this.blocks[this.blockPointer]&i)<<e-(this.bitPointer+1),this.blockPointer++,t+=this.blocks[this.blockPointer]>>8-(e-(this.bitPointer+1)),this.bitPointer=this.bitPointer-e%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}else if(e<this.bitPointer+1+16){for(var i=0,o=0,r=0;r<this.bitPointer+1;r++)i+=1<<r;var s=(this.blocks[this.blockPointer]&i)<<e-(this.bitPointer+1);this.blockPointer++;var a=this.blocks[this.blockPointer]<<e-(this.bitPointer+1+8);this.blockPointer++;for(var r=0;r<e-(this.bitPointer+1+8);r++)o+=1<<r;o<<=8-(e-(this.bitPointer+1+8));var l=(this.blocks[this.blockPointer]&o)>>8-(e-(this.bitPointer+1+8));return t=s+a+l,this.bitPointer=this.bitPointer-(e-8)%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}else return 0};U.prototype.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)};U.prototype.getDataLength=function(e){for(var t=0;e>>t!=1;)t++;return this.getNextBits(St.sizeOfDataLengthInfo[this.dataLengthMode][t])};U.prototype.getRomanAndFigureString=function(e){var t=e,n=0,r="",i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];do if(t>1){n=this.getNextBits(11);var o=Math.floor(n/45),s=n%45;r+=i[o],r+=i[s],t-=2}else t==1&&(n=this.getNextBits(6),r+=i[n],t-=1);while(t>0);return r};U.prototype.getFigureString=function(e){var t=e,n=0,r="";do t>=3?(n=this.getNextBits(10),n<100&&(r+="0"),n<10&&(r+="0"),t-=3):t==2?(n=this.getNextBits(7),n<10&&(r+="0"),t-=2):t==1&&(n=this.getNextBits(4),t-=1),r+=n;while(t>0);return r};U.prototype.get8bitByteArray=function(e){var t=e,n=0,r=[];do n=this.getNextBits(8),r.push(n),t--;while(t>0);return r};U.prototype.getKanjiString=function(e){var t=e,n=0,r="";do{n=this.getNextBits(13);var i=n%192,o=n/192,s=(o<<8)+i,a=0;s+33088<=40956?a=s+33088:a=s+49472,r+=String.fromCharCode(a),t--}while(t>0);return r};Object.defineProperty(U.prototype,"DataByte",{get:function(){var e=[],t=1,n=2,r=4,i=8;do{var o=this.NextMode();if(o==0){if(e.length>0)break;throw"Empty data block"}if(o!=t&&o!=n&&o!=r&&o!=i&&o!=7)throw"Invalid mode: "+o+" in (block:"+this.blockPointer+" bit:"+this.bitPointer+")";var s=this.getDataLength(o);if(s<1)throw"Invalid data length: "+s;switch(o){case t:for(var f=this.getFigureString(s),l=new Array(f.length),a=0;a<f.length;a++)l[a]=f.charCodeAt(a);e.push(l);break;case n:for(var f=this.getRomanAndFigureString(s),l=new Array(f.length),a=0;a<f.length;a++)l[a]=f.charCodeAt(a);e.push(l);break;case r:var h=this.get8bitByteArray(s);e.push(h);break;case i:var f=this.getKanjiString(s);e.push(f);break}}while(!0);return e}});var ae={};ae.rsDecoder=new ge(S.QR_CODE_FIELD);ae.correctErrors=function(e,t){for(var n=e.length,r=new Array(n),i=0;i<n;i++)r[i]=e[i]&255;var o=e.length-t;try{ae.rsDecoder.decode(r,o)}catch(s){throw s}for(var i=0;i<t;i++)e[i]=r[i]};ae.decode=function(e){for(var t=new ve(e),n=t.readVersion(),r=t.readFormatInformation().errorCorrectionLevel,i=t.readCodewords(),o=Ue.getDataBlocks(i,n,r),s=0,a=0;a<o.length;a++)s+=o[a].numDataCodewords;for(var l=new Array(s),h=0,f=0;f<o.length;f++){var v=o[f],w=v.codewords,g=v.numDataCodewords;ae.correctErrors(w,g);for(var a=0;a<g;a++)l[h++]=w[a]}var p=new U(l,n.versionNumber,r.bits);return p};var St={};St.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]];function Y(){this.imagedata=null,this.width=0,this.height=0,this.qrCodeSymbol=null,this.debug=!1,this.callback=null}Y.prototype.decode=function(e,t){var n=(function(){try{this.error=void 0,this.result=this.process(this.imagedata)}catch(i){this.error=i,this.result=void 0}return this.callback!=null&&this.callback(this.error,this.result),this.result}).bind(this);if(e!=null&&e.width!=null)this.width=e.width,this.height=e.height,this.imagedata={data:t||e.data},this.imagedata.width=e.width,this.imagedata.height=e.height,n();else{if(typeof Image>"u")throw new Error("This source format is not supported in your environment, you need to pass an image buffer with width and height (see https://github.com/edi9999/jsqrcode/blob/master/test/qrcode.js)");var r=new Image;r.crossOrigin="Anonymous",r.onload=(function(){var i=document.createElement("canvas"),o=i.getContext("2d"),s=document.getElementById("out-canvas");if(s!=null){var a=s.getContext("2d");a.clearRect(0,0,320,240),a.drawImage(r,0,0,320,240)}i.width=r.width,i.height=r.height,o.drawImage(r,0,0),this.width=r.width,this.height=r.height;try{this.imagedata=o.getImageData(0,0,r.width,r.height)}catch{if(this.result="Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!",this.callback!=null)return this.callback(null,this.result)}n()}).bind(this),r.src=e}};Y.prototype.decode_utf8=function(e){return decodeURIComponent(escape(e))};Y.prototype.process=function(e){for(var t=new Date().getTime(),n=this.grayScaleToBitmap(this.grayscale(e)),r=new T(n),i=r.detect(),o=ae.decode(i.bits),s=o.DataByte,a="",l=0;l<s.length;l++)for(var h=0;h<s[l].length;h++)a+=String.fromCharCode(s[l][h]);var f=new Date().getTime(),v=f-t;return this.debug&&console.log("QR Code processing time (ms): "+v),{result:this.decode_utf8(a),points:i.points}};Y.prototype.getPixel=function(e,t,n){if(e.width<t||e.height<n)throw"point error";var r=t*4+n*e.width*4;return(e.data[r]*33+e.data[r+1]*34+e.data[r+2]*33)/100};Y.prototype.binarize=function(e){for(var t=new Array(this.width*this.height),n=0;n<this.height;n++)for(var r=0;r<this.width;r++){var i=this.getPixel(r,n);t[r+n*this.width]=i<=e}return t};Y.prototype.getMiddleBrightnessPerArea=function(e){for(var t=4,n=Math.floor(e.width/t),r=Math.floor(e.height/t),i=new Array(t),o=0;o<t;o++){i[o]=new Array(t);for(var s=0;s<t;s++)i[o][s]=[0,0]}for(var a=0;a<t;a++)for(var l=0;l<t;l++){i[l][a][0]=255;for(var h=0;h<r;h++)for(var f=0;f<n;f++){var v=e.data[n*l+f+(r*a+h)*e.width];v<i[l][a][0]&&(i[l][a][0]=v),v>i[l][a][1]&&(i[l][a][1]=v)}}for(var w=new Array(t),g=0;g<t;g++)w[g]=new Array(t);for(var a=0;a<t;a++)for(var l=0;l<t;l++)w[l][a]=Math.floor((i[l][a][0]+i[l][a][1])/2);return w};Y.prototype.grayScaleToBitmap=function(e){for(var t=this.getMiddleBrightnessPerArea(e),n=t.length,r=Math.floor(e.width/n),i=Math.floor(e.height/n),o=0;o<n;o++)for(var s=0;s<n;s++)for(var a=0;a<i;a++)for(var l=0;l<r;l++)e.data[r*s+l+(i*o+a)*e.width]=e.data[r*s+l+(i*o+a)*e.width]<t[s][o];return e};Y.prototype.grayscale=function(e){for(var t=new Array(e.width*e.height),n=0;n<e.height;n++)for(var r=0;r<e.width;r++){var i=this.getPixel(e,r,n);t[r+n*e.width]=i}return{height:e.height,width:e.width,data:t}};function z(e,t){return e>=0?e>>t:(e>>t)+(2<<~t)}const Qn=()=>navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment"}}),Kn=({onInput:e,prepareClose:t})=>{const[n,r]=x.useState(!1),[i,o]=x.useState(),[s,a]=x.useState(),l=x.useRef();l.current=s;const{width:h,height:f}=x.useMemo(()=>({width:window.innerWidth,height:window.innerHeight}),[]),v=x.useRef(null),w=x.useRef(null),g=x.useRef(!1),p=x.useRef(!1),b=x.useRef(()=>{}),N=x.useCallback(()=>{l.current.getTracks().forEach(m=>l.current.removeTrack(m)),w.current.srcObject=null,w.current.src=""},[]);x.useEffect(()=>{Qn().then(a).catch(m=>{m.name==="NotAllowedError"?r(!0):o(m)})},[N]),x.useEffect(()=>{t&&(w.current.pause(),N())},[t,N]);const y=x.useCallback(()=>{window.requestAnimationFrame(b.current)},[]);x.useEffect(()=>{const m=w.current;s&&!g.current&&(g.current=!0,m.srcObject=s,m.setAttribute("autoplay",""),m.setAttribute("muted",""),m.setAttribute("playsinline",""),y())},[y,s]);const M=x.useCallback((m,E)=>{if(m||t)return y();try{const{code:B,codeWords:P}=JSON.parse(atob(E.result));B.every(A=>typeof A=="number")&&typeof P.first=="string"&&typeof P.second=="string"&&typeof P.third=="string"&&(p.current||(p.current=!0,e({code:B,codeWords:P})))}catch{}y()},[e,y,t]);return b.current=x.useCallback(()=>{const m=v.current&&v.current.getContext("2d");if(m){const E=new Y;m.drawImage(w.current,0,0,h,f,0,0,h,f);const B=m.getImageData(0,0,h,f);E.callback=M,E.decode(B)}},[M,f,h]),n?d.jsx(d.Fragment,{children:V("media.camAccess.required")}):i?d.jsx(d.Fragment,{children:"Ups, something went wrong (Code: QR2)"}):d.jsx("div",{className:"scanner",children:s&&d.jsxs("div",{children:[d.jsx("video",{ref:w}),d.jsx("canvas",{width:h,height:f,ref:v})]})})},Ye={info:null,scanning:!1,closingScanner:!1},[Gn,ee]=ot(Ye),qe=()=>{const{closingScanner:e,scanning:t}=ee.get();e||(t?(ee.set({closingScanner:!0}),setTimeout(()=>ee.set(Ye),1e3)):ee.set(Ye))},Wn=e=>ee.set({info:e}),$n=()=>ee.set({scanning:!0}),Jn=({code:e,codeWords:t})=>{qe(),G.set(({enemy:n})=>({enemy:{...n,code:e,codeWords:t,round:n.round+1}}))},Zn=()=>{const{info:e,scanning:t,closingScanner:n}=Gn(i=>i),r=Math.min(window.innerWidth,window.innerHeight);return e?d.jsxs("div",{className:"qr-code",children:[d.jsx(Dn,{info:e,options:{color:Sn.black,width:r}}),d.jsx("button",{onClick:qe,children:d.jsx(Z.Times,{})})]}):t?d.jsxs("div",{className:"qr-scanning",style:n?{display:"none"}:void 0,children:[d.jsx(Kn,{onInput:Jn,prepareClose:n}),d.jsx("button",{onClick:qe,children:d.jsx(Z.Times,{})})]}):null},Xn=e=>G.set(({enemy:t})=>({enemy:{...t,...e}})),er=e=>G.set(({enemy:t,results:{wins:n,losses:r},results:i})=>{const{codeWords:o,code:s}=t,{first:a,second:l,third:h}=o,f=e[0]===s[0]&&e[1]===s[1]&&e[2]===s[2],v=[...t.knowledge].map(g=>[...g]);v[s[0]-1].push(a),v[s[1]-1].push(l),v[s[2]-1].push(h);const w={enemy:{...t,knowledge:v,guessed:e}};return f?{...w,results:{wins:n+1,losses:r}}:{...w,results:i}}),tr=()=>{const{code:e,codeWords:t,guessed:n,knowledge:r,round:i}=te(({enemy:l})=>l),o=te(({me:{round:l,codeWords:h},enemy:f})=>(h?l:l-1)<=f.round),s=x.useCallback(()=>{Xn({code:void 0,codeWords:void 0,guessed:void 0}),$n()},[]),a=!e||!!(e&&t&&n);return d.jsxs(d.Fragment,{children:[i>0&&d.jsxs("div",{className:"round",children:[V("DECRYPTO.round")," ",i]}),a&&d.jsx("div",{className:"scan-code",children:d.jsxs("button",{onClick:s,type:"button",disabled:o,children:[d.jsx(Z.Glasses,{}),d.jsx("div",{className:"description",children:V("DECRYPTO.btn.catch")})]})}),e&&t&&!n&&d.jsx(ht,{onSubmit:er,codeWords:t}),e&&t&&n&&d.jsx(ut,{codeWords:t,code:e,guessed:n}),d.jsx(ft,{knowledge:r})]})},nr={first:"",second:"",third:""},rr=_e.initialData(nr),Oe=e=>{if(!e||!e.trim())return{id:"DECRYPTO.codeWord.required"};try{btoa(e)}catch{return{id:"DECRYPTO.codeWord.invalid"}}},ir={first:{onChange:Oe},second:{onChange:Oe},third:{onChange:Oe}},or=({onSubmit:e,code:t})=>{const[n,r]=x.useState(rr),{fields:i,Form:o}=_e.useForm();return d.jsxs("div",{className:"code-words-selection",children:[t&&d.jsx("div",{className:"code",children:d.jsx("span",{children:t.join(".")})}),d.jsxs(o,{onChange:r,data:n,onSubmit:e,validation:ir,children:[d.jsx(Ae,{field:i.first}),d.jsx(Ae,{field:i.second}),d.jsx(Ae,{field:i.third}),d.jsxs("button",{type:"submit",disabled:_e.notSubmittable(n),children:[d.jsx(Z.Mask,{}),d.jsx("div",{className:"description",children:V("DECRYPTO.btn.submit")})]})]})]})},sr=({codeWords:e,code:t})=>{const n=x.useCallback(()=>Wn(btoa(JSON.stringify({code:t,codeWords:e}))),[t,e]);return d.jsxs("button",{className:"open-qr-code",onClick:n,type:"button",children:[d.jsx(Z.QrCode,{}),d.jsx("div",{className:"description",children:V("DECRYPTO.btn.transfer")})]})},ar=()=>K.arrayShuffle([1,2,3,4]).slice(0,3),lr=()=>G.set(({me:e})=>({me:{...e,code:ar(),codeWords:void 0,guessed:void 0,round:e.round+1}})),cr=e=>G.set(({me:t})=>({me:{...t,codeWords:e}})),hr=e=>G.set(({me:t,results:{wins:n,losses:r},results:i})=>{const{codeWords:o,code:s}=t,{first:a,second:l,third:h}=o,f=e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2],v=[...t.knowledge].map(g=>[...g]);v[s[0]-1].push(a),v[s[1]-1].push(l),v[s[2]-1].push(h);const w={me:{...t,knowledge:v,guessed:e}};return f?{...w,results:{wins:n,losses:r+1}}:{...w,results:i}}),ur=()=>{const{code:e,codeWords:t,guessed:n,knowledge:r,round:i}=te(({me:a})=>a),o=te(({enemy:{guessed:a,round:l},me:h,results:{wins:f,losses:v}})=>{const w=a?l:l-1,g=h.round;return v>1||f>1||g>0&&w!==g}),s=!e||!!(e&&t&&n);return d.jsxs(d.Fragment,{children:[i>0&&d.jsxs("div",{className:"round",children:[V("DECRYPTO.round")," ",i]}),s&&d.jsx("div",{className:"generate-code",children:d.jsxs("button",{onClick:lr,type:"button",disabled:o,children:["?.?.?",d.jsx("div",{className:"description",children:V("DECRYPTO.btn.generate")})]})}),e&&!t&&d.jsx(or,{onSubmit:cr,code:e}),e&&t&&!n&&d.jsx(ht,{onSubmit:hr,codeWords:t}),e&&t&&n&&d.jsx(ut,{codeWords:t,code:e,guessed:n}),e&&t&&d.jsx(sr,{code:e,codeWords:t}),d.jsx(ft,{knowledge:r})]})},fr=()=>{const[e,t]=x.useState(),{wins:n,losses:r}=te(({results:s})=>s),i=x.useRef({wins:n,losses:r}),o=x.useCallback(()=>t(void 0),[]);return x.useEffect(()=>{i.current.wins===1&&n===2?t("WON"):i.current.losses===1&&r===2&&t("LOST"),i.current={wins:n,losses:r}},[n,r]),e?d.jsx("div",{className:"result-overlay",onClick:o,children:d.jsx("span",{children:V(e==="WON"?"DECRYPTO.won":"DECRYPTO.lost")})}):null},dr=()=>{const[e,t]=x.useState(!1),{losses:n,wins:r}=te(({results:o})=>o),i=x.useCallback(()=>t(o=>!o),[]);return d.jsx("div",{className:K.classNames("decrypto",e&&"enemy",n>0&&"alarm",r>0&&"success"),children:d.jsxs("div",{className:"decrypto-inner",children:[d.jsx(fr,{}),d.jsx("div",{className:"navigation",children:d.jsx("button",{type:"button",onClick:i,children:d.jsx(Z.Exchange,{})})}),d.jsx("div",{className:"content",children:e?d.jsx(tr,{}):d.jsx(ur,{})}),d.jsx(Zn,{})]})})},wr=()=>d.jsx(Ft,{children:d.jsx(Rt,{onClick:G.reset})}),yr=()=>d.jsxs(Dt,{fix:G.reset,children:[d.jsx(dr,{}),d.jsx(wr,{})]});export{yr as default};
