import{E as xt,F as Tt,b as It}from"./FooterRestart.3507ed4b.js";import{c as at,P as lt,r as N,a as A,j as v,I as j,_ as Y,F as ne,U as W}from"./index.7eb625f0.js";import{F as De}from"./input.c36591f6.js";import{M as ze}from"./event-util.b0b3c4c9.js";const Xe=[[],[],[],[]],ct={results:{losses:0,wins:0},me:{knowledge:Xe,round:0},enemy:{knowledge:Xe,round:0}},ht="decrypto",Ot=()=>{try{const e=lt.get(ht);if(e)return JSON.parse(e)}catch{}return ct},_t=e=>lt.set(ht,JSON.stringify(e)),[re,je]=at(Ot()),ut=e=>{je.set(e),_t(je.get())},Lt=()=>ut(ct),$={set:ut,reset:Lt},zt={first:"",second:"",third:""},Ut=ze.initialData(zt),Fe=e=>{if(!e||!e.trim())return{id:"DECRYPTO.codeWord.required"};try{btoa(e)}catch{return{id:"DECRYPTO.codeWord.invalid"}}},Vt={first:{onChange:Fe},second:{onChange:Fe},third:{onChange:Fe}},Yt=({onSubmit:e,code:t})=>{const[n,r]=N.exports.useState(Ut),{fields:i,Form:o}=ze.useForm();return A("div",{className:"code-words-selection",children:[t&&v("div",{className:"code",children:v("span",{children:t.join(".")})}),A(o,{onChange:r,data:n,onSubmit:e,validation:Vt,children:[v(De,{field:i.first}),v(De,{field:i.second}),v(De,{field:i.third}),A("button",{type:"submit",disabled:ze.notSubmittable(n),children:[v(j.Mask,{}),v("div",{className:"description",children:Y("DECRYPTO.btn.submit")})]})]})]})},qt=({value:e,children:t,onChange:n,close:r})=>{const i=N.exports.useCallback(()=>{n(e),r()},[n,r,e]);return v("div",{className:"value",onClick:i,children:t})},Re=({children:e,options:t,onChange:n})=>{const[r,i]=N.exports.useState(!1),o=N.exports.useCallback(()=>i(!1),[]),s=N.exports.useCallback(()=>i(!0),[]);return A(ne,{children:[v("span",{onClick:s,children:e}),r&&A("div",{className:"select-overlay",children:[v("div",{className:"select-overlay-inner",children:t.map(({value:a,node:l},h)=>v(qt,{close:o,onChange:n,value:a,children:l},h))}),v("div",{className:"select-overlay-outer",onClick:o})]})]})},xe=[{value:1,node:1},{value:2,node:2},{value:3,node:3},{value:4,node:4}],Ht=(e,t,n)=>{if(e&&e===t)return e;if(n&&(n===t||n===e))return n},Qt=(e,t,n)=>{const r=Ht(e,t,n);return r?[r===e,r===t,r===n]:[!1,!1,!1]},ft=({onSubmit:e,codeWords:t})=>{const[n,r]=N.exports.useState(),[i,o]=N.exports.useState(),[s,a]=N.exports.useState(),l=Qt(n,i,s),h=N.exports.useMemo(()=>!!(n&&i&&s&&n!==i&&n!==s&&i!==s),[n,i,s]),f=N.exports.useCallback(()=>{e([n,i,s])},[e,n,i,s]);return A("div",{className:"guessing",children:[A("div",{className:"guess",children:[v("div",{className:"code-word",children:t.first}),v(Re,{options:xe,onChange:r,children:v("span",{className:W.classNames("code-guess",l[0]&&"invalid"),children:n!=null?n:"?"})})]}),A("div",{className:"guess",children:[v("div",{className:"code-word",children:t.second}),v(Re,{options:xe,onChange:o,children:v("span",{className:W.classNames("code-guess",l[1]&&"invalid"),children:i!=null?i:"?"})})]}),A("div",{className:"guess",children:[v("div",{className:"code-word",children:t.third}),v(Re,{options:xe,onChange:a,children:v("span",{className:W.classNames("code-guess",l[2]&&"invalid"),children:s!=null?s:"?"})})]}),h&&A("button",{onClick:f,type:"button",children:[v(j.Key,{}),v("div",{className:"description",children:Y("DECRYPTO.btn.decode")})]})]})},dt=({codeWords:e,code:t,guessed:n})=>{const r=n[0]!==t[0],i=n[1]!==t[1],o=n[2]!==t[2];return A("div",{className:"guessed",children:[A("div",{className:"guess",children:[v("div",{className:"code-word",children:e.first}),v("span",{className:W.classNames("code-guess",r?"invalid":"valid"),children:n[0]}),r&&v("span",{className:"code-was",children:t[0]})]}),A("div",{className:"guess",children:[v("div",{className:"code-word",children:e.second}),v("span",{className:W.classNames("code-guess",i?"invalid":"valid"),children:n[1]}),i&&v("span",{className:"code-was",children:t[1]})]}),A("div",{className:"guess",children:[v("div",{className:"code-word",children:e.third}),v("span",{className:W.classNames("code-guess",o?"invalid":"valid"),children:n[2]}),o&&v("span",{className:"code-was",children:t[2]})]})]})},wt=({knowledge:e})=>{const t=N.exports.useMemo(()=>{const n=[],r=e.reduce((i,o)=>Math.max(i,o.length),0);for(let i=0;i<r;i++)n.push(v("tr",{children:e.map((o,s)=>v("td",{children:o[i]},s))},i));return n},[e]);return v("div",{className:"knowledge",children:A("table",{children:[v("thead",{children:A("tr",{children:[v("td",{children:"1"}),v("td",{children:"2"}),v("td",{children:"3"}),v("td",{children:"4"})]})}),v("tbody",{children:t})]})})};var we={},Kt=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},gt={},R={};let Ge;const Gt=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];R.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};R.getSymbolTotalCodewords=function(t){return Gt[t]};R.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};R.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');Ge=t};R.isKanjiModeEnabled=function(){return typeof Ge<"u"};R.toSJIS=function(t){return Ge(t)};var Be={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+n)}}e.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},e.from=function(r,i){if(e.isValid(r))return r;try{return t(r)}catch{return i}}})(Be);function vt(){this.buffer=[],this.length=0}vt.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let n=0;n<t;n++)this.putBit((e>>>t-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var Wt=vt;function ge(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}ge.prototype.set=function(e,t,n,r){const i=e*this.size+t;this.data[i]=n,r&&(this.reservedBit[i]=!0)};ge.prototype.get=function(e,t){return this.data[e*this.size+t]};ge.prototype.xor=function(e,t,n){this.data[e*this.size+t]^=n};ge.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var $t=ge,pt={};(function(e){const t=R.getSymbolSize;e.getRowColCoords=function(r){if(r===1)return[];const i=Math.floor(r/7)+2,o=t(r),s=o===145?26:Math.ceil((o-13)/(2*i-2))*2,a=[o-7];for(let l=1;l<i-1;l++)a[l]=a[l-1]-s;return a.push(6),a.reverse()},e.getPositions=function(r){const i=[],o=e.getRowColCoords(r),s=o.length;for(let a=0;a<s;a++)for(let l=0;l<s;l++)a===0&&l===0||a===0&&l===s-1||a===s-1&&l===0||i.push([o[a],o[l]]);return i}})(pt);var mt={};const Jt=R.getSymbolSize,et=7;mt.getPositions=function(t){const n=Jt(t);return[[0,0],[n-et,0],[0,n-et]]};var yt={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},e.from=function(i){return e.isValid(i)?parseInt(i,10):void 0},e.getPenaltyN1=function(i){const o=i.size;let s=0,a=0,l=0,h=null,f=null;for(let g=0;g<o;g++){a=l=0,h=f=null;for(let d=0;d<o;d++){let w=i.get(g,d);w===h?a++:(a>=5&&(s+=t.N1+(a-5)),h=w,a=1),w=i.get(d,g),w===f?l++:(l>=5&&(s+=t.N1+(l-5)),f=w,l=1)}a>=5&&(s+=t.N1+(a-5)),l>=5&&(s+=t.N1+(l-5))}return s},e.getPenaltyN2=function(i){const o=i.size;let s=0;for(let a=0;a<o-1;a++)for(let l=0;l<o-1;l++){const h=i.get(a,l)+i.get(a,l+1)+i.get(a+1,l)+i.get(a+1,l+1);(h===4||h===0)&&s++}return s*t.N2},e.getPenaltyN3=function(i){const o=i.size;let s=0,a=0,l=0;for(let h=0;h<o;h++){a=l=0;for(let f=0;f<o;f++)a=a<<1&2047|i.get(h,f),f>=10&&(a===1488||a===93)&&s++,l=l<<1&2047|i.get(f,h),f>=10&&(l===1488||l===93)&&s++}return s*t.N3},e.getPenaltyN4=function(i){let o=0;const s=i.data.length;for(let l=0;l<s;l++)o+=i.data[l];return Math.abs(Math.ceil(o*100/s/5)-10)*t.N4};function n(r,i,o){switch(r){case e.Patterns.PATTERN000:return(i+o)%2===0;case e.Patterns.PATTERN001:return i%2===0;case e.Patterns.PATTERN010:return o%3===0;case e.Patterns.PATTERN011:return(i+o)%3===0;case e.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(o/3))%2===0;case e.Patterns.PATTERN101:return i*o%2+i*o%3===0;case e.Patterns.PATTERN110:return(i*o%2+i*o%3)%2===0;case e.Patterns.PATTERN111:return(i*o%3+(i+o)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}e.applyMask=function(i,o){const s=o.size;for(let a=0;a<s;a++)for(let l=0;l<s;l++)o.isReserved(l,a)||o.xor(l,a,n(i,l,a))},e.getBestMask=function(i,o){const s=Object.keys(e.Patterns).length;let a=0,l=1/0;for(let h=0;h<s;h++){o(h),e.applyMask(h,i);const f=e.getPenaltyN1(i)+e.getPenaltyN2(i)+e.getPenaltyN3(i)+e.getPenaltyN4(i);e.applyMask(h,i),f<l&&(l=f,a=h)}return a}})(yt);var Pe={};const G=Be,ye=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],be=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Pe.getBlocksCount=function(t,n){switch(n){case G.L:return ye[(t-1)*4+0];case G.M:return ye[(t-1)*4+1];case G.Q:return ye[(t-1)*4+2];case G.H:return ye[(t-1)*4+3];default:return}};Pe.getTotalCodewordsCount=function(t,n){switch(n){case G.L:return be[(t-1)*4+0];case G.M:return be[(t-1)*4+1];case G.Q:return be[(t-1)*4+2];case G.H:return be[(t-1)*4+3];default:return}};var bt={},Ae={};const fe=new Uint8Array(512),Ce=new Uint8Array(256);(function(){let t=1;for(let n=0;n<255;n++)fe[n]=t,Ce[t]=n,t<<=1,t&256&&(t^=285);for(let n=255;n<512;n++)fe[n]=fe[n-255]})();Ae.log=function(t){if(t<1)throw new Error("log("+t+")");return Ce[t]};Ae.exp=function(t){return fe[t]};Ae.mul=function(t,n){return t===0||n===0?0:fe[Ce[t]+Ce[n]]};(function(e){const t=Ae;e.mul=function(r,i){const o=new Uint8Array(r.length+i.length-1);for(let s=0;s<r.length;s++)for(let a=0;a<i.length;a++)o[s+a]^=t.mul(r[s],i[a]);return o},e.mod=function(r,i){let o=new Uint8Array(r);for(;o.length-i.length>=0;){const s=o[0];for(let l=0;l<i.length;l++)o[l]^=t.mul(i[l],s);let a=0;for(;a<o.length&&o[a]===0;)a++;o=o.slice(a)}return o},e.generateECPolynomial=function(r){let i=new Uint8Array([1]);for(let o=0;o<r;o++)i=e.mul(i,new Uint8Array([1,t.exp(o)]));return i}})(bt);const Ct=bt;function We(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}We.prototype.initialize=function(t){this.degree=t,this.genPoly=Ct.generateECPolynomial(this.degree)};We.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const n=new Uint8Array(t.length+this.degree);n.set(t);const r=Ct.mod(n,this.genPoly),i=this.degree-r.length;if(i>0){const o=new Uint8Array(this.degree);return o.set(r,i),o}return r};var Zt=We,Et={},J={},$e={};$e.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var z={};const Mt="[0-9]+",Xt="[A-Z $%*+\\-./:]+";let de="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";de=de.replace(/u/g,"\\u");const jt="(?:(?![A-Z0-9 $%*+\\-./:]|"+de+`)(?:.|[\r
]))+`;z.KANJI=new RegExp(de,"g");z.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");z.BYTE=new RegExp(jt,"g");z.NUMERIC=new RegExp(Mt,"g");z.ALPHANUMERIC=new RegExp(Xt,"g");const en=new RegExp("^"+de+"$"),tn=new RegExp("^"+Mt+"$"),nn=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");z.testKanji=function(t){return en.test(t)};z.testNumeric=function(t){return tn.test(t)};z.testAlphanumeric=function(t){return nn.test(t)};(function(e){const t=$e,n=z;e.NUMERIC={id:"Numeric",bit:1<<0,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:1<<1,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:1<<2,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:1<<3,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(o,s){if(!o.ccBits)throw new Error("Invalid mode: "+o);if(!t.isValid(s))throw new Error("Invalid version: "+s);return s>=1&&s<10?o.ccBits[0]:s<27?o.ccBits[1]:o.ccBits[2]},e.getBestModeForData=function(o){return n.testNumeric(o)?e.NUMERIC:n.testAlphanumeric(o)?e.ALPHANUMERIC:n.testKanji(o)?e.KANJI:e.BYTE},e.toString=function(o){if(o&&o.id)return o.id;throw new Error("Invalid mode")},e.isValid=function(o){return o&&o.bit&&o.ccBits};function r(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+i)}}e.from=function(o,s){if(e.isValid(o))return o;try{return r(o)}catch{return s}}})(J);(function(e){const t=R,n=Pe,r=Be,i=J,o=$e,s=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,a=t.getBCHDigit(s);function l(d,w,p){for(let C=1;C<=40;C++)if(w<=e.getCapacity(C,p,d))return C}function h(d,w){return i.getCharCountIndicator(d,w)+4}function f(d,w){let p=0;return d.forEach(function(C){p+=h(C.mode,w)+C.getBitsLength()}),p}function g(d,w){for(let p=1;p<=40;p++)if(f(d,p)<=e.getCapacity(p,w,i.MIXED))return p}e.from=function(w,p){return o.isValid(w)?parseInt(w,10):p},e.getCapacity=function(w,p,C){if(!o.isValid(w))throw new Error("Invalid QR Code version");typeof C>"u"&&(C=i.BYTE);const B=t.getSymbolTotalCodewords(w),y=n.getTotalCodewordsCount(w,p),M=(B-y)*8;if(C===i.MIXED)return M;const m=M-h(C,w);switch(C){case i.NUMERIC:return Math.floor(m/10*3);case i.ALPHANUMERIC:return Math.floor(m/11*2);case i.KANJI:return Math.floor(m/13);case i.BYTE:default:return Math.floor(m/8)}},e.getBestVersionForData=function(w,p){let C;const B=r.from(p,r.M);if(Array.isArray(w)){if(w.length>1)return g(w,B);if(w.length===0)return 1;C=w[0]}else C=w;return l(C.mode,C.getLength(),B)},e.getEncodedBits=function(w){if(!o.isValid(w)||w<7)throw new Error("Invalid QR Code version");let p=w<<12;for(;t.getBCHDigit(p)-a>=0;)p^=s<<t.getBCHDigit(p)-a;return w<<12|p}})(Et);var Nt={};const Ue=R,Bt=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,rn=1<<14|1<<12|1<<10|1<<4|1<<1,tt=Ue.getBCHDigit(Bt);Nt.getEncodedBits=function(t,n){const r=t.bit<<3|n;let i=r<<10;for(;Ue.getBCHDigit(i)-tt>=0;)i^=Bt<<Ue.getBCHDigit(i)-tt;return(r<<10|i)^rn};var Pt={};const on=J;function ie(e){this.mode=on.NUMERIC,this.data=e.toString()}ie.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};ie.prototype.getLength=function(){return this.data.length};ie.prototype.getBitsLength=function(){return ie.getBitsLength(this.data.length)};ie.prototype.write=function(t){let n,r,i;for(n=0;n+3<=this.data.length;n+=3)r=this.data.substr(n,3),i=parseInt(r,10),t.put(i,10);const o=this.data.length-n;o>0&&(r=this.data.substr(n),i=parseInt(r,10),t.put(i,o*3+1))};var sn=ie;const an=J,Te=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function oe(e){this.mode=an.ALPHANUMERIC,this.data=e}oe.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};oe.prototype.getLength=function(){return this.data.length};oe.prototype.getBitsLength=function(){return oe.getBitsLength(this.data.length)};oe.prototype.write=function(t){let n;for(n=0;n+2<=this.data.length;n+=2){let r=Te.indexOf(this.data[n])*45;r+=Te.indexOf(this.data[n+1]),t.put(r,11)}this.data.length%2&&t.put(Te.indexOf(this.data[n]),6)};var ln=oe,cn=function(t){for(var n=[],r=t.length,i=0;i<r;i++){var o=t.charCodeAt(i);if(o>=55296&&o<=56319&&r>i+1){var s=t.charCodeAt(i+1);s>=56320&&s<=57343&&(o=(o-55296)*1024+s-56320+65536,i+=1)}if(o<128){n.push(o);continue}if(o<2048){n.push(o>>6|192),n.push(o&63|128);continue}if(o<55296||o>=57344&&o<65536){n.push(o>>12|224),n.push(o>>6&63|128),n.push(o&63|128);continue}if(o>=65536&&o<=1114111){n.push(o>>18|240),n.push(o>>12&63|128),n.push(o>>6&63|128),n.push(o&63|128);continue}n.push(239,191,189)}return new Uint8Array(n).buffer};const hn=cn,un=J;function se(e){this.mode=un.BYTE,typeof e=="string"&&(e=hn(e)),this.data=new Uint8Array(e)}se.getBitsLength=function(t){return t*8};se.prototype.getLength=function(){return this.data.length};se.prototype.getBitsLength=function(){return se.getBitsLength(this.data.length)};se.prototype.write=function(e){for(let t=0,n=this.data.length;t<n;t++)e.put(this.data[t],8)};var fn=se;const dn=J,wn=R;function ae(e){this.mode=dn.KANJI,this.data=e}ae.getBitsLength=function(t){return t*13};ae.prototype.getLength=function(){return this.data.length};ae.prototype.getBitsLength=function(){return ae.getBitsLength(this.data.length)};ae.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let n=wn.toSJIS(this.data[t]);if(n>=33088&&n<=40956)n-=33088;else if(n>=57408&&n<=60351)n-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);n=(n>>>8&255)*192+(n&255),e.put(n,13)}};var gn=ae,At={exports:{}};(function(e){var t={single_source_shortest_paths:function(n,r,i){var o={},s={};s[r]=0;var a=t.PriorityQueue.make();a.push(r,0);for(var l,h,f,g,d,w,p,C,B;!a.empty();){l=a.pop(),h=l.value,g=l.cost,d=n[h]||{};for(f in d)d.hasOwnProperty(f)&&(w=d[f],p=g+w,C=s[f],B=typeof s[f]>"u",(B||C>p)&&(s[f]=p,a.push(f,p),o[f]=h))}if(typeof i<"u"&&typeof s[i]>"u"){var y=["Could not find a path from ",r," to ",i,"."].join("");throw new Error(y)}return o},extract_shortest_path_from_predecessor_list:function(n,r){for(var i=[],o=r;o;)i.push(o),n[o],o=n[o];return i.reverse(),i},find_path:function(n,r,i){var o=t.single_source_shortest_paths(n,r,i);return t.extract_shortest_path_from_predecessor_list(o,i)},PriorityQueue:{make:function(n){var r=t.PriorityQueue,i={},o;n=n||{};for(o in r)r.hasOwnProperty(o)&&(i[o]=r[o]);return i.queue=[],i.sorter=n.sorter||r.default_sorter,i},default_sorter:function(n,r){return n.cost-r.cost},push:function(n,r){var i={value:n,cost:r};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(At);(function(e){const t=J,n=sn,r=ln,i=fn,o=gn,s=z,a=R,l=At.exports;function h(y){return unescape(encodeURIComponent(y)).length}function f(y,M,m){const E=[];let P;for(;(P=y.exec(m))!==null;)E.push({data:P[0],index:P.index,mode:M,length:P[0].length});return E}function g(y){const M=f(s.NUMERIC,t.NUMERIC,y),m=f(s.ALPHANUMERIC,t.ALPHANUMERIC,y);let E,P;return a.isKanjiModeEnabled()?(E=f(s.BYTE,t.BYTE,y),P=f(s.KANJI,t.KANJI,y)):(E=f(s.BYTE_KANJI,t.BYTE,y),P=[]),M.concat(m,E,P).sort(function(S,O){return S.index-O.index}).map(function(S){return{data:S.data,mode:S.mode,length:S.length}})}function d(y,M){switch(M){case t.NUMERIC:return n.getBitsLength(y);case t.ALPHANUMERIC:return r.getBitsLength(y);case t.KANJI:return o.getBitsLength(y);case t.BYTE:return i.getBitsLength(y)}}function w(y){return y.reduce(function(M,m){const E=M.length-1>=0?M[M.length-1]:null;return E&&E.mode===m.mode?(M[M.length-1].data+=m.data,M):(M.push(m),M)},[])}function p(y){const M=[];for(let m=0;m<y.length;m++){const E=y[m];switch(E.mode){case t.NUMERIC:M.push([E,{data:E.data,mode:t.ALPHANUMERIC,length:E.length},{data:E.data,mode:t.BYTE,length:E.length}]);break;case t.ALPHANUMERIC:M.push([E,{data:E.data,mode:t.BYTE,length:E.length}]);break;case t.KANJI:M.push([E,{data:E.data,mode:t.BYTE,length:h(E.data)}]);break;case t.BYTE:M.push([{data:E.data,mode:t.BYTE,length:h(E.data)}])}}return M}function C(y,M){const m={},E={start:{}};let P=["start"];for(let k=0;k<y.length;k++){const S=y[k],O=[];for(let Q=0;Q<S.length;Q++){const L=S[Q],ue=""+k+Q;O.push(ue),m[ue]={node:L,lastCount:0},E[ue]={};for(let Se=0;Se<P.length;Se++){const U=P[Se];m[U]&&m[U].node.mode===L.mode?(E[U][ue]=d(m[U].lastCount+L.length,L.mode)-d(m[U].lastCount,L.mode),m[U].lastCount+=L.length):(m[U]&&(m[U].lastCount=L.length),E[U][ue]=d(L.length,L.mode)+4+t.getCharCountIndicator(L.mode,M))}}P=O}for(let k=0;k<P.length;k++)E[P[k]].end=0;return{map:E,table:m}}function B(y,M){let m;const E=t.getBestModeForData(y);if(m=t.from(M,E),m!==t.BYTE&&m.bit<E.bit)throw new Error('"'+y+'" cannot be encoded with mode '+t.toString(m)+`.
 Suggested mode is: `+t.toString(E));switch(m===t.KANJI&&!a.isKanjiModeEnabled()&&(m=t.BYTE),m){case t.NUMERIC:return new n(y);case t.ALPHANUMERIC:return new r(y);case t.KANJI:return new o(y);case t.BYTE:return new i(y)}}e.fromArray=function(M){return M.reduce(function(m,E){return typeof E=="string"?m.push(B(E,null)):E.data&&m.push(B(E.data,E.mode)),m},[])},e.fromString=function(M,m){const E=g(M,a.isKanjiModeEnabled()),P=p(E),k=C(P,m),S=l.find_path(k.map,"start","end"),O=[];for(let Q=1;Q<S.length-1;Q++)O.push(k.table[S[Q]].node);return e.fromArray(w(O))},e.rawSplit=function(M){return e.fromArray(g(M,a.isKanjiModeEnabled()))}})(Pt);const ke=R,Ie=Be,vn=Wt,pn=$t,mn=pt,yn=mt,Ve=yt,Ye=Pe,bn=Zt,Ee=Et,Cn=Nt,En=J,Oe=Pt;function Mn(e,t){const n=e.size,r=yn.getPositions(t);for(let i=0;i<r.length;i++){const o=r[i][0],s=r[i][1];for(let a=-1;a<=7;a++)if(!(o+a<=-1||n<=o+a))for(let l=-1;l<=7;l++)s+l<=-1||n<=s+l||(a>=0&&a<=6&&(l===0||l===6)||l>=0&&l<=6&&(a===0||a===6)||a>=2&&a<=4&&l>=2&&l<=4?e.set(o+a,s+l,!0,!0):e.set(o+a,s+l,!1,!0))}}function Nn(e){const t=e.size;for(let n=8;n<t-8;n++){const r=n%2===0;e.set(n,6,r,!0),e.set(6,n,r,!0)}}function Bn(e,t){const n=mn.getPositions(t);for(let r=0;r<n.length;r++){const i=n[r][0],o=n[r][1];for(let s=-2;s<=2;s++)for(let a=-2;a<=2;a++)s===-2||s===2||a===-2||a===2||s===0&&a===0?e.set(i+s,o+a,!0,!0):e.set(i+s,o+a,!1,!0)}}function Pn(e,t){const n=e.size,r=Ee.getEncodedBits(t);let i,o,s;for(let a=0;a<18;a++)i=Math.floor(a/3),o=a%3+n-8-3,s=(r>>a&1)===1,e.set(i,o,s,!0),e.set(o,i,s,!0)}function _e(e,t,n){const r=e.size,i=Cn.getEncodedBits(t,n);let o,s;for(o=0;o<15;o++)s=(i>>o&1)===1,o<6?e.set(o,8,s,!0):o<8?e.set(o+1,8,s,!0):e.set(r-15+o,8,s,!0),o<8?e.set(8,r-o-1,s,!0):o<9?e.set(8,15-o-1+1,s,!0):e.set(8,15-o-1,s,!0);e.set(r-8,8,1,!0)}function An(e,t){const n=e.size;let r=-1,i=n-1,o=7,s=0;for(let a=n-1;a>0;a-=2)for(a===6&&a--;;){for(let l=0;l<2;l++)if(!e.isReserved(i,a-l)){let h=!1;s<t.length&&(h=(t[s]>>>o&1)===1),e.set(i,a-l,h),o--,o===-1&&(s++,o=7)}if(i+=r,i<0||n<=i){i-=r,r=-r;break}}}function kn(e,t,n){const r=new vn;n.forEach(function(l){r.put(l.mode.bit,4),r.put(l.getLength(),En.getCharCountIndicator(l.mode,e)),l.write(r)});const i=ke.getSymbolTotalCodewords(e),o=Ye.getTotalCodewordsCount(e,t),s=(i-o)*8;for(r.getLengthInBits()+4<=s&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);const a=(s-r.getLengthInBits())/8;for(let l=0;l<a;l++)r.put(l%2?17:236,8);return Sn(r,e,t)}function Sn(e,t,n){const r=ke.getSymbolTotalCodewords(t),i=Ye.getTotalCodewordsCount(t,n),o=r-i,s=Ye.getBlocksCount(t,n),a=r%s,l=s-a,h=Math.floor(r/s),f=Math.floor(o/s),g=f+1,d=h-f,w=new bn(d);let p=0;const C=new Array(s),B=new Array(s);let y=0;const M=new Uint8Array(e.buffer);for(let S=0;S<s;S++){const O=S<l?f:g;C[S]=M.slice(p,p+O),B[S]=w.encode(C[S]),p+=O,y=Math.max(y,O)}const m=new Uint8Array(r);let E=0,P,k;for(P=0;P<y;P++)for(k=0;k<s;k++)P<C[k].length&&(m[E++]=C[k][P]);for(P=0;P<d;P++)for(k=0;k<s;k++)m[E++]=B[k][P];return m}function Dn(e,t,n,r){let i;if(Array.isArray(e))i=Oe.fromArray(e);else if(typeof e=="string"){let h=t;if(!h){const f=Oe.rawSplit(e);h=Ee.getBestVersionForData(f,n)}i=Oe.fromString(e,h||40)}else throw new Error("Invalid data");const o=Ee.getBestVersionForData(i,n);if(!o)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=o;else if(t<o)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+o+`.
`);const s=kn(t,n,i),a=ke.getSymbolSize(t),l=new pn(a);return Mn(l,t),Nn(l),Bn(l,t),_e(l,n,0),t>=7&&Pn(l,t),An(l,s),isNaN(r)&&(r=Ve.getBestMask(l,_e.bind(null,l,n))),Ve.applyMask(r,l),_e(l,n,r),{modules:l,version:t,errorCorrectionLevel:n,maskPattern:r,segments:i}}gt.create=function(t,n){if(typeof t>"u"||t==="")throw new Error("No input text");let r=Ie.M,i,o;return typeof n<"u"&&(r=Ie.from(n.errorCorrectionLevel,Ie.M),i=Ee.from(n.version),o=Ve.from(n.maskPattern),n.toSJISFunc&&ke.setToSJISFunction(n.toSJISFunc)),Dn(t,i,r,o)};var kt={},Je={};(function(e){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let r=n.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+n);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(o){return[o,o]}))),r.length===6&&r.push("F","F");const i=parseInt(r.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+r.slice(0,6).join("")}}e.getOptions=function(r){r||(r={}),r.color||(r.color={});const i=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,o=r.width&&r.width>=21?r.width:void 0,s=r.scale||4;return{width:o,scale:o?4:s,margin:i,color:{dark:t(r.color.dark||"#000000ff"),light:t(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},e.getScale=function(r,i){return i.width&&i.width>=r+i.margin*2?i.width/(r+i.margin*2):i.scale},e.getImageWidth=function(r,i){const o=e.getScale(r,i);return Math.floor((r+i.margin*2)*o)},e.qrToImageData=function(r,i,o){const s=i.modules.size,a=i.modules.data,l=e.getScale(s,o),h=Math.floor((s+o.margin*2)*l),f=o.margin*l,g=[o.color.light,o.color.dark];for(let d=0;d<h;d++)for(let w=0;w<h;w++){let p=(d*h+w)*4,C=o.color.light;if(d>=f&&w>=f&&d<h-f&&w<h-f){const B=Math.floor((d-f)/l),y=Math.floor((w-f)/l);C=g[a[B*s+y]?1:0]}r[p++]=C.r,r[p++]=C.g,r[p++]=C.b,r[p]=C.a}}})(Je);(function(e){const t=Je;function n(i,o,s){i.clearRect(0,0,o.width,o.height),o.style||(o.style={}),o.height=s,o.width=s,o.style.height=s+"px",o.style.width=s+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(o,s,a){let l=a,h=s;typeof l>"u"&&(!s||!s.getContext)&&(l=s,s=void 0),s||(h=r()),l=t.getOptions(l);const f=t.getImageWidth(o.modules.size,l),g=h.getContext("2d"),d=g.createImageData(f,f);return t.qrToImageData(d.data,o,l),n(g,h,f),g.putImageData(d,0,0),h},e.renderToDataURL=function(o,s,a){let l=a;typeof l>"u"&&(!s||!s.getContext)&&(l=s,s=void 0),l||(l={});const h=e.render(o,s,l),f=l.type||"image/png",g=l.rendererOpts||{};return h.toDataURL(f,g.quality)}})(kt);var St={};const Fn=Je;function nt(e,t){const n=e.a/255,r=t+'="'+e.hex+'"';return n<1?r+" "+t+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function Le(e,t,n){let r=e+t;return typeof n<"u"&&(r+=" "+n),r}function Rn(e,t,n){let r="",i=0,o=!1,s=0;for(let a=0;a<e.length;a++){const l=Math.floor(a%t),h=Math.floor(a/t);!l&&!o&&(o=!0),e[a]?(s++,a>0&&l>0&&e[a-1]||(r+=o?Le("M",l+n,.5+h+n):Le("m",i,0),i=0,o=!1),l+1<t&&e[a+1]||(r+=Le("h",s),s=0)):i++}return r}St.render=function(t,n,r){const i=Fn.getOptions(n),o=t.modules.size,s=t.modules.data,a=o+i.margin*2,l=i.color.light.a?"<path "+nt(i.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",h="<path "+nt(i.color.dark,"stroke")+' d="'+Rn(s,o,i.margin)+'"/>',f='viewBox="0 0 '+a+" "+a+'"',g=i.width?'width="'+i.width+'" height="'+i.width+'" ':"",d='<svg xmlns="http://www.w3.org/2000/svg" '+g+f+' shape-rendering="crispEdges">'+l+h+`</svg>
`;return typeof r=="function"&&r(null,d),d};const xn=Kt,qe=gt,Dt=kt,Tn=St;function Ze(e,t,n,r,i){const o=[].slice.call(arguments,1),s=o.length,a=typeof o[s-1]=="function";if(!a&&!xn())throw new Error("Callback required as last argument");if(a){if(s<2)throw new Error("Too few arguments provided");s===2?(i=n,n=t,t=r=void 0):s===3&&(t.getContext&&typeof i>"u"?(i=r,r=void 0):(i=r,r=n,n=t,t=void 0))}else{if(s<1)throw new Error("Too few arguments provided");return s===1?(n=t,t=r=void 0):s===2&&!t.getContext&&(r=n,n=t,t=void 0),new Promise(function(l,h){try{const f=qe.create(n,r);l(e(f,t,r))}catch(f){h(f)}})}try{const l=qe.create(n,r);i(null,e(l,t,r))}catch(l){i(l)}}we.create=qe.create;we.toCanvas=Ze.bind(null,Dt.render);we.toDataURL=Ze.bind(null,Dt.renderToDataURL);we.toString=Ze.bind(null,function(e,t,n){return Tn.render(e,n)});const rt="#0000",In={white:{dark:"#FFF",light:rt},black:{dark:"#000",light:rt}},On=({info:e,options:t})=>{const[n,r]=N.exports.useState(),i=N.exports.useRef(null);return N.exports.useEffect(()=>{we.toCanvas(i.current,e,t,o=>{o&&r(o)})},[e,t]),n?v(ne,{children:"Ups, something went wrong (Code: QR1)"}):v("canvas",{ref:i})};function X(e,t,n){this.ordinal_Renamed_Field=e,this.bits=t,this.name=n}X.prototype.ordinal=function(){return this.ordinal_Renamed_Field};X.forBits=function(e){if(e<0||e>=it.length)throw"ArgumentException";return it[e]};var it=[new X(1,0,"M"),new X(0,1,"L"),new X(3,2,"H"),new X(2,3,"Q")],_n=21522,ot=[[21522,0],[20773,1],[24188,2],[23371,3],[17913,4],[16590,5],[20375,6],[19104,7],[30660,8],[29427,9],[32170,10],[30877,11],[26159,12],[25368,13],[27713,14],[26998,15],[5769,16],[5054,17],[7399,18],[6608,19],[1890,20],[597,21],[3340,22],[2107,23],[13663,24],[12392,25],[16177,26],[14854,27],[9396,28],[8579,29],[11994,30],[11245,31]],K=[0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4];function x(e){this.errorCorrectionLevel=X.forBits(e>>3&3),this.dataMask=e&7}x.prototype.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|this.dataMask};x.prototype.Equals=function(e){var t=e;return this.errorCorrectionLevel==t.errorCorrectionLevel&&this.dataMask==t.dataMask};x.numBitsDiffering=function(e,t){return e^=t,K[e&15]+K[V(e,4)&15]+K[V(e,8)&15]+K[V(e,12)&15]+K[V(e,16)&15]+K[V(e,20)&15]+K[V(e,24)&15]+K[V(e,28)&15]};x.decodeFormatInformation=function(e){var t=x.doDecodeFormatInformation(e);return t!=null?t:x.doDecodeFormatInformation(e^_n)};x.doDecodeFormatInformation=function(e){for(var t=4294967295,n=0,r=0;r<ot.length;r++){var i=ot[r],o=i[0];if(o==e)return new x(i[1]);var s=this.numBitsDiffering(e,o);s<t&&(n=i[1],t=s)}return t<=3?new x(n):null};function Z(e,t){if(t||(t=e),e<1||t<1)throw"Both dimensions must be greater than 0";this.width=e,this.height=t;var n=e>>5;(e&31)!=0&&n++,this.rowSize=n,this.bits=new Array(n*t);for(var r=0;r<this.bits.length;r++)this.bits[r]=0}Object.defineProperty(Z.prototype,"Dimension",{get:function(){if(this.width!=this.height)throw"Can't call getDimension() on a non-square matrix";return this.width}});Z.prototype.get_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);return(V(this.bits[n],e&31)&1)!=0};Z.prototype.set_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]|=1<<(e&31)};Z.prototype.flip=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]^=1<<(e&31)};Z.prototype.clear=function(){for(var e=this.bits.length,t=0;t<e;t++)this.bits[t]=0};Z.prototype.setRegion=function(e,t,n,r){if(t<0||e<0)throw"Left and top must be nonnegative";if(r<1||n<1)throw"Height and width must be at least 1";var i=e+n,o=t+r;if(o>this.height||i>this.width)throw"The region must fit inside the matrix";for(var s=t;s<o;s++)for(var a=s*this.rowSize,l=e;l<i;l++)this.bits[a+(l>>5)]|=1<<(l&31)};function c(e,t){this.count=e,this.dataCodewords=t}function u(e,t,n){this.ecCodewordsPerBlock=e,n?this.ecBlocks=[t,n]:this.ecBlocks=[t]}Object.defineProperty(u.prototype,"TotalECCodewords",{get:function(){return this.ecCodewordsPerBlock*this.NumBlocks}});Object.defineProperty(u.prototype,"NumBlocks",{get:function(){for(var e=0,t=0;t<this.ecBlocks.length;t++)e+=this.ecBlocks[t].length;return e}});u.prototype.getECBlocks=function(){return this.ecBlocks};function b(e,t,n,r,i,o){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=[n,r,i,o];for(var s=0,a=n.ecCodewordsPerBlock,l=n.getECBlocks(),h=0;h<l.length;h++){var f=l[h];s+=f.count*(f.dataCodewords+a)}this.totalCodewords=s}Object.defineProperty(b.prototype,"DimensionForVersion",{get:function(){return 17+4*this.versionNumber}});b.prototype.buildFunctionPattern=function(){var e=this.DimensionForVersion,t=new Z(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,r=0;r<n;r++)for(var i=this.alignmentPatternCenters[r]-2,o=0;o<n;o++)r==0&&(o==0||o==n-1)||r==n-1&&o==0||t.setRegion(this.alignmentPatternCenters[o]-2,i,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t};b.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.ordinal()]};b.VERSION_DECODE_INFO=[31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017];b.VERSIONS=Ln();b.getVersionForNumber=function(e){if(e<1||e>40)throw"ArgumentException";return b.VERSIONS[e-1]};b.getProvisionalVersionForDimension=function(e){if(e%4!=1)throw"Error getProvisionalVersionForDimension";try{return b.getVersionForNumber(e-17>>2)}catch{throw"Error getVersionForNumber"}};b.decodeVersionInformation=function(e){for(var t=4294967295,n=0,r=0;r<b.VERSION_DECODE_INFO.length;r++){var i=b.VERSION_DECODE_INFO[r];if(i==e)return this.getVersionForNumber(r+7);var o=x.numBitsDiffering(e,i);o<t&&(n=r+7,t=o)}return t<=3?this.getVersionForNumber(n):null};function Ln(){return[new b(1,[],new u(7,new c(1,19)),new u(10,new c(1,16)),new u(13,new c(1,13)),new u(17,new c(1,9))),new b(2,[6,18],new u(10,new c(1,34)),new u(16,new c(1,28)),new u(22,new c(1,22)),new u(28,new c(1,16))),new b(3,[6,22],new u(15,new c(1,55)),new u(26,new c(1,44)),new u(18,new c(2,17)),new u(22,new c(2,13))),new b(4,[6,26],new u(20,new c(1,80)),new u(18,new c(2,32)),new u(26,new c(2,24)),new u(16,new c(4,9))),new b(5,[6,30],new u(26,new c(1,108)),new u(24,new c(2,43)),new u(18,new c(2,15),new c(2,16)),new u(22,new c(2,11),new c(2,12))),new b(6,[6,34],new u(18,new c(2,68)),new u(16,new c(4,27)),new u(24,new c(4,19)),new u(28,new c(4,15))),new b(7,[6,22,38],new u(20,new c(2,78)),new u(18,new c(4,31)),new u(18,new c(2,14),new c(4,15)),new u(26,new c(4,13),new c(1,14))),new b(8,[6,24,42],new u(24,new c(2,97)),new u(22,new c(2,38),new c(2,39)),new u(22,new c(4,18),new c(2,19)),new u(26,new c(4,14),new c(2,15))),new b(9,[6,26,46],new u(30,new c(2,116)),new u(22,new c(3,36),new c(2,37)),new u(20,new c(4,16),new c(4,17)),new u(24,new c(4,12),new c(4,13))),new b(10,[6,28,50],new u(18,new c(2,68),new c(2,69)),new u(26,new c(4,43),new c(1,44)),new u(24,new c(6,19),new c(2,20)),new u(28,new c(6,15),new c(2,16))),new b(11,[6,30,54],new u(20,new c(4,81)),new u(30,new c(1,50),new c(4,51)),new u(28,new c(4,22),new c(4,23)),new u(24,new c(3,12),new c(8,13))),new b(12,[6,32,58],new u(24,new c(2,92),new c(2,93)),new u(22,new c(6,36),new c(2,37)),new u(26,new c(4,20),new c(6,21)),new u(28,new c(7,14),new c(4,15))),new b(13,[6,34,62],new u(26,new c(4,107)),new u(22,new c(8,37),new c(1,38)),new u(24,new c(8,20),new c(4,21)),new u(22,new c(12,11),new c(4,12))),new b(14,[6,26,46,66],new u(30,new c(3,115),new c(1,116)),new u(24,new c(4,40),new c(5,41)),new u(20,new c(11,16),new c(5,17)),new u(24,new c(11,12),new c(5,13))),new b(15,[6,26,48,70],new u(22,new c(5,87),new c(1,88)),new u(24,new c(5,41),new c(5,42)),new u(30,new c(5,24),new c(7,25)),new u(24,new c(11,12),new c(7,13))),new b(16,[6,26,50,74],new u(24,new c(5,98),new c(1,99)),new u(28,new c(7,45),new c(3,46)),new u(24,new c(15,19),new c(2,20)),new u(30,new c(3,15),new c(13,16))),new b(17,[6,30,54,78],new u(28,new c(1,107),new c(5,108)),new u(28,new c(10,46),new c(1,47)),new u(28,new c(1,22),new c(15,23)),new u(28,new c(2,14),new c(17,15))),new b(18,[6,30,56,82],new u(30,new c(5,120),new c(1,121)),new u(26,new c(9,43),new c(4,44)),new u(28,new c(17,22),new c(1,23)),new u(28,new c(2,14),new c(19,15))),new b(19,[6,30,58,86],new u(28,new c(3,113),new c(4,114)),new u(26,new c(3,44),new c(11,45)),new u(26,new c(17,21),new c(4,22)),new u(26,new c(9,13),new c(16,14))),new b(20,[6,34,62,90],new u(28,new c(3,107),new c(5,108)),new u(26,new c(3,41),new c(13,42)),new u(30,new c(15,24),new c(5,25)),new u(28,new c(15,15),new c(10,16))),new b(21,[6,28,50,72,94],new u(28,new c(4,116),new c(4,117)),new u(26,new c(17,42)),new u(28,new c(17,22),new c(6,23)),new u(30,new c(19,16),new c(6,17))),new b(22,[6,26,50,74,98],new u(28,new c(2,111),new c(7,112)),new u(28,new c(17,46)),new u(30,new c(7,24),new c(16,25)),new u(24,new c(34,13))),new b(23,[6,30,54,74,102],new u(30,new c(4,121),new c(5,122)),new u(28,new c(4,47),new c(14,48)),new u(30,new c(11,24),new c(14,25)),new u(30,new c(16,15),new c(14,16))),new b(24,[6,28,54,80,106],new u(30,new c(6,117),new c(4,118)),new u(28,new c(6,45),new c(14,46)),new u(30,new c(11,24),new c(16,25)),new u(30,new c(30,16),new c(2,17))),new b(25,[6,32,58,84,110],new u(26,new c(8,106),new c(4,107)),new u(28,new c(8,47),new c(13,48)),new u(30,new c(7,24),new c(22,25)),new u(30,new c(22,15),new c(13,16))),new b(26,[6,30,58,86,114],new u(28,new c(10,114),new c(2,115)),new u(28,new c(19,46),new c(4,47)),new u(28,new c(28,22),new c(6,23)),new u(30,new c(33,16),new c(4,17))),new b(27,[6,34,62,90,118],new u(30,new c(8,122),new c(4,123)),new u(28,new c(22,45),new c(3,46)),new u(30,new c(8,23),new c(26,24)),new u(30,new c(12,15),new c(28,16))),new b(28,[6,26,50,74,98,122],new u(30,new c(3,117),new c(10,118)),new u(28,new c(3,45),new c(23,46)),new u(30,new c(4,24),new c(31,25)),new u(30,new c(11,15),new c(31,16))),new b(29,[6,30,54,78,102,126],new u(30,new c(7,116),new c(7,117)),new u(28,new c(21,45),new c(7,46)),new u(30,new c(1,23),new c(37,24)),new u(30,new c(19,15),new c(26,16))),new b(30,[6,26,52,78,104,130],new u(30,new c(5,115),new c(10,116)),new u(28,new c(19,47),new c(10,48)),new u(30,new c(15,24),new c(25,25)),new u(30,new c(23,15),new c(25,16))),new b(31,[6,30,56,82,108,134],new u(30,new c(13,115),new c(3,116)),new u(28,new c(2,46),new c(29,47)),new u(30,new c(42,24),new c(1,25)),new u(30,new c(23,15),new c(28,16))),new b(32,[6,34,60,86,112,138],new u(30,new c(17,115)),new u(28,new c(10,46),new c(23,47)),new u(30,new c(10,24),new c(35,25)),new u(30,new c(19,15),new c(35,16))),new b(33,[6,30,58,86,114,142],new u(30,new c(17,115),new c(1,116)),new u(28,new c(14,46),new c(21,47)),new u(30,new c(29,24),new c(19,25)),new u(30,new c(11,15),new c(46,16))),new b(34,[6,34,62,90,118,146],new u(30,new c(13,115),new c(6,116)),new u(28,new c(14,46),new c(23,47)),new u(30,new c(44,24),new c(7,25)),new u(30,new c(59,16),new c(1,17))),new b(35,[6,30,54,78,102,126,150],new u(30,new c(12,121),new c(7,122)),new u(28,new c(12,47),new c(26,48)),new u(30,new c(39,24),new c(14,25)),new u(30,new c(22,15),new c(41,16))),new b(36,[6,24,50,76,102,128,154],new u(30,new c(6,121),new c(14,122)),new u(28,new c(6,47),new c(34,48)),new u(30,new c(46,24),new c(10,25)),new u(30,new c(2,15),new c(64,16))),new b(37,[6,28,54,80,106,132,158],new u(30,new c(17,122),new c(4,123)),new u(28,new c(29,46),new c(14,47)),new u(30,new c(49,24),new c(10,25)),new u(30,new c(24,15),new c(46,16))),new b(38,[6,32,58,84,110,136,162],new u(30,new c(4,122),new c(18,123)),new u(28,new c(13,46),new c(32,47)),new u(30,new c(48,24),new c(14,25)),new u(30,new c(42,15),new c(32,16))),new b(39,[6,26,54,82,110,138,166],new u(30,new c(20,117),new c(4,118)),new u(28,new c(40,47),new c(7,48)),new u(30,new c(43,24),new c(22,25)),new u(30,new c(10,15),new c(67,16))),new b(40,[6,30,58,86,114,142,170],new u(30,new c(19,118),new c(6,119)),new u(28,new c(18,47),new c(31,48)),new u(30,new c(34,24),new c(34,25)),new u(30,new c(20,15),new c(61,16)))]}function le(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n}Object.defineProperty(le.prototype,"X",{get:function(){return Math.floor(this.x)}});Object.defineProperty(le.prototype,"Y",{get:function(){return Math.floor(this.y)}});le.prototype.incrementCount=function(){this.count++};le.prototype.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this.estimatedModuleSize);return r<=1||r/this.estimatedModuleSize<=1}return!1};function he(e,t,n,r,i,o,s){this.image=e,this.possibleCenters=[],this.startX=t,this.startY=n,this.width=r,this.height=i,this.moduleSize=o,this.crossCheckStateCount=[0,0,0],this.resultPointCallback=s}he.prototype.centerFromEnd=function(e,t){return t-e[2]-e[1]/2};he.prototype.foundPatternCross=function(e){for(var t=this.moduleSize,n=t/2,r=0;r<3;r++)if(Math.abs(t-e[r])>=n)return!1;return!0};he.prototype.crossCheckVertical=function(e,t,n,r){var i=this.image,o=i.height,s=this.crossCheckStateCount;s[0]=0,s[1]=0,s[2]=0;for(var a=e;a>=0&&i.data[t+a*i.width]&&s[1]<=n;)s[1]++,a--;if(a<0||s[1]>n)return NaN;for(;a>=0&&!i.data[t+a*i.width]&&s[0]<=n;)s[0]++,a--;if(s[0]>n)return NaN;for(a=e+1;a<o&&i.data[t+a*i.width]&&s[1]<=n;)s[1]++,a++;if(a==o||s[1]>n)return NaN;for(;a<o&&!i.data[t+a*i.width]&&s[2]<=n;)s[2]++,a++;if(s[2]>n)return NaN;var l=s[0]+s[1]+s[2];return 5*Math.abs(l-r)>=2*r?NaN:this.foundPatternCross(s)?this.centerFromEnd(s,a):NaN};he.prototype.handlePossibleCenter=function(e,t,n){var r=e[0]+e[1]+e[2],i=this.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(i),2*e[1],r);if(!isNaN(o)){for(var s=(e[0]+e[1]+e[2])/3,a=this.possibleCenters.length,l=0;l<a;l++){var h=this.possibleCenters[l];if(h.aboutEquals(s,o,i))return new le(i,o,s)}var f=new le(i,o,s);this.possibleCenters.push(f),this.resultPointCallback!=null&&this.resultPointCallback.foundPossibleResultPoint(f)}return null};he.prototype.find=function(){for(var e=this.image,t=this.startX,n=this.height,r=t+this.width,i=this.startY+(n>>1),o=[0,0,0],s=0;s<n;s++){var a=i+((s&1)==0?s+1>>1:-(s+1>>1));o[0]=0,o[1]=0,o[2]=0;for(var l=t;l<r&&!e.data[l+e.width*a];)l++;for(var h=0;l<r;){if(e.data[l+a*e.width])if(h==1)o[h]++;else if(h==2){if(this.foundPatternCross(o)){var f=this.handlePossibleCenter(o,a,l);if(f!=null)return f}o[0]=o[2],o[1]=1,o[2]=0,h=1}else o[++h]++;else h==1&&h++,o[h]++;l++}if(this.foundPatternCross(o)){var f=this.handlePossibleCenter(o,a,r);if(f!=null)return f}}if(this.possibleCenters.length!=0)return this.possibleCenters[0];throw"Couldn't find enough alignment patterns"};var Me={};Me.checkAndNudgePoints=function(e,t){for(var n=e.width,r=e.height,i=!0,o=0;o<t.length&&i;o+=2){var s=Math.floor(t[o]),a=Math.floor(t[o+1]);if(s<-1||s>n||a<-1||a>r)throw"Error.checkAndNudgePoints ";i=!1,s==-1?(t[o]=0,i=!0):s==n&&(t[o]=n-1,i=!0),a==-1?(t[o+1]=0,i=!0):a==r&&(t[o+1]=r-1,i=!0)}i=!0;for(var o=t.length-2;o>=0&&i;o-=2){var s=Math.floor(t[o]),a=Math.floor(t[o+1]);if(s<-1||s>n||a<-1||a>r)throw"Error.checkAndNudgePoints ";i=!1,s==-1?(t[o]=0,i=!0):s==n&&(t[o]=n-1,i=!0),a==-1?(t[o+1]=0,i=!0):a==r&&(t[o+1]=r-1,i=!0)}};Me.sampleGrid3=function(e,t,n){for(var r=new Z(t),i=new Array(t<<1),o=0;o<t;o++){for(var s=i.length,a=o+.5,l=0;l<s;l+=2)i[l]=(l>>1)+.5,i[l+1]=a;n.transformPoints1(i),Me.checkAndNudgePoints(e,i);try{for(var l=0;l<s;l+=2){var h=e.data[Math.floor(i[l])+e.width*Math.floor(i[l+1])];h&&r.set_Renamed(l>>1,o)}}catch{throw"Error.checkAndNudgePoints"}}return r};var st=3,zn=57,ee=8,Ft=2;function Un(e){function t(f,g){var d=f.X-g.X,w=f.Y-g.Y;return Math.sqrt(d*d+w*w)}function n(f,g,d){var w=g.x,p=g.y;return(d.x-w)*(f.y-p)-(d.y-p)*(f.x-w)}var r=t(e[0],e[1]),i=t(e[1],e[2]),o=t(e[0],e[2]),s,a,l;if(i>=r&&i>=o?(a=e[0],s=e[1],l=e[2]):o>=i&&o>=r?(a=e[1],s=e[0],l=e[2]):(a=e[2],s=e[0],l=e[1]),n(s,a,l)<0){var h=s;s=l,l=h}e[0]=s,e[1]=a,e[2]=l}function ve(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n}Object.defineProperty(ve.prototype,"X",{get:function(){return this.x}});Object.defineProperty(ve.prototype,"Y",{get:function(){return this.y}});ve.prototype.incrementCount=function(){this.count++};ve.prototype.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this.estimatedModuleSize);return r<=1||r/this.estimatedModuleSize<=1}return!1};function Vn(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}function _(){this.image=null,this.possibleCenters=[],this.hasSkipped=!1,this.crossCheckStateCount=[0,0,0,0,0],this.resultPointCallback=null}Object.defineProperty(_.prototype,"CrossCheckStateCount",{get:function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount}});_.prototype.foundPatternCross=function(e){for(var t=0,n=0;n<5;n++){var r=e[n];if(r==0)return!1;t+=r}if(t<7)return!1;var i=Math.floor((t<<ee)/7),o=Math.floor(i/2);return Math.abs(i-(e[0]<<ee))<o&&Math.abs(i-(e[1]<<ee))<o&&Math.abs(3*i-(e[2]<<ee))<3*o&&Math.abs(i-(e[3]<<ee))<o&&Math.abs(i-(e[4]<<ee))<o};_.prototype.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2};_.prototype.crossCheckVertical=function(e,t,n,r){for(var i=this.image,o=i.height,s=this.CrossCheckStateCount,a=e;a>=0&&i.data[t+a*i.width];)s[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.data[t+a*i.width]&&s[1]<=n;)s[1]++,a--;if(a<0||s[1]>n)return NaN;for(;a>=0&&i.data[t+a*i.width]&&s[0]<=n;)s[0]++,a--;if(s[0]>n)return NaN;for(a=e+1;a<o&&i.data[t+a*i.width];)s[2]++,a++;if(a==o)return NaN;for(;a<o&&!i.data[t+a*i.width]&&s[3]<n;)s[3]++,a++;if(a==o||s[3]>=n)return NaN;for(;a<o&&i.data[t+a*i.width]&&s[4]<n;)s[4]++,a++;if(s[4]>=n)return NaN;var l=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(l-r)>=2*r?NaN:this.foundPatternCross(s)?this.centerFromEnd(s,a):NaN};_.prototype.crossCheckHorizontal=function(e,t,n,r){for(var i=this.image,o=i.width,s=this.CrossCheckStateCount,a=e;a>=0&&i.data[a+t*i.width];)s[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.data[a+t*i.width]&&s[1]<=n;)s[1]++,a--;if(a<0||s[1]>n)return NaN;for(;a>=0&&i.data[a+t*i.width]&&s[0]<=n;)s[0]++,a--;if(s[0]>n)return NaN;for(a=e+1;a<o&&i.data[a+t*i.width];)s[2]++,a++;if(a==o)return NaN;for(;a<o&&!i.data[a+t*i.width]&&s[3]<n;)s[3]++,a++;if(a==o||s[3]>=n)return NaN;for(;a<o&&i.data[a+t*i.width]&&s[4]<n;)s[4]++,a++;if(s[4]>=n)return NaN;var l=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(l-r)>=r?NaN:this.foundPatternCross(s)?this.centerFromEnd(s,a):NaN};_.prototype.handlePossibleCenter=function(e,t,n){var r=e[0]+e[1]+e[2]+e[3]+e[4],i=this.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(i),e[2],r);if(!isNaN(o)&&(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(o),e[2],r),!isNaN(i))){for(var s=r/7,a=!1,l=this.possibleCenters.length,h=0;h<l;h++){var f=this.possibleCenters[h];if(f.aboutEquals(s,o,i)){f.incrementCount(),a=!0;break}}if(!a){var g=new ve(i,o,s);this.possibleCenters.push(g),this.resultPointCallback!=null&&this.resultPointCallback.foundPossibleResultPoint(g)}return!0}return!1};_.prototype.selectBestPatterns=function(){var e=this.possibleCenters.length;if(e<3)throw"Couldn't find enough finder patterns:"+e+" patterns found";if(e>3){for(var t=0,n=0,r=0;r<e;r++){var i=this.possibleCenters[r].estimatedModuleSize;t+=i,n+=i*i}var o=t/e;this.possibleCenters.sort(function(h,f){var g=Math.abs(f.estimatedModuleSize-o),d=Math.abs(h.estimatedModuleSize-o);return g<d?-1:g==d?0:1});for(var s=Math.sqrt(n/e-o*o),a=Math.max(.2*o,s),r=this.possibleCenters-1;r>=0;r--){var l=this.possibleCenters[r];Math.abs(l.estimatedModuleSize-o)>a&&this.possibleCenters.splice(r,1)}}return this.possibleCenters.length>3&&this.possibleCenters.sort(function(h,f){return h.count>f.count?-1:h.count<f.count?1:0}),[this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2]]};_.prototype.findRowSkip=function(){var e=this.possibleCenters.length;if(e<=1)return 0;for(var t=null,n=0;n<e;n++){var r=this.possibleCenters[n];if(r.count>=Ft)if(t==null)t=r;else return this.hasSkipped=!0,Math.floor((Math.abs(t.X-r.X)-Math.abs(t.Y-r.Y))/2)}return 0};_.prototype.haveMultiplyConfirmedCenters=function(){for(var e=0,t=0,n=this.possibleCenters.length,r=0;r<n;r++){var i=this.possibleCenters[r];i.count>=Ft&&(e++,t+=i.estimatedModuleSize)}if(e<3)return!1;for(var o=t/n,s=0,r=0;r<n;r++)i=this.possibleCenters[r],s+=Math.abs(i.estimatedModuleSize-o);return s<=.05*t};_.prototype.findFinderPattern=function(e){var t=!1;this.image=e;var n=e.height,r=e.width,i=Math.floor(3*n/(4*zn));(i<st||t)&&(i=st);for(var o=!1,s=new Array(5),a=i-1;a<n&&!o;a+=i){s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0;for(var l=0,h=0;h<r;h++)if(e.data[h+a*e.width])(l&1)==1&&l++,s[l]++;else if((l&1)==0)if(l==4)if(this.foundPatternCross(s)){var f=this.handlePossibleCenter(s,a,h);if(f)if(i=2,this.hasSkipped)o=this.haveMultiplyConfirmedCenters();else{var g=this.findRowSkip();g>s[2]&&(a+=g-s[2]-i,h=r-1)}else{do h++;while(h<r&&!e.data[h+a*e.width]);h--}l=0,s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0}else s[0]=s[2],s[1]=s[3],s[2]=s[4],s[3]=1,s[4]=0,l=3;else s[++l]++;else s[l]++;if(this.foundPatternCross(s)){var f=this.handlePossibleCenter(s,a,r);f&&(i=s[0],this.hasSkipped&&(o=this.haveMultiplyConfirmedCenters()))}}var d=this.selectBestPatterns();return Un(d),new Vn(d)};function T(e,t,n,r,i,o,s,a,l){this.a11=e,this.a12=r,this.a13=s,this.a21=t,this.a22=i,this.a23=a,this.a31=n,this.a32=o,this.a33=l}T.prototype.transformPoints1=function(e){for(var t=e.length,n=this.a11,r=this.a12,i=this.a13,o=this.a21,s=this.a22,a=this.a23,l=this.a31,h=this.a32,f=this.a33,g=0;g<t;g+=2){var d=e[g],w=e[g+1],p=i*d+a*w+f;e[g]=(n*d+o*w+l)/p,e[g+1]=(r*d+s*w+h)/p}};T.prototype.transformPoints2=function(e,t){for(var n=e.length,r=0;r<n;r++){var i=e[r],o=t[r],s=this.a13*i+this.a23*o+this.a33;e[r]=(this.a11*i+this.a21*o+this.a31)/s,t[r]=(this.a12*i+this.a22*o+this.a32)/s}};T.prototype.buildAdjoint=function(){return new T(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)};T.prototype.times=function(e){return new T(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)};T.quadrilateralToQuadrilateral=function(e,t,n,r,i,o,s,a,l,h,f,g,d,w,p,C){var B=this.quadrilateralToSquare(e,t,n,r,i,o,s,a),y=this.squareToQuadrilateral(l,h,f,g,d,w,p,C);return y.times(B)};T.squareToQuadrilateral=function(e,t,n,r,i,o,s,a){var l=a-o,h=t-r+o-a;if(l==0&&h==0)return new T(n-e,i-n,e,r-t,o-r,t,0,0,1);var f=n-i,g=s-i,d=e-n+i-s,w=r-o,p=f*l-g*w,C=(d*l-g*h)/p,B=(f*h-d*w)/p;return new T(n-e+C*n,s-e+B*s,e,r-t+C*r,a-t+B*a,t,C,B,1)};T.quadrilateralToSquare=function(e,t,n,r,i,o,s,a){return this.squareToQuadrilateral(e,t,n,r,i,o,s,a).buildAdjoint()};function Yn(e,t){this.bits=e,this.points=t}function I(e){this.image=e,this.resultPointCallback=null}I.prototype.sizeOfBlackWhiteBlackRun=function(e,t,n,r){var i=Math.abs(r-t)>Math.abs(n-e);if(i){var o=e;e=t,t=o,o=n,n=r,r=o}for(var s=Math.abs(n-e),a=Math.abs(r-t),l=-s>>1,h=t<r?1:-1,f=e<n?1:-1,g=0,d=e,w=t;d!=n;d+=f){var p=i?w:d,C=i?d:w;if(g==1?this.image.data[p+C*this.image.width]&&g++:this.image.data[p+C*this.image.width]||g++,g==3){var B=d-e,y=w-t;return Math.sqrt(B*B+y*y)}if(l+=a,l>0){if(w==r)break;w+=h,l-=s}}var M=n-e,m=r-t;return Math.sqrt(M*M+m*m)};I.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,t,n,r){var i=this.sizeOfBlackWhiteBlackRun(e,t,n,r),o=1,s=e-(n-e);s<0?(o=e/(e-s),s=0):s>=this.image.width&&(o=(this.image.width-1-e)/(s-e),s=this.image.width-1);var a=Math.floor(t-(r-t)*o);return o=1,a<0?(o=t/(t-a),a=0):a>=this.image.height&&(o=(this.image.height-1-t)/(a-t),a=this.image.height-1),s=Math.floor(e+(s-e)*o),i+=this.sizeOfBlackWhiteBlackRun(e,t,s,a),i-1};I.prototype.calculateModuleSizeOneWay=function(e,t){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y)),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14};I.prototype.calculateModuleSize=function(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2};I.prototype.distance=function(e,t){var n=e.X-t.X,r=e.Y-t.Y;return Math.sqrt(n*n+r*r)};I.prototype.computeDimension=function(e,t,n,r){var i=Math.round(this.distance(e,t)/r),o=Math.round(this.distance(e,n)/r),s=(i+o>>1)+7;switch(s&3){case 0:s++;break;case 2:s--;break;case 3:throw"Error"}return s};I.prototype.findAlignmentInRegion=function(e,t,n,r){var i=Math.floor(r*e),o=Math.max(0,t-i),s=Math.min(this.image.width-1,t+i);if(s-o<e*3)throw"Error";var a=Math.max(0,n-i),l=Math.min(this.image.height-1,n+i),h=new he(this.image,o,a,s-o,l-a,e,this.resultPointCallback);return h.find()};I.prototype.createTransform=function(e,t,n,r,i){var o=i-3.5,s,a,l,h;r!=null?(s=r.X,a=r.Y,l=h=o-3):(s=t.X-e.X+n.X,a=t.Y-e.Y+n.Y,l=h=o);var f=T.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,l,h,3.5,o,e.X,e.Y,t.X,t.Y,s,a,n.X,n.Y);return f};I.prototype.sampleGrid=function(e,t,n){var r=Me;return r.sampleGrid3(e,n,t)};I.prototype.processFinderPatternInfo=function(e){var t=e.topLeft,n=e.topRight,r=e.bottomLeft,i=this.calculateModuleSize(t,n,r);if(i<1)throw"Error";var o=this.computeDimension(t,n,r,i),s=b.getProvisionalVersionForDimension(o),a=s.DimensionForVersion-7,l=null;if(s.alignmentPatternCenters.length>0)for(var h=n.X-t.X+r.X,f=n.Y-t.Y+r.Y,g=1-3/a,d=Math.floor(t.X+g*(h-t.X)),w=Math.floor(t.Y+g*(f-t.Y)),p=4;p<=16;p<<=1){l=this.findAlignmentInRegion(i,d,w,p);break}var C=this.createTransform(t,n,r,l,o),B=this.sampleGrid(this.image,C,o),y;return l==null?y=[r,t,n]:y=[r,t,n,l],new Yn(B,y)};I.prototype.detect=function(){var e=new _().findFinderPattern(this.image);return this.processFinderPatternInfo(e)};function D(e,t){if(t==null||t.length==0)throw"System.ArgumentException";this.field=e;var n=t.length;if(n>1&&t[0]==0){for(var r=1;r<n&&t[r]==0;)r++;if(r==n)this.coefficients=e.Zero.coefficients;else{this.coefficients=new Array(n-r);for(var i=0;i<this.coefficients.length;i++)this.coefficients[i]=0;for(var o=0;o<this.coefficients.length;o++)this.coefficients[o]=t[r+o]}}else this.coefficients=t}Object.defineProperty(D.prototype,"Zero",{get:function(){return this.coefficients[0]==0}});Object.defineProperty(D.prototype,"Degree",{get:function(){return this.coefficients.length-1}});D.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]};D.prototype.evaluateAt=function(e){if(e==0)return this.getCoefficient(0);var t=this.coefficients.length;if(e==1){for(var n=0,r=0;r<t;r++)n=this.field.addOrSubtract(n,this.coefficients[r]);return n}for(var i=this.coefficients[0],r=1;r<t;r++)i=this.field.addOrSubtract(this.field.multiply(e,i),this.coefficients[r]);return i};D.prototype.addOrSubtract=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(this.Zero)return e;if(e.Zero)return this;var t=this.coefficients,n=e.coefficients;if(t.length>n.length){var r=t;t=n,n=r}for(var i=new Array(n.length),o=n.length-t.length,s=0;s<o;s++)i[s]=n[s];for(var a=o;a<n.length;a++)i[a]=this.field.addOrSubtract(t[a-o],n[a]);return new D(this.field,i)};D.prototype.multiply1=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(this.Zero||e.Zero)return this.field.Zero;for(var t=this.coefficients,n=t.length,r=e.coefficients,i=r.length,o=new Array(n+i-1),s=0;s<n;s++)for(var a=t[s],l=0;l<i;l++)o[s+l]=this.field.addOrSubtract(o[s+l],this.field.multiply(a,r[l]));return new D(this.field,o)};D.prototype.multiply2=function(e){if(e==0)return this.field.Zero;if(e==1)return this;for(var t=this.coefficients.length,n=new Array(t),r=0;r<t;r++)n[r]=this.field.multiply(this.coefficients[r],e);return new D(this.field,n)};D.prototype.multiplyByMonomial=function(e,t){if(e<0)throw"System.ArgumentException";if(t==0)return this.field.Zero;for(var n=this.coefficients.length,r=new Array(n+e),i=0;i<r.length;i++)r[i]=0;for(var i=0;i<n;i++)r[i]=this.field.multiply(this.coefficients[i],t);return new D(this.field,r)};D.prototype.divide=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(e.Zero)throw"Divide by 0";for(var t=this.field.Zero,n=this,r=e.getCoefficient(e.Degree),i=this.field.inverse(r);n.Degree>=e.Degree&&!n.Zero;){var o=n.Degree-e.Degree,s=this.field.multiply(n.getCoefficient(n.Degree),i),a=e.multiplyByMonomial(o,s),l=this.field.buildMonomial(o,s);t=t.addOrSubtract(l),n=n.addOrSubtract(a)}return[t,n]};function F(e){this.expTable=new Array(256),this.logTable=new Array(256);for(var t=1,n=0;n<256;n++)this.expTable[n]=t,t<<=1,t>=256&&(t^=e);for(var n=0;n<255;n++)this.logTable[this.expTable[n]]=n;var r=new Array(1);r[0]=0,this.zero=new D(this,new Array(r));var i=new Array(1);i[0]=1,this.one=new D(this,new Array(i))}Object.defineProperty(F.prototype,"Zero",{get:function(){return this.zero}});Object.defineProperty(F.prototype,"One",{get:function(){return this.one}});F.prototype.buildMonomial=function(e,t){if(e<0)throw"System.ArgumentException";if(t==0)return this.zero;for(var n=new Array(e+1),r=0;r<n.length;r++)n[r]=0;return n[0]=t,new D(this,n)};F.prototype.exp=function(e){return this.expTable[e]};F.prototype.log=function(e){if(e==0)throw"System.ArgumentException";return this.logTable[e]};F.prototype.inverse=function(e){if(e==0)throw"System.ArithmeticException";return this.expTable[255-this.logTable[e]]};F.prototype.addOrSubtract=function(e,t){return e^t};F.prototype.multiply=function(e,t){return e==0||t==0?0:e==1?t:t==1?e:this.expTable[(this.logTable[e]+this.logTable[t])%255]};F.QR_CODE_FIELD=new F(285);F.DATA_MATRIX_FIELD=new F(301);function pe(e){this.field=e}pe.prototype.decode=function(e,t){for(var n=new D(this.field,e),r=new Array(t),i=0;i<r.length;i++)r[i]=0;for(var o=!1,s=!0,i=0;i<t;i++){var a=n.evaluateAt(this.field.exp(i));r[r.length-1-i]=a,a!=0&&(s=!1)}if(!s)for(var l=new D(this.field,r),h=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),l,t),f=h[0],g=h[1],d=this.findErrorLocations(f),w=this.findErrorMagnitudes(g,d,o),i=0;i<d.length;i++){var p=e.length-1-this.field.log(d[i]);if(p<0)throw"ReedSolomonException Bad error location";e[p]=F.prototype.addOrSubtract(e[p],w[i])}};pe.prototype.runEuclideanAlgorithm=function(e,t,n){if(e.Degree<t.Degree){var r=e;e=t,t=r}for(var i=e,o=t,s=this.field.One,a=this.field.Zero,l=this.field.Zero,h=this.field.One;o.Degree>=Math.floor(n/2);){var f=i,g=s,d=l;if(i=o,s=a,l=h,i.Zero)throw"r_{i-1} was zero";o=f;for(var w=this.field.Zero,p=i.getCoefficient(i.Degree),C=this.field.inverse(p);o.Degree>=i.Degree&&!o.Zero;){var B=o.Degree-i.Degree,y=this.field.multiply(o.getCoefficient(o.Degree),C);w=w.addOrSubtract(this.field.buildMonomial(B,y)),o=o.addOrSubtract(i.multiplyByMonomial(B,y))}a=w.multiply1(s).addOrSubtract(g),h=w.multiply1(l).addOrSubtract(d)}var M=h.getCoefficient(0);if(M==0)throw"ReedSolomonException sigmaTilde(0) was zero";var m=this.field.inverse(M),E=h.multiply2(m),P=o.multiply2(m);return[E,P]};pe.prototype.findErrorLocations=function(e){var t=e.Degree;if(t==1)return new Array(e.getCoefficient(1));for(var n=new Array(t),r=0,i=1;i<256&&r<t;i++)e.evaluateAt(i)==0&&(n[r]=this.field.inverse(i),r++);if(r!=t)throw"Error locator degree does not match number of roots";return n};pe.prototype.findErrorMagnitudes=function(e,t,n){for(var r=t.length,i=new Array(r),o=0;o<r;o++){for(var s=this.field.inverse(t[o]),a=1,l=0;l<r;l++)o!=l&&(a=this.field.multiply(a,F.prototype.addOrSubtract(1,this.field.multiply(t[l],s))));i[o]=this.field.multiply(e.evaluateAt(s),this.field.inverse(a)),n&&(i[o]=this.field.multiply(i[o],s))}return i};var Ne={};Ne.forReference=function(e){if(e<0||e>7)throw"System.ArgumentException";return Ne.DATA_MASKS[e]};function qn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return(e+t&1)==0}}function Hn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return(e&1)==0}}function Qn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return t%3==0}}function Kn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return(e+t)%3==0}}function Gn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return(V(e,1)+t/3&1)==0}}function Wn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){var n=e*t;return(n&1)+n%3==0}}function $n(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){var n=e*t;return((n&1)+n%3&1)==0}}function Jn(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return((e+t&1)+e*t%3&1)==0}}Ne.DATA_MASKS=[new qn,new Hn,new Qn,new Kn,new Gn,new Wn,new $n,new Jn];function me(e){var t=e.Dimension;if(t<21||(t&3)!=1)throw"Error BitMatrixParser";this.bitMatrix=e,this.parsedVersion=null,this.parsedFormatInfo=null}me.prototype.copyBit=function(e,t,n){return this.bitMatrix.get_Renamed(e,t)?n<<1|1:n<<1};me.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!=null)return this.parsedFormatInfo;for(var e=0,t=0;t<6;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=x.decodeFormatInformation(e),this.parsedFormatInfo!=null)return this.parsedFormatInfo;var r=this.bitMatrix.Dimension;e=0;for(var i=r-8,t=r-1;t>=i;t--)e=this.copyBit(t,8,e);for(var n=r-7;n<r;n++)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=x.decodeFormatInformation(e),this.parsedFormatInfo!=null)return this.parsedFormatInfo;throw"Error readFormatInformation"};me.prototype.readVersion=function(){if(this.parsedVersion!=null)return this.parsedVersion;var e=this.bitMatrix.Dimension,t=e-17>>2;if(t<=6)return b.getVersionForNumber(t);for(var n=0,r=e-11,i=5;i>=0;i--)for(var o=e-9;o>=r;o--)n=this.copyBit(o,i,n);if(this.parsedVersion=b.decodeVersionInformation(n),this.parsedVersion!=null&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;n=0;for(var o=5;o>=0;o--)for(var i=e-9;i>=r;i--)n=this.copyBit(o,i,n);if(this.parsedVersion=b.decodeVersionInformation(n),this.parsedVersion!=null&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;throw"Error readVersion"};me.prototype.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),n=Ne.forReference(e.dataMask),r=this.bitMatrix.Dimension;n.unmaskBitMatrix(this.bitMatrix,r);for(var i=t.buildFunctionPattern(),o=!0,s=new Array(t.totalCodewords),a=0,l=0,h=0,f=r-1;f>0;f-=2){f==6&&f--;for(var g=0;g<r;g++)for(var d=o?r-1-g:g,w=0;w<2;w++)i.get_Renamed(f-w,d)||(h++,l<<=1,this.bitMatrix.get_Renamed(f-w,d)&&(l|=1),h==8&&(s[a++]=l,h=0,l=0));o^=!0}if(a!=t.totalCodewords)throw"Error readCodewords";return s};function He(e,t){this.numDataCodewords=e,this.codewords=t}He.getDataBlocks=function(e,t,n){if(e.length!=t.totalCodewords)throw"ArgumentException";for(var r=t.getECBlocksForLevel(n),i=0,o=r.getECBlocks(),s=0;s<o.length;s++)i+=o[s].count;for(var a=new Array(i),l=0,h=0;h<o.length;h++)for(var f=o[h],s=0;s<f.count;s++){var g=f.dataCodewords,d=r.ecCodewordsPerBlock+g;a[l++]=new He(g,new Array(d))}for(var w=a[0].codewords.length,p=a.length-1;p>=0;){var C=a[p].codewords.length;if(C==w)break;p--}p++;for(var B=w-r.ecCodewordsPerBlock,y=0,s=0;s<B;s++)for(var h=0;h<l;h++)a[h].codewords[s]=e[y++];for(var h=p;h<l;h++)a[h].codewords[B]=e[y++];for(var M=a[0].codewords.length,s=B;s<M;s++)for(var h=0;h<l;h++){var m=h<p?s:s+1;a[h].codewords[m]=e[y++]}return a};function q(e,t,n){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=e,this.numErrorCorrectionCode=n,t<=9?this.dataLengthMode=0:t>=10&&t<=26?this.dataLengthMode=1:t>=27&&t<=40&&(this.dataLengthMode=2)}q.prototype.getNextBits=function(e){var t=0;if(e<this.bitPointer+1){for(var n=0,r=0;r<e;r++)n+=1<<r;return n<<=this.bitPointer-e+1,t=(this.blocks[this.blockPointer]&n)>>this.bitPointer-e+1,this.bitPointer-=e,t}else if(e<this.bitPointer+1+8){for(var i=0,r=0;r<this.bitPointer+1;r++)i+=1<<r;return t=(this.blocks[this.blockPointer]&i)<<e-(this.bitPointer+1),this.blockPointer++,t+=this.blocks[this.blockPointer]>>8-(e-(this.bitPointer+1)),this.bitPointer=this.bitPointer-e%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}else if(e<this.bitPointer+1+16){for(var i=0,o=0,r=0;r<this.bitPointer+1;r++)i+=1<<r;var s=(this.blocks[this.blockPointer]&i)<<e-(this.bitPointer+1);this.blockPointer++;var a=this.blocks[this.blockPointer]<<e-(this.bitPointer+1+8);this.blockPointer++;for(var r=0;r<e-(this.bitPointer+1+8);r++)o+=1<<r;o<<=8-(e-(this.bitPointer+1+8));var l=(this.blocks[this.blockPointer]&o)>>8-(e-(this.bitPointer+1+8));return t=s+a+l,this.bitPointer=this.bitPointer-(e-8)%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}else return 0};q.prototype.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)};q.prototype.getDataLength=function(e){for(var t=0;e>>t!=1;)t++;return this.getNextBits(Rt.sizeOfDataLengthInfo[this.dataLengthMode][t])};q.prototype.getRomanAndFigureString=function(e){var t=e,n=0,r="",i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];do if(t>1){n=this.getNextBits(11);var o=Math.floor(n/45),s=n%45;r+=i[o],r+=i[s],t-=2}else t==1&&(n=this.getNextBits(6),r+=i[n],t-=1);while(t>0);return r};q.prototype.getFigureString=function(e){var t=e,n=0,r="";do t>=3?(n=this.getNextBits(10),n<100&&(r+="0"),n<10&&(r+="0"),t-=3):t==2?(n=this.getNextBits(7),n<10&&(r+="0"),t-=2):t==1&&(n=this.getNextBits(4),t-=1),r+=n;while(t>0);return r};q.prototype.get8bitByteArray=function(e){var t=e,n=0,r=[];do n=this.getNextBits(8),r.push(n),t--;while(t>0);return r};q.prototype.getKanjiString=function(e){var t=e,n=0,r="";do{n=this.getNextBits(13);var i=n%192,o=n/192,s=(o<<8)+i,a=0;s+33088<=40956?a=s+33088:a=s+49472,r+=String.fromCharCode(a),t--}while(t>0);return r};Object.defineProperty(q.prototype,"DataByte",{get:function(){var e=[],t=1,n=2,r=4,i=8;do{var o=this.NextMode();if(o==0){if(e.length>0)break;throw"Empty data block"}if(o!=t&&o!=n&&o!=r&&o!=i&&o!=7)throw"Invalid mode: "+o+" in (block:"+this.blockPointer+" bit:"+this.bitPointer+")";var s=this.getDataLength(o);if(s<1)throw"Invalid data length: "+s;switch(o){case t:for(var f=this.getFigureString(s),l=new Array(f.length),a=0;a<f.length;a++)l[a]=f.charCodeAt(a);e.push(l);break;case n:for(var f=this.getRomanAndFigureString(s),l=new Array(f.length),a=0;a<f.length;a++)l[a]=f.charCodeAt(a);e.push(l);break;case r:var h=this.get8bitByteArray(s);e.push(h);break;case i:var f=this.getKanjiString(s);e.push(f);break}}while(!0);return e}});var ce={};ce.rsDecoder=new pe(F.QR_CODE_FIELD);ce.correctErrors=function(e,t){for(var n=e.length,r=new Array(n),i=0;i<n;i++)r[i]=e[i]&255;var o=e.length-t;try{ce.rsDecoder.decode(r,o)}catch(s){throw s}for(var i=0;i<t;i++)e[i]=r[i]};ce.decode=function(e){for(var t=new me(e),n=t.readVersion(),r=t.readFormatInformation().errorCorrectionLevel,i=t.readCodewords(),o=He.getDataBlocks(i,n,r),s=0,a=0;a<o.length;a++)s+=o[a].numDataCodewords;for(var l=new Array(s),h=0,f=0;f<o.length;f++){var g=o[f],d=g.codewords,w=g.numDataCodewords;ce.correctErrors(d,w);for(var a=0;a<w;a++)l[h++]=d[a]}var p=new q(l,n.versionNumber,r.bits);return p};var Rt={};Rt.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]];function H(){this.imagedata=null,this.width=0,this.height=0,this.qrCodeSymbol=null,this.debug=!1,this.callback=null}H.prototype.decode=function(e,t){var n=function(){try{this.error=void 0,this.result=this.process(this.imagedata)}catch(i){this.error=i,this.result=void 0}return this.callback!=null&&this.callback(this.error,this.result),this.result}.bind(this);if(e!=null&&e.width!=null)this.width=e.width,this.height=e.height,this.imagedata={data:t||e.data},this.imagedata.width=e.width,this.imagedata.height=e.height,n();else{if(typeof Image>"u")throw new Error("This source format is not supported in your environment, you need to pass an image buffer with width and height (see https://github.com/edi9999/jsqrcode/blob/master/test/qrcode.js)");var r=new Image;r.crossOrigin="Anonymous",r.onload=function(){var i=document.createElement("canvas"),o=i.getContext("2d"),s=document.getElementById("out-canvas");if(s!=null){var a=s.getContext("2d");a.clearRect(0,0,320,240),a.drawImage(r,0,0,320,240)}i.width=r.width,i.height=r.height,o.drawImage(r,0,0),this.width=r.width,this.height=r.height;try{this.imagedata=o.getImageData(0,0,r.width,r.height)}catch{if(this.result="Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!",this.callback!=null)return this.callback(null,this.result)}n()}.bind(this),r.src=e}};H.prototype.decode_utf8=function(e){return decodeURIComponent(escape(e))};H.prototype.process=function(e){for(var t=new Date().getTime(),n=this.grayScaleToBitmap(this.grayscale(e)),r=new I(n),i=r.detect(),o=ce.decode(i.bits),s=o.DataByte,a="",l=0;l<s.length;l++)for(var h=0;h<s[l].length;h++)a+=String.fromCharCode(s[l][h]);var f=new Date().getTime(),g=f-t;return this.debug&&console.log("QR Code processing time (ms): "+g),{result:this.decode_utf8(a),points:i.points}};H.prototype.getPixel=function(e,t,n){if(e.width<t||e.height<n)throw"point error";var r=t*4+n*e.width*4;return(e.data[r]*33+e.data[r+1]*34+e.data[r+2]*33)/100};H.prototype.binarize=function(e){for(var t=new Array(this.width*this.height),n=0;n<this.height;n++)for(var r=0;r<this.width;r++){var i=this.getPixel(r,n);t[r+n*this.width]=i<=e}return t};H.prototype.getMiddleBrightnessPerArea=function(e){for(var t=4,n=Math.floor(e.width/t),r=Math.floor(e.height/t),i=new Array(t),o=0;o<t;o++){i[o]=new Array(t);for(var s=0;s<t;s++)i[o][s]=[0,0]}for(var a=0;a<t;a++)for(var l=0;l<t;l++){i[l][a][0]=255;for(var h=0;h<r;h++)for(var f=0;f<n;f++){var g=e.data[n*l+f+(r*a+h)*e.width];g<i[l][a][0]&&(i[l][a][0]=g),g>i[l][a][1]&&(i[l][a][1]=g)}}for(var d=new Array(t),w=0;w<t;w++)d[w]=new Array(t);for(var a=0;a<t;a++)for(var l=0;l<t;l++)d[l][a]=Math.floor((i[l][a][0]+i[l][a][1])/2);return d};H.prototype.grayScaleToBitmap=function(e){for(var t=this.getMiddleBrightnessPerArea(e),n=t.length,r=Math.floor(e.width/n),i=Math.floor(e.height/n),o=0;o<n;o++)for(var s=0;s<n;s++)for(var a=0;a<i;a++)for(var l=0;l<r;l++)e.data[r*s+l+(i*o+a)*e.width]=e.data[r*s+l+(i*o+a)*e.width]<t[s][o];return e};H.prototype.grayscale=function(e){for(var t=new Array(e.width*e.height),n=0;n<e.height;n++)for(var r=0;r<e.width;r++){var i=this.getPixel(e,r,n);t[r+n*e.width]=i}return{height:e.height,width:e.width,data:t}};function V(e,t){return e>=0?e>>t:(e>>t)+(2<<~t)}const Zn=()=>navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment"}}),Xn=({onInput:e,prepareClose:t})=>{const[n,r]=N.exports.useState(!1),[i,o]=N.exports.useState(),[s,a]=N.exports.useState(),l=N.exports.useRef();l.current=s;const{width:h,height:f}=N.exports.useMemo(()=>({width:window.innerWidth,height:window.innerHeight}),[]),g=N.exports.useRef(null),d=N.exports.useRef(null),w=N.exports.useRef(!1),p=N.exports.useRef(!1),C=N.exports.useRef(()=>{}),B=N.exports.useCallback(()=>{l.current.getTracks().forEach(m=>l.current.removeTrack(m)),d.current.srcObject=null,d.current.src=""},[]);N.exports.useEffect(()=>{Zn().then(a).catch(m=>{m.name==="NotAllowedError"?r(!0):o(m)})},[B]),N.exports.useEffect(()=>{t&&(d.current.pause(),B())},[t,B]);const y=N.exports.useCallback(()=>{window.requestAnimationFrame(C.current)},[]);N.exports.useEffect(()=>{const m=d.current;s&&!w.current&&(w.current=!0,"srcObject"in m?m.srcObject=s:m.src=window.URL.createObjectURL(s),m.setAttribute("autoplay",""),m.setAttribute("muted",""),m.setAttribute("playsinline",""),y())},[y,s]);const M=N.exports.useCallback((m,E)=>{if(m||t)return y();try{const{code:P,codeWords:k}=JSON.parse(atob(E.result));P.every(S=>typeof S=="number")&&typeof k.first=="string"&&typeof k.second=="string"&&typeof k.third=="string"&&(p.current||(p.current=!0,e({code:P,codeWords:k})))}catch{}y()},[e,y,t]);return C.current=N.exports.useCallback(()=>{const m=g.current&&g.current.getContext("2d");if(m){const E=new H;m.drawImage(d.current,0,0,h,f,0,0,h,f);const P=m.getImageData(0,0,h,f);E.callback=M,E.decode(P)}},[M,f,h]),n?v(ne,{children:Y("media.camAccess.required")}):i?v(ne,{children:"Ups, something went wrong (Code: QR2)"}):v("div",{className:"scanner",children:s&&A("div",{children:[v("video",{ref:d}),v("canvas",{width:h,height:f,ref:g})]})})},Qe={info:null,scanning:!1,closingScanner:!1},[jn,te]=at(Qe),Ke=()=>{const{closingScanner:e,scanning:t}=te.get();e||(t?(te.set({closingScanner:!0}),setTimeout(()=>te.set(Qe),1e3)):te.set(Qe))},er=e=>te.set({info:e}),tr=()=>te.set({scanning:!0}),nr=({code:e,codeWords:t})=>{Ke(),$.set(({enemy:n})=>({enemy:{...n,code:e,codeWords:t,round:n.round+1}}))},rr=()=>{const{info:e,scanning:t,closingScanner:n}=jn(i=>i),r=Math.min(window.innerWidth,window.innerHeight);return e?A("div",{className:"qr-code",children:[v(On,{info:e,options:{color:In.black,width:r}}),v("button",{onClick:Ke,children:v(j.Times,{})})]}):t?A("div",{className:"qr-scanning",style:n?{display:"none"}:void 0,children:[v(Xn,{onInput:nr,prepareClose:n}),v("button",{onClick:Ke,children:v(j.Times,{})})]}):null},ir=({codeWords:e,code:t})=>{const n=N.exports.useCallback(()=>er(btoa(JSON.stringify({code:t,codeWords:e}))),[t,e]);return A("button",{className:"open-qr-code",onClick:n,type:"button",children:[v(j.QrCode,{}),v("div",{className:"description",children:Y("DECRYPTO.btn.transfer")})]})},or=()=>W.arrayShuffle([1,2,3,4]).slice(0,3),sr=()=>$.set(({me:e})=>({me:{...e,code:or(),codeWords:void 0,guessed:void 0,round:e.round+1}})),ar=e=>$.set(({me:t})=>({me:{...t,codeWords:e}})),lr=e=>$.set(({me:t,results:{wins:n,losses:r},results:i})=>{const{codeWords:o,code:s}=t,{first:a,second:l,third:h}=o,f=e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2],g=[...t.knowledge].map(w=>[...w]);g[s[0]-1].push(a),g[s[1]-1].push(l),g[s[2]-1].push(h);const d={me:{...t,knowledge:g,guessed:e}};return f?{...d,results:{wins:n,losses:r+1}}:{...d,results:i}}),cr=()=>{const{code:e,codeWords:t,guessed:n,knowledge:r,round:i}=re(({me:a})=>a),o=re(({enemy:{guessed:a,round:l},me:h,results:{wins:f,losses:g}})=>{const d=a?l:l-1,w=h.round;return g>1||f>1||w>0&&d!==w}),s=!e||!!(e&&t&&n);return A(ne,{children:[i>0&&A("div",{className:"round",children:[Y("DECRYPTO.round")," ",i]}),s&&v("div",{className:"generate-code",children:A("button",{onClick:sr,type:"button",disabled:o,children:["?.?.?",v("div",{className:"description",children:Y("DECRYPTO.btn.generate")})]})}),e&&!t&&v(Yt,{onSubmit:ar,code:e}),e&&t&&!n&&v(ft,{onSubmit:lr,codeWords:t}),e&&t&&n&&v(dt,{codeWords:t,code:e,guessed:n}),e&&t&&v(ir,{code:e,codeWords:t}),v(wt,{knowledge:r})]})},hr=e=>$.set(({enemy:t})=>({enemy:{...t,...e}})),ur=e=>$.set(({enemy:t,results:{wins:n,losses:r},results:i})=>{const{codeWords:o,code:s}=t,{first:a,second:l,third:h}=o,f=e[0]===s[0]&&e[1]===s[1]&&e[2]===s[2],g=[...t.knowledge].map(w=>[...w]);g[s[0]-1].push(a),g[s[1]-1].push(l),g[s[2]-1].push(h);const d={enemy:{...t,knowledge:g,guessed:e}};return f?{...d,results:{wins:n+1,losses:r}}:{...d,results:i}}),fr=()=>{const{code:e,codeWords:t,guessed:n,knowledge:r,round:i}=re(({enemy:l})=>l),o=re(({me:{round:l,codeWords:h},enemy:f})=>(h?l:l-1)<=f.round),s=N.exports.useCallback(()=>{hr({code:void 0,codeWords:void 0,guessed:void 0}),tr()},[]),a=!e||!!(e&&t&&n);return A(ne,{children:[i>0&&A("div",{className:"round",children:[Y("DECRYPTO.round")," ",i]}),a&&v("div",{className:"scan-code",children:A("button",{onClick:s,type:"button",disabled:o,children:[v(j.Glasses,{}),v("div",{className:"description",children:Y("DECRYPTO.btn.catch")})]})}),e&&t&&!n&&v(ft,{onSubmit:ur,codeWords:t}),e&&t&&n&&v(dt,{codeWords:t,code:e,guessed:n}),v(wt,{knowledge:r})]})},dr=()=>{const[e,t]=N.exports.useState(),{wins:n,losses:r}=re(({results:s})=>s),i=N.exports.useRef({wins:n,losses:r}),o=N.exports.useCallback(()=>t(void 0),[]);return N.exports.useEffect(()=>{i.current.wins===1&&n===2?t("WON"):i.current.losses===1&&r===2&&t("LOST"),i.current={wins:n,losses:r}},[n,r]),e?v("div",{className:"result-overlay",onClick:o,children:v("span",{children:Y(e==="WON"?"DECRYPTO.won":"DECRYPTO.lost")})}):null},wr=()=>{const[e,t]=N.exports.useState(!1),{losses:n,wins:r}=re(({results:o})=>o),i=N.exports.useCallback(()=>t(o=>!o),[]);return v("div",{className:W.classNames("decrypto",e&&"enemy",n>0&&"alarm",r>0&&"success"),children:A("div",{className:"decrypto-inner",children:[v(dr,{}),v("div",{className:"navigation",children:v("button",{type:"button",onClick:i,children:v(j.Exchange,{})})}),v("div",{className:"content",children:e?v(fr,{}):v(cr,{})}),v(rr,{})]})})},gr=()=>v(Tt,{children:v(It,{onClick:$.reset})}),br=()=>A(xt,{fix:$.reset,children:[v(wr,{}),v(gr,{})]});export{br as default};
