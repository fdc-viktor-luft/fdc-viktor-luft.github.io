import{r as l,R as C,c as f,P as h,U as k,j as a,v as j,I as u}from"./index-VnnWUwzb.js";import{M as y}from"./DisplayError-B-QuU1PC.js";import{F as x}from"./input-M9Vg70J2.js";const O=({desc:s,short:e,className:t,tag:r="div"})=>{const[o,n]=l.useState(!1),c=o?s:e||s,d=l.useCallback(()=>{e&&(n(!0),window.setTimeout(()=>n(!1),3e3))},[e]);return C.createElement(r,{onClick:d,className:t},c)},v="players",w=()=>{try{const s=h.get(v);return JSON.parse(s)}catch{return[]}},[g,m]=f({players:w()}),S=s=>h.set(v,JSON.stringify(s)),p=s=>{m.set(s),S(m.get().players)},P=(s,e)=>p(({players:t})=>({players:[{name:s,shortcut:e,uuid:k.uuid()},...t]})),F=s=>p(({players:e})=>({players:e.filter(t=>t.uuid!==s.uuid)})),b=(s,e)=>p(({players:t})=>{const r=t.filter((o,n)=>n!==s);return r.splice(e,0,t[s]),{players:r}}),D=s=>s>0?b(s,s-1):void 0,R=s=>b(s,s+1),i={add:P,remove:F,moveDown:R,moveUp:D,get:m.get},U={name:"",shortcut:""},_={name:{onChange:s=>s?void 0:{id:"players.add.name.required"}}},A=({close:s,onAdd:e})=>{const[t,r]=l.useState(y.initialData(U)),{fields:o,Form:n}=y.useForm(),c=l.useCallback(({name:d,shortcut:N})=>{e(d,N),s()},[s,e]);return a.jsxs(n,{className:"startup add-players",onSubmit:c,validation:_,data:t,onChange:r,children:[a.jsx(x,{autoFocus:!0,field:o.name,label:"players.add.name"}),a.jsx(x,{field:o.shortcut,label:"players.add.shortcut"}),a.jsx("button",{type:"submit",children:j("players.add.submit")})]})},E=({onAdd:s})=>{const[e,t]=l.useState(!1),r=l.useCallback(()=>t(!0),[]),o=l.useCallback(()=>t(!1),[]);return e?a.jsx(A,{close:o,onAdd:s}):a.jsx("button",{className:"add-player",onClick:r,type:"submit",children:j("players.add")})},I=({player:s,pos:e})=>{const{name:t,shortcut:r}=s,o=l.useCallback(()=>i.moveUp(e),[e]),n=l.useCallback(()=>i.moveDown(e),[e]),c=l.useCallback(()=>i.remove(s),[s]);return a.jsxs("tr",{className:"player-row",children:[a.jsxs("td",{className:"player-pos",children:[a.jsx("span",{className:"player-move-down",onClick:n,children:a.jsx(u.ArrowRight,{})}),a.jsx("span",{className:"player-current-pos",children:e+1}),a.jsx("span",{className:"player-move-up",onClick:o,children:a.jsx(u.ArrowRight,{})})]}),a.jsx("td",{className:"player-name",children:t}),a.jsx("td",{className:"player-shortcut",children:r}),a.jsx("td",{className:"player-actions",children:a.jsx("span",{className:"player-remove",onClick:c,children:a.jsx(u.Trash,{})})})]})},q=()=>{const s=g(({players:e})=>e);return a.jsxs("div",{className:"players",children:[a.jsx("div",{className:"registered-players",children:a.jsx("table",{children:a.jsx("tbody",{children:s.map((e,t)=>a.jsx(I,{player:e,pos:t},e.uuid))})})}),a.jsx(E,{onAdd:i.add})]})};export{O as C,q as P,i as a};
